{"version":3,"file":"../app/api/documents/process/route.js","mappings":"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c,WAAS,WACvB,oCACA,kCACA,iBACA,4CACA,CAAK,CACL,kGACA,iBAVA,GAWA,QAAY,EACZ,CAAC,EAID,kBAAQ,wCAAsD,EAC9D,aACA,MAAW,gBAAW,EACtB,mBACA,sBACA,CAAK,CACL,yBC5BA,wECCA,qCAA6C,CAC7C,QACA,CAAC,EAAC,OACF,+DAA8E,CAC9E,cACA,eACA,QACA,CACA,CAAC,EAAC,IACF,WASA,KACA,mBACA,SAEA,sDACA,OACA,SACA,EAEA,WACA,eACA,gBAEA,OACA,cACA,EACA,yDACA,eACA,6DACA,iDACA,mBACA,6BAEA,UAQA,OAJA,YACA,GACA,WAEA,CACA,EAzCuD,EAAQ,KAAO,GACtE,SAD8D,EAC9D,GACA,0CACA,kBACA,cACA,qBACA,YACA,EAAK,GACL,CAkCA,OACA,YACA,EAEA,0CAIA,EAAoE,aAWpE,EAXuB,MAA6B,CAWpD,EAXuD,CAAa,EAYpE,sBAkBA,EAjBA,QAmBA,CACA,CA9BA,EACA,IACA,IACA,YACA,EAAM,OACN,cACA,CACA,CAAC,0BCtED,sDCAA,uDCAA,yDCAA,oDCAA,iDCAA,2DCAA,2DCAA,iDCAA,kDCAA,yDCAA,2DCAA,kDCAA,uCCAA,cACA,yCAEA,OADA,0BACA,CACA,CACA,cACA,YACA,WACA,uBCRA,cACA,yCAEA,OADA,0BACA,CACA,CACA,cACA,YACA,WACA","sources":["webpack://@hijraah/web/external commonjs \"next/dist/server/app-render/after-task-async-storage.external.js\"","webpack://@hijraah/web/external node-commonjs \"node:buffer\"","webpack://@hijraah/web/external commonjs2 \"module\"","webpack://@hijraah/web/../../node_modules/.pnpm/@opentelemetry+instrumentat_04f370d515cee0be955272f826166073/node_modules/@opentelemetry/instrumentation/build/esm/platform/node/ sync","webpack://@hijraah/web/external commonjs \"next/dist/compiled/next-server/app-page.runtime.prod.js\"","webpack://@hijraah/web/external commonjs2 \"punycode\"","webpack://@hijraah/web/external commonjs2 \"process\"","webpack://@hijraah/web/external commonjs2 \"os\"","webpack://@hijraah/web/external commonjs2 \"stream\"","webpack://@hijraah/web/external commonjs2 \"util\"","webpack://@hijraah/web/external commonjs2 \"fs\"","webpack://@hijraah/web/external commonjs \"next/dist/server/app-render/work-async-storage.external.js\"","webpack://@hijraah/web/external node-commonjs \"node:child_process\"","webpack://@hijraah/web/external commonjs2 \"path\"","webpack://@hijraah/web/external commonjs2 \"tls\"","webpack://@hijraah/web/external commonjs2 \"diagnostics_channel\"","webpack://@hijraah/web/external node-commonjs \"node:http\"","webpack://@hijraah/web/external node-commonjs \"node:zlib\"","webpack://@hijraah/web/external node-commonjs \"node:tls\"","webpack://@hijraah/web/external node-commonjs \"node:https\"","webpack://@hijraah/web/external commonjs \"next/dist/compiled/next-server/app-route.runtime.prod.js\"","webpack://@hijraah/web/external node-commonjs \"node:os\"","webpack://@hijraah/web/external node-commonjs \"node:diagnostics_channel\"","webpack://@hijraah/web/external commonjs2 \"crypto\"","webpack://@hijraah/web/external commonjs2 \"https\"","webpack://@hijraah/web/external node-commonjs \"node:stream\"","webpack://@hijraah/web/external node-commonjs \"node:util\"","webpack://@hijraah/web/ignored|E:\\downloads\\Hijraah\\node_modules\\.pnpm\\ws@8.18.2_bufferutil@4.0.9\\node_modules\\ws\\lib|utf-8-validate","webpack://@hijraah/web/external commonjs \"next/dist/server/app-render/work-unit-async-storage.external.js\"","webpack://@hijraah/web/external node-commonjs \"node:fs\"","webpack://@hijraah/web/external commonjs2 \"worker_threads\"","webpack://@hijraah/web/external commonjs2 \"zlib\"","webpack://@hijraah/web/external commonjs2 \"perf_hooks\"","webpack://@hijraah/web/src/app/api/documents/process/route.ts","webpack://@hijraah/web/sentry-wrapper-module","webpack://@hijraah/web/?a05a","webpack://@hijraah/web/external node-commonjs \"node:worker_threads\"","webpack://@hijraah/web/../../node_modules/.pnpm/next@15.3.0-canary.31_@babe_be67f368de2727c847f3a61f5e6cf4fa/node_modules/next/dist/server/create-deduped-by-callsite-server-error-logger.js","webpack://@hijraah/web/external node-commonjs \"node:path\"","webpack://@hijraah/web/external node-commonjs \"node:net\"","webpack://@hijraah/web/external node-commonjs \"node:crypto\"","webpack://@hijraah/web/external commonjs2 \"buffer\"","webpack://@hijraah/web/external commonjs2 \"url\"","webpack://@hijraah/web/external commonjs2 \"child_process\"","webpack://@hijraah/web/external node-commonjs \"node:readline\"","webpack://@hijraah/web/external commonjs2 \"http\"","webpack://@hijraah/web/external commonjs2 \"tty\"","webpack://@hijraah/web/external commonjs2 \"async_hooks\"","webpack://@hijraah/web/external node-commonjs \"node:inspector\"","webpack://@hijraah/web/external commonjs2 \"net\"","webpack://@hijraah/web/external commonjs2 \"events\"","webpack://@hijraah/web/../../node_modules/.pnpm/require-in-the-middle@7.5.2/node_modules/require-in-the-middle/ sync","webpack://@hijraah/web/../../node_modules/.pnpm/@supabase+realtime-js@2.11.10_bufferutil@4.0.9/node_modules/@supabase/realtime-js/dist/main/ sync"],"sourcesContent":["module.exports = require(\"next/dist/server/app-render/after-task-async-storage.external.js\");","module.exports = require(\"node:buffer\");","module.exports = require(\"module\");","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = () => ([]);\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 8963;\nmodule.exports = webpackEmptyContext;","module.exports = require(\"next/dist/compiled/next-server/app-page.runtime.prod.js\");","module.exports = require(\"punycode\");","module.exports = require(\"process\");","module.exports = require(\"os\");","module.exports = require(\"stream\");","module.exports = require(\"util\");","module.exports = require(\"fs\");","module.exports = require(\"next/dist/server/app-render/work-async-storage.external.js\");","module.exports = require(\"node:child_process\");","module.exports = require(\"path\");","module.exports = require(\"tls\");","module.exports = require(\"diagnostics_channel\");","module.exports = require(\"node:http\");","module.exports = require(\"node:zlib\");","module.exports = require(\"node:tls\");","module.exports = require(\"node:https\");","module.exports = require(\"next/dist/compiled/next-server/app-route.runtime.prod.js\");","module.exports = require(\"node:os\");","module.exports = require(\"node:diagnostics_channel\");","module.exports = require(\"crypto\");","module.exports = require(\"https\");","module.exports = require(\"node:stream\");","module.exports = require(\"node:util\");","/* (ignored) */","module.exports = require(\"next/dist/server/app-render/work-unit-async-storage.external.js\");","module.exports = require(\"node:fs\");","module.exports = require(\"worker_threads\");","module.exports = require(\"zlib\");","module.exports = require(\"perf_hooks\");","import { createServerClient } from \"@supabase/ssr\";\r\nimport { tasks } from \"@trigger.dev/sdk/v3\";\r\nimport { cookies } from \"next/headers\";\r\nimport { NextRequest, NextResponse } from \"next/server\";\r\nimport { z } from \"zod\";\r\n\r\nimport type { Database } from \"@/types/database.types\";\r\nimport type { ragPipelineTask } from \"@/lib/triggers/rag-pipeline\";\r\n//     👆 **type-only** import for proper type safety\r\n\r\n// Define the expected input schema\r\nconst ProcessRequestSchema = z.object({\r\n  documentId: z.string().uuid(),\r\n  filePath: z.string(),\r\n  fileType: z.string(),\r\n});\r\n\r\nexport async function POST(request: NextRequest) {\r\n  // Explicitly await cookies() to satisfy the linter's type expectation\r\n  const cookieStore = await cookies();\r\n\r\n  // Create Supabase client directly using @supabase/ssr\r\n  const supabase = createServerClient<Database>(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\r\n    {\r\n      cookies: {\r\n        get(name: string) {\r\n          return cookieStore.get(name)?.value;\r\n        },\r\n        // Server Actions/Route Handlers need set/remove to manage session\r\n        set(name: string, value: string, options) {\r\n          try {\r\n            cookieStore.set(name, value, options);\r\n          } catch (error) {\r\n            // Handle readonly errors if needed\r\n          }\r\n        },\r\n        remove(name: string, options) {\r\n          try {\r\n            cookieStore.set(name, \"\", options);\r\n          } catch (error) {\r\n            // Handle readonly errors if needed\r\n          }\r\n        },\r\n      },\r\n    }\r\n  );\r\n\r\n  // 1. Check Authentication\r\n  const {\r\n    data: { user },\r\n    error: authError,\r\n  } = await supabase.auth.getUser();\r\n\r\n  if (authError || !user) {\r\n    console.error(\"Auth error in /api/documents/process:\", authError);\r\n    return NextResponse.json({ error: \"Unauthorized\" }, { status: 401 });\r\n  }\r\n\r\n  // 2. Validate Input\r\n  let validatedData;\r\n  try {\r\n    const body = await request.json();\r\n    validatedData = ProcessRequestSchema.parse(body);\r\n  } catch (error) {\r\n    console.error(\"Invalid request body:\", error);\r\n    return NextResponse.json(\r\n      {\r\n        error: \"Invalid request body\",\r\n        details: error instanceof z.ZodError ? error.errors : null,\r\n      },\r\n      { status: 400 }\r\n    );\r\n  }\r\n\r\n  const { documentId, filePath, fileType } = validatedData;\r\n\r\n  // 3. Verify User owns the document and get document details\r\n  const { data: docData, error: docError } = await supabase\r\n    .from(\"documents\")\r\n    .select(\"id, filename, file_path, file_type\")\r\n    .eq(\"id\", documentId)\r\n    .eq(\"user_id\", user.id)\r\n    .maybeSingle();\r\n\r\n  if (docError || !docData) {\r\n    console.error(\r\n      `Document verification failed for user ${user.id} and document ${documentId}:`,\r\n      docError\r\n    );\r\n    return NextResponse.json(\r\n      { error: \"Document not found or access denied\" },\r\n      { status: 404 }\r\n    );\r\n  }\r\n\r\n  // 4. Trigger RAG Pipeline Task\r\n  try {\r\n    console.log(`Triggering RAG pipeline task for document ${documentId}...`);\r\n\r\n    // Trigger the RAG pipeline task with proper type safety\r\n    const handle = await tasks.trigger<typeof ragPipelineTask>(\r\n      \"rag-pipeline-orchestrator\",\r\n      {\r\n        id: documentId,\r\n        storagePath: filePath,\r\n        fileType: fileType,\r\n        sourceUrl: `file://${docData.file_path || filePath}`, // Create a file:// URL from the document's file path\r\n      }\r\n    );\r\n\r\n    console.log(\r\n      `RAG pipeline task triggered successfully for document ${documentId}, Run ID: ${handle.id}`\r\n    );\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      message: \"RAG pipeline task triggered successfully.\",\r\n      runId: handle.id,\r\n      publicAccessToken: handle.publicAccessToken,\r\n    });\r\n  } catch (error) {\r\n    console.error(\r\n      `Error triggering RAG pipeline task for document ${documentId}:`,\r\n      error\r\n    );\r\n    let errorMessage = \"Failed to initiate document processing.\";\r\n    if (error instanceof Error) {\r\n      errorMessage = `Failed to initiate document processing: ${error.message}`;\r\n    }\r\n    return NextResponse.json({ error: errorMessage }, { status: 500 });\r\n  }\r\n}\r\n","import * as origModule from 'next/dist/server/app-render/work-unit-async-storage.external.js';\nimport * as serverComponentModule from '__SENTRY_WRAPPING_TARGET_FILE__.cjs';\nexport * from '__SENTRY_WRAPPING_TARGET_FILE__.cjs';\nexport {} from '__SENTRY_WRAPPING_TARGET_FILE__.cjs';\nimport * as Sentry from '@sentry/nextjs';\n\n// @ts-expect-error Because we cannot be sure if the RequestAsyncStorage module exists (it is not part of the Next.js public\n// API) we use a shim if it doesn't exist. The logic for this is in the wrapping loader.\n\nconst asyncStorageModule = { ...origModule } ;\n\nconst requestAsyncStorage =\n  'workUnitAsyncStorage' in asyncStorageModule\n    ? asyncStorageModule.workUnitAsyncStorage\n    : 'requestAsyncStorage' in asyncStorageModule\n      ? asyncStorageModule.requestAsyncStorage\n      : undefined;\n\nfunction wrapHandler(handler, method) {\n  // Running the instrumentation code during the build phase will mark any function as \"dynamic\" because we're accessing\n  // the Request object. We do not want to turn handlers dynamic so we skip instrumentation in the build phase.\n  if (process.env.NEXT_PHASE === 'phase-production-build') {\n    return handler;\n  }\n\n  if (typeof handler !== 'function') {\n    return handler;\n  }\n\n  return new Proxy(handler, {\n    apply: (originalFunction, thisArg, args) => {\n      let headers = undefined;\n\n      // We try-catch here just in case the API around `requestAsyncStorage` changes unexpectedly since it is not public API\n      try {\n        const requestAsyncStore = requestAsyncStorage?.getStore() ;\n        headers = requestAsyncStore?.headers;\n      } catch (e) {\n        /** empty */\n      }\n\n      // eslint-disable-next-line @typescript-eslint/no-explicit-any\n      return Sentry.wrapRouteHandlerWithSentry(originalFunction , {\n        method,\n        parameterizedRoute: '/api/documents/process',\n        headers,\n      }).apply(thisArg, args);\n    },\n  });\n}\n\n// eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\nconst GET = wrapHandler(serverComponentModule.GET , 'GET');\n// eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\nconst POST = wrapHandler(serverComponentModule.POST , 'POST');\n// eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\nconst PUT = wrapHandler(serverComponentModule.PUT , 'PUT');\n// eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\nconst PATCH = wrapHandler(serverComponentModule.PATCH , 'PATCH');\n// eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\nconst DELETE = wrapHandler(serverComponentModule.DELETE , 'DELETE');\n// eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\nconst HEAD = wrapHandler(serverComponentModule.HEAD , 'HEAD');\n// eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\nconst OPTIONS = wrapHandler(serverComponentModule.OPTIONS , 'OPTIONS');\n\nexport { DELETE, GET, HEAD, OPTIONS, PATCH, POST, PUT };\n","import { AppRouteRouteModule } from \"next/dist/server/route-modules/app-route/module.compiled\";\nimport { RouteKind } from \"next/dist/server/route-kind\";\nimport { patchFetch as _patchFetch } from \"next/dist/server/lib/patch-fetch\";\nimport * as userland from \"E:\\\\downloads\\\\Hijraah\\\\apps\\\\web\\\\src\\\\app\\\\api\\\\documents\\\\process\\\\route.ts\";\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new AppRouteRouteModule({\n    definition: {\n        kind: RouteKind.APP_ROUTE,\n        page: \"/api/documents/process/route\",\n        pathname: \"/api/documents/process\",\n        filename: \"route\",\n        bundlePath: \"app/api/documents/process/route\"\n    },\n    resolvedPagePath: \"E:\\\\downloads\\\\Hijraah\\\\apps\\\\web\\\\src\\\\app\\\\api\\\\documents\\\\process\\\\route.ts\",\n    nextConfigOutput,\n    userland\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return _patchFetch({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\nexport { routeModule, workAsyncStorage, workUnitAsyncStorage, serverHooks, patchFetch,  };\n\n//# sourceMappingURL=app-route.js.map","module.exports = require(\"node:worker_threads\");","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nObject.defineProperty(exports, \"createDedupedByCallsiteServerErrorLoggerDev\", {\n    enumerable: true,\n    get: function() {\n        return createDedupedByCallsiteServerErrorLoggerDev;\n    }\n});\nconst _react = /*#__PURE__*/ _interop_require_wildcard(require(\"react\"));\nfunction _getRequireWildcardCache(nodeInterop) {\n    if (typeof WeakMap !== \"function\") return null;\n    var cacheBabelInterop = new WeakMap();\n    var cacheNodeInterop = new WeakMap();\n    return (_getRequireWildcardCache = function(nodeInterop) {\n        return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n    })(nodeInterop);\n}\nfunction _interop_require_wildcard(obj, nodeInterop) {\n    if (!nodeInterop && obj && obj.__esModule) {\n        return obj;\n    }\n    if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") {\n        return {\n            default: obj\n        };\n    }\n    var cache = _getRequireWildcardCache(nodeInterop);\n    if (cache && cache.has(obj)) {\n        return cache.get(obj);\n    }\n    var newObj = {\n        __proto__: null\n    };\n    var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n    for(var key in obj){\n        if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) {\n            var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n            if (desc && (desc.get || desc.set)) {\n                Object.defineProperty(newObj, key, desc);\n            } else {\n                newObj[key] = obj[key];\n            }\n        }\n    }\n    newObj.default = obj;\n    if (cache) {\n        cache.set(obj, newObj);\n    }\n    return newObj;\n}\nconst errorRef = {\n    current: null\n};\n// React.cache is currently only available in canary/experimental React channels.\nconst cache = typeof _react.cache === 'function' ? _react.cache : (fn)=>fn;\n// When Dynamic IO is enabled, we record these as errors so that they\n// are captured by the dev overlay as it's more critical to fix these\n// when enabled.\nconst logErrorOrWarn = process.env.__NEXT_DYNAMIC_IO ? console.error : console.warn;\n// We don't want to dedupe across requests.\n// The developer might've just attempted to fix the warning so we should warn again if it still happens.\nconst flushCurrentErrorIfNew = cache(// eslint-disable-next-line @typescript-eslint/no-unused-vars -- cache key\n(key)=>{\n    try {\n        logErrorOrWarn(errorRef.current);\n    } finally{\n        errorRef.current = null;\n    }\n});\nfunction createDedupedByCallsiteServerErrorLoggerDev(getMessage) {\n    return function logDedupedError(...args) {\n        const message = getMessage(...args);\n        if (process.env.NODE_ENV !== 'production') {\n            var _stack;\n            const callStackFrames = (_stack = new Error().stack) == null ? void 0 : _stack.split('\\n');\n            if (callStackFrames === undefined || callStackFrames.length < 4) {\n                logErrorOrWarn(message);\n            } else {\n                // Error:\n                //   logDedupedError\n                //   asyncApiBeingAccessedSynchronously\n                //   <userland callsite>\n                // TODO: This breaks if sourcemaps with ignore lists are enabled.\n                const key = callStackFrames[4];\n                errorRef.current = message;\n                flushCurrentErrorIfNew(key);\n            }\n        } else {\n            logErrorOrWarn(message);\n        }\n    };\n}\n\n//# sourceMappingURL=create-deduped-by-callsite-server-error-logger.js.map","module.exports = require(\"node:path\");","module.exports = require(\"node:net\");","module.exports = require(\"node:crypto\");","module.exports = require(\"buffer\");","module.exports = require(\"url\");","module.exports = require(\"child_process\");","module.exports = require(\"node:readline\");","module.exports = require(\"http\");","module.exports = require(\"tty\");","module.exports = require(\"async_hooks\");","module.exports = require(\"node:inspector\");","module.exports = require(\"net\");","module.exports = require(\"events\");","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = () => ([]);\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 96708;\nmodule.exports = webpackEmptyContext;","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = () => ([]);\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 97108;\nmodule.exports = webpackEmptyContext;"],"names":["ProcessRequestSchema","z","documentId","uuid","filePath","fileType","POST","request","validatedData","cookieStore","cookies","supabase","createServerClient","process","get","name","value","set","options","error","remove","data","user","authError","auth","getUser","console","NextResponse","json","status","body","parse","details","errors","docData","docError","from","select","eq","id","maybeSingle","handle","tasks","trigger","storagePath","sourceUrl","file_path","success","message","runId","publicAccessToken","errorMessage","Error","serverComponentModule.GET","serverComponentModule.PUT","serverComponentModule.PATCH","serverComponentModule.DELETE","serverComponentModule.HEAD","serverComponentModule.OPTIONS"],"sourceRoot":""}