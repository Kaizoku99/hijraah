{"version":3,"file":"9008.js","mappings":"ikBAeM,EAAc,SAGd,CAAC,EAAqB,EAAiB,CAAI,OAAkB,CAAC,GAG9D,CAAC,EAHsC,EAGN,CAAI,EAAwC,GAW7E,EAAe,MAXyE,MAWzE,CACnB,CAAC,EAAiC,KAChC,GAAM,eACJ,OACA,EACA,QAAS,iBACT,WACA,EACA,iBACA,EAAQ,qBACR,OACA,EACA,GAAG,EACL,CAAI,EACE,CAAC,EAAQ,EAAS,CAAU,MAAV,IAAU,CAAmC,IAAI,EACnE,EAAe,OAAe,CAAC,EAAc,GAAU,EAAU,IAAI,CAAC,CAC7B,SAAO,IAEhD,CAFqD,EAErC,GAAS,GAAQ,CAAC,CAAC,EAAO,QAAQ,MAAM,EACxD,CAAC,CAD2D,CAClD,EAAU,CAAI,OAAoB,CAAC,CACjD,KAAM,EACN,YAAa,IAAkB,EAC/B,SAAU,EACV,OAAQ,CACV,CAAC,EAED,MACE,WAAC,GAAe,MAAO,UAAe,WAAkB,EACtD,oBAAC,IAAS,CAAC,OAAV,CACC,KAAK,SACL,KAAK,SACL,eAAc,EACd,gBAAe,EACf,aAAY,EAAS,GACrB,IAD4B,YACb,EAAW,GAAK,gBAC/B,QACA,EACC,GAAG,EACJ,IAAK,EACL,QAAS,OAAoB,CAAC,EAAM,QAAS,IAC3C,EAAW,GAAiB,CAAC,GACzB,IACF,EAAiC,EAFK,KAEL,CAAU,CAD1B,CACgC,qBAAqB,EAIlE,EAAkC,QAAS,GAAM,gBAAgB,EAEzE,CAAC,IAEF,GACC,UAAC,GACC,CADF,OACW,EACT,QAAS,CAAC,EAAiC,aAC3C,QACA,UACA,WACA,WACA,OACA,EAIA,MAAO,CAAE,UAAW,mBAAoB,IAC1C,CAEJ,CAEJ,GAGF,EAAO,YAAc,EAMrB,IAAM,EAAa,cAMb,EAAoB,aACxB,CAAC,EAAsC,KACrC,GAAM,eAAE,EAAe,GAAG,EAAW,CAAI,EACnC,EAAU,EAAiB,EADI,GAErC,MACE,IAFwD,CAExD,KAAC,IAAS,CAAC,KAAV,CACC,aAAY,EAAS,EAAQ,OAAO,EACpC,gBAAe,EAAQ,SAAW,GAAK,OACtC,GAAG,EACJ,IAAK,GAGX,GAGF,EAAY,YAAc,EAe1B,IAAM,EAA0B,aAC9B,CACE,eACE,UACA,UACA,UACA,GAAU,EACV,GAAG,EACL,CACA,KAEA,IAAM,EAAY,SAAyB,IAAI,EACzC,EAAe,OAAe,CAAC,EAAK,GACpC,EAAc,OADkC,CACtB,GAC1B,EAAc,EADmB,CACnB,IAAO,CAAC,GAoB5B,IApBmC,GAG7B,YAAU,KACd,IAAM,EAAQ,EAAI,QAClB,GAAI,CAAC,EAAO,OAOZ,IAAM,EAJa,OAAO,yBACxB,OAFwB,iBAAiB,UAGzC,WAE4B,IAC9B,GAAI,IAAgB,GAAW,EAAY,CACzC,IAAM,EAAQ,IAAI,MAAM,QAAS,SAAE,CAAQ,CAAC,EAC5C,EAAW,KAAK,EAAO,GACvB,EAAM,EADwB,WACxB,CAAc,EACtB,CACF,EAF6B,CAEzB,EAAa,EAAS,EAAQ,EAGhC,UAAC,SACC,KAAK,WACL,eAAW,EACX,eAAgB,EACf,GAAG,EACJ,SAAU,GACV,IAAK,EACL,MAAO,CACL,GAAG,EAAM,MACT,GAAG,EACH,SAAU,WACV,cAAe,OACf,QAAS,EACT,OAAQ,CACV,GAGN,GAOF,SAAS,EAAS,GAAkB,OAC3B,EAAU,UAAY,WAC/B,CANA,EAAkB,YAhEQ,EAgEM,kBAQhC,IAAM,EAAO,EACP,EAAQ,gICpLP,SAASA,EAAmB,UAAEC,CAAQ,CAAEC,QAAM,WAAEC,CAAS,CAA2B,EACvF,GAAM,CAACC,EAAaC,EAAe,CAAGC,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAW,EAAE,EACrD,CAACC,EAAWC,EAAa,CAAGF,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,EAAC,GA8B3C,GAAI,CAACC,GAAoC,IAAvBH,EAAYK,MAAM,CAAQ,OAAO,KAEnD,IAAMC,EAAwB,IAC1BR,EAAO,CACHS,GAAIC,OAAOC,UAAU,GACrBC,QAASC,EACTC,KAAM,MACV,EAGJ,EAEA,MAEI,CADA,EACA,QAACC,MAAAA,CAAId,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CAAC,OAAQf,aACvB,WAACc,MAAAA,CAAId,UAAU,yCACX,UAACgB,EAAAA,CAAQA,CAAAA,CAAChB,UAAU,yBACpB,UAACiB,OAAAA,CAAKjB,UAAU,+BAAsB,2BAE1C,UAACc,MAAAA,CAAId,UAAU,gCACVC,EAAYiB,GAAG,CAAC,CAACN,EAAYO,IAC1B,UAACC,EAAAA,CAAMA,CAAAA,CAEHC,QAAQ,UACRC,KAAK,KACLtB,UAAU,UACVuB,QAAS,IAAMhB,EAAsBK,YAEpCA,GANIO,QAY7B,4OC9EA,IAAMK,EAAOC,EAAAA,UAAgB,CAC3B,CAAC,WAAEzB,CAAS,CAAE,GAAG0B,EAAO,CAAEC,IACxB,UAACC,EAAAA,CAAMA,CAACd,GAAG,EACTa,IAAKA,EACL3B,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CACX,2DACAf,GAEF6B,WAAY,CACVC,MAAO,KACPC,UACE,8DACJ,EACAC,WAAY,CAAEC,KAAM,SAAUC,UAAW,IAAKC,QAAS,EAAG,EACzD,GAAGT,CAAK,IAIfF,EAAKY,WAAW,CAAG,OAEnB,IAAMC,EAAaZ,EAAAA,UAAgB,CAGjC,CAAC,WAAEzB,CAAS,CAAE,GAAG0B,EAAO,CAAEC,IAC1B,UAACb,MAAAA,CACCa,IAAKA,EACL3B,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CAAC,gCAAiCf,GAC9C,GAAG0B,CAAK,IAGbW,EAAWD,WAAW,CAAG,aAEzB,IAAME,EAAYb,EAAAA,UAAgB,CAGhC,CAAC,WAAEzB,CAAS,CAAE,GAAG0B,EAAO,CAAEC,IAC1B,UAACY,KAAAA,CACCZ,IAAKA,EACL3B,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CACX,qDACAf,GAED,GAAG0B,CAAK,IAGbY,EAAUF,WAAW,CAAG,YAExB,IAAMI,EAAkBf,EAAAA,UAAgB,CAGtC,CAAC,WAAEzB,CAAS,CAAE,GAAG0B,EAAO,CAAEC,IAC1B,UAACc,IAAAA,CACCd,IAAKA,EACL3B,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CAAC,gCAAiCf,GAC9C,GAAG0B,CAAK,IAGbc,EAAgBJ,WAAW,CAAG,kBAE9B,IAAMM,EAAcjB,EAAAA,UAAgB,CAGlC,CAAC,WAAEzB,CAAS,CAAE,GAAG0B,EAAO,CAAEC,IAC1B,UAACb,MAAAA,CAAIa,IAAKA,EAAK3B,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CAAC,WAAYf,GAAa,GAAG0B,CAAK,GAEhEgB,GAAYN,WAAW,CAAG,cAE1B,IAAMO,EAAalB,EAAAA,UAAgB,CAGjC,CAAC,CAAEzB,WAAS,CAAE,GAAG0B,EAAO,CAAEC,IAC1B,UAACb,MAAAA,CACCa,IAAKA,EACL3B,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CAAC,6BAA8Bf,GAC3C,GAAG0B,CAAK,GAGbiB,GAAWP,WAAW,CAAG,kFC7FzB,MAAe,CAAE,UAAU,cAAE,CCA7B,CDA8B,CCA9B,oBACA,WCDA,KACA,YAAgB,MAAS,IACzB,sCCuBA,MAvBA,QAuBe,CAvBf,OACA,GAAQ,EAAM,mBACd,OAAe,EAAM,aAGrB,MADA,UACA,oBFJA,CEIsD,CFJtD,EEIyD,MFJzD,MACQ,oBAAc,IACtB,KAEA,kBECA,eACA,iDAIA,GAFA,gBACA,iBACA,GAEA,GADA,SACA,iBACA,oCAAoD,EAAO,GAAG,MAAa,0BAE3E,YAAwB,KAAQ,IAChC,YAEA,QACA,CACA,OAAW,SDnBJ,MCmBmB,CDlB1B,iBACA,UACA,UACA,UACA,IACA,UACA,UACA,IACA,UACA,UACA,IACA,UACA,UACA,IACA,WACA,WACA,WACA,WACA,WACA,yBACA,ECF0B,EAC1B,wPCgCO,SAASQ,EAAyB,QACvCC,CAAM,aACNC,CAAW,QACX/C,CAAM,WACNgD,CAAS,WACT3C,CAAS,WACTJ,CAAS,CACqB,EAC9B,GAAM,CAACgD,EAAoBC,EAAsB,CAAG9C,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAE1D,EAAE,EACE,CAAC+C,EAAgBC,EAAkB,CACvChD,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAA2B,MAC/B,CAACiD,EAAWC,EAAa,CAAGlD,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAC,aACrC,CAACmD,EAAUC,EAAY,CAAGpD,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAC,IACnC,CAACqD,EAAUC,EAAY,CAAGtD,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,EAAC,GACnC,CAACuD,EAAcC,EAAgB,CAAGxD,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,EAAC,GAuIzByD,CAAAA,EAAAA,EAAAA,WAAAA,CAAWA,CACjC,MAAOC,IAELZ,EAAsB,GACpBa,EAAK5C,GAAG,CAAC,GACP6C,EAAIvD,EAAE,GAAKqD,EACP,CAAE,GAAGE,CAAG,CAAEC,UAAW,aAAuBC,SAAU,EAAG,EACzDF,IAIR,GAAI,CACF,IAAMG,EAAapB,EAAYqB,IAAI,CAAC,GAASC,EAAI5D,EAAE,GAAKqD,GACxD,GAAI,CAACK,EACH,MAAM,IADS,EACC,wBAIlB,IAAIG,EAAc,GACdC,EAAU,GAGVJ,EAAWK,GAAG,CAChBD,CADkB,CACRJ,EAAWK,GAAG,CAGxBF,EAAc,MAAM,IAAIG,QAAiBC,IACvC,IAAMC,EAAS,IAAIC,WACnBD,EAAOE,MAAM,CAAIC,IACf,GAAIA,EAAEC,MAAM,EAAEC,OAAQ,CAEpB,IAAMA,EAASF,EAAEC,MAAM,CAACC,MAAM,CAACC,QAAQ,GACjCC,EAASF,EAAOG,QAAQ,CAAC,WAC3BH,EAAOI,KAAK,CAAC,UAAU,CAAC,EAAE,CAC1BJ,EACJN,EAAQQ,EACV,MACER,CADK,CACG,GAEZ,EACAC,EAAOU,aAAa,CAAClB,EACvB,GAIFjB,EAAsB,GACpBa,EAAK5C,GAAG,CAAC,GAAU6C,EAAIvD,EAAE,GAAKqD,EAAQ,CAAE,GAAGE,CAAG,CAAEE,SAAU,EAAG,EAAIF,IAInE,IAAMsB,EAAW,MAAMC,MAAM,qBAAsB,CACjDC,OAAQ,OACRC,QAAS,CACP,eAAgB,kBAClB,EACAC,KAAMC,KAAKC,SAAS,CAAC,CACnBC,OAAQ/B,SACRhB,EACAgD,SAAU3B,EAAW4B,IAAI,CACzBC,SAAU7B,EAAWjC,IAAI,SACzBqC,cACAD,CACF,EACF,GAEA,GAAI,CAACgB,EAASW,EAAE,CAAE,CAChB,IAAMC,EAAY,MAAMZ,EAASa,IAAI,EACrC,OAAM,MAAUD,EAAUE,KAAK,EAAI,6BACrC,CAGAlD,EAAsB,GACpBa,EAAK5C,GAAG,CAAE6C,GAASA,EAAIvD,EAAE,GAAKqD,EAAQ,CAAE,GAAGE,CAAG,CAAEE,SAAU,EAAG,EAAIF,IAGnE,IAAMqC,EAAY,MAAMf,EAASa,IAAI,GAGrCjD,EAAsB,GACpBa,EAAK5C,GAAG,CAAC,GACP6C,EAAIvD,EAAE,GAAKqD,EACP,CACE,GAAGE,CAAG,CACNC,UAAW,WACXC,SAAU,IACVoC,QAASD,EAAUE,IAAI,EAEzBvC,GAGV,CAAE,MAAOoC,EAAO,CACdI,QAAQJ,KAAK,CAAC,6BAA8BA,GAG5ClD,EAAsB,GACpBa,EAAK5C,GAAG,CAAC,GACP6C,EAAIvD,EAAE,GAAKqD,EACP,CACE,GAAGE,CAAG,CACNC,UAAW,QACXC,SAAU,EACVuC,aACEL,aAAiBM,MAAQN,EAAMO,OAAO,CAAG,eAC7C,EACA3C,GAGV,CACF,EACA,CAACjB,EAAaD,EAAO,EAkCvB,IAAM8D,EAAc,UAClB,GAAI,GAAoBrD,EAASsD,IAAI,KAAMpD,IAApB,GAEvBC,GAAY,GAGZR,EALkE,GAMhEa,EAAK5C,GAAG,CAAC,GACP6C,EAAIvD,EAAE,GAAK0C,EAAe1C,EAAE,CACxB,CACE,GAAGuD,CAAG,CACN8C,UAAW,IACL9C,EAAI8C,SAAS,EAAI,EAAE,CACvB,UACEvD,EACAwD,OAAQ,gBACRC,UAAWC,KAAKC,GAAG,EACrB,EACD,EAEHlD,IAIR,GAAI,CAEF,IAAMsB,EAAW,MAAMC,MAAM,8BAA+B,CAC1DC,OAAQ,OACRC,QAAS,CACP,eAAgB,kBAClB,EACAC,KAAMC,KAAKC,SAAS,CAAC,CACnBC,OAAQ1C,EAAe1C,EAAE,QACzBqC,WACAS,CACF,EACF,GAEA,GAAI,CAAC+B,EAASW,EAAE,CAAE,CAChB,IAAMC,EAAY,MAAMZ,EAASa,IAAI,EACrC,OAAM,MAAUD,EAAUE,KAAK,EAAI,6BACrC,CAEA,IAAMpB,EAAS,MAAMM,EAASa,IAAI,GAGlCjD,EAAsB,GACpBa,EAAK5C,GAAG,CAAE6C,IACR,GAAIA,EAAIvD,EAAE,GAAK0C,EAAe1C,EAAE,CAAE,CAChC,IAAM0G,EAAmB,IAAKnD,EAAI8C,SAAS,EAAI,EAAE,CAAE,CAC7CM,EAAoBD,EAAiB5G,MAAM,CAAG,EAMpD,OAJI6G,GAAqB,GAAG,CAC1BD,CAAgB,CAACC,EAAkB,CAACL,MAAM,CAAG/B,EAAO+B,MAAAA,EAG/C,CAAE,GAAG/C,CAAG,CAAE8C,UAAWK,CAAiB,CAC/C,CACA,OAAOnD,CACT,IAIF,IAAMqD,EAAgB,CACpB5G,GAAIwG,KAAKC,GAAG,GAAGjC,QAAQ,GACvBnE,KAAM,SACNF,QAAS,CAAC;;UAER,EAAEuC,EAAe4C,IAAI,CAAC;UACtB,EAAExC,SAAS;QACb,EAAEyB,EAAO+B,MAAM,EAAE,CAInB,OAAM/G,EAAOqH,GAEb7D,EAAY,GACd,CAAE,MAAO4C,EAAO,CACdI,QAAQJ,KAAK,CAAC,yBAA0BA,GAGxClD,EAAsB,GACpBa,EAAK5C,GAAG,CAAE6C,IACR,GAAIA,EAAIvD,EAAE,GAAK0C,EAAe1C,EAAE,CAAE,CAChC,IAAM0G,EAAmB,IAAKnD,EAAI8C,SAAS,EAAI,EAAE,CAAE,CAC7CM,EAAoBD,EAAiB5G,MAAM,CAAG,EAOpD,OALI6G,GAAqB,GAAG,CAC1BD,CAAgB,CAACC,EAAkB,CAACL,MAAM,CACxC,CAAC,OAAO,EAAEX,aAAiBM,MAAQN,EAAMO,OAAO,CAAG,gCAGhD,CAAE,GAAG3C,CAAG,CAAE8C,UAAWK,CAAiB,CAC/C,CACA,OAAOnD,CACT,GAEJ,QAAU,CACRN,GAAY,EACd,EACF,SAEA,EAKE,EALE,CAKF,MALc,EAKb3C,MAAAA,CAAId,UAAW,CAAC,4CAA4C,EAAEA,EAAAA,CAAW,WACxE,WAACc,MAAAA,CAAId,UAAU,2DACb,WAACc,MAAAA,CAAId,UAAU,8BACb,UAACqH,EAAAA,CAAQA,CAAAA,CAACrH,UAAU,iBACpB,UAACuC,KAAAA,CAAGvC,UAAU,yBAAgB,0BAEhC,WAACoB,EAAAA,CAAMA,CAAAA,CACLE,KAAK,KACLD,QAAQ,QACRrB,UAAU,cACVuB,QAAS,IACP+F,SAASC,aAAa,CAAC,IAAIC,YAAY,wCAGzC,UAACC,EAAAA,CAACA,CAAAA,CAACzH,UAAU,YACb,UAACiB,OAAAA,CAAKjB,UAAU,mBAAU,gBAI9B,WAACc,MAAAA,CAAId,UAAU,gBACb,WAACoB,EAAAA,CAAMA,CAAAA,CACLG,QA/Xc,CA+XLmG,IA7Xf,IAAMC,EAAYL,SAASM,aAAa,CAAC,SACzCD,EAAU1F,IAAI,CAAG,OACjB0F,EAAUE,MAAM,CACd,kIACFF,EAAUG,QAAQ,EAAG,EAErBH,EAAUI,QAAQ,CAAIlD,IACpB,IAAMmD,EAAQ,EAAGlD,MAAM,CAAsBkD,KAAK,CAClD,GAAI,CAACA,GAA0B,IAAjBA,EAAM1H,MAAM,CAAQ,OAElC,IAAM2H,EAAOD,CAAK,CAAC,EAAE,CACfpC,EAASsC,KAAKC,MAAM,GAAGnD,QAAQ,CAAC,IAAIoD,SAAS,CAAC,EAAG,GAGjDC,EAA4B,CAChC7H,GAAIoF,EACJE,KAAMmC,EAAKnC,IAAI,CACf7D,KAAMgG,EAAKhG,IAAI,CACfX,KAAM2G,EAAK3G,IAAI,CACf0C,UAAW,OACXC,SAAU,CACZ,EAEAhB,EAAsB,GAAU,IAAIa,EAAMuE,EAAO,EAGjD,IAAM3D,EAAS,IAAIC,WACnBD,EAAOE,MAAM,CAAG,MAAO0D,IACrB,GAAKA,CAAD,CAAOxD,MAAM,EAAEC,QAAQ,EAEX,IAEhB,GAAI,CAKF9B,EAAuBa,GACrBA,EAAK5C,GAAG,CAAC,GACP6C,EAAIvD,EAAE,GAAKoF,EACP,CAAE,GAAG7B,CAAG,CAAEC,UAAW,aAAcC,SAAU,EAAG,EAChDF,IAKR,MAAM,IAAIS,QAAQ,GAAa+D,WAAW9D,EAAS,MAEnDxB,EAAsB,GACpBa,EAAK5C,GAAG,CAAE6C,GACRA,EAAIvD,EAAE,GAAKoF,EAAS,CAAE,GAAG7B,CAAG,CAAEE,SAAU,EAAG,EAAIF,IAInD,MAAM,IAAIS,QAAQ,GAAa+D,WAAW9D,EAAS,MAGnDxB,EAAsB,GACpBa,EAAK5C,GAAG,CAAC,GACP6C,EAAIvD,EAAE,GAAKoF,EACP,CACE,GAAG7B,CAAG,CACNC,UAAW,WACXC,SAAU,IACVoC,QAAS,CAAC,oCAAoC,EAAE4B,EAAKnC,IAAI,CAAC;AAAA;AAAA,4GAAiH,CAAC,EAE9K/B,GAGV,CAAE,MAAOyE,EAAK,CACZjC,QAAQJ,KAAK,CAAC,yBAA0BqC,GACxCvF,EAAsB,GACpBa,EAAK5C,GAAG,CAAC,GACP6C,EAAIvD,EAAE,GAAKoF,EACP,CACE,GAAG7B,CAAG,CACNC,UAAW,QACXC,SAAU,EACVuC,aAAc,4BAChB,EACAzC,GAGV,QAAU,CACRJ,GAAgB,EAClB,EACF,EAEAe,EAAO+D,OAAO,CAAG,KACfxF,EAAsB,GACpBa,EAAK5C,GAAG,CAAE6C,GACRA,EAAIvD,EAAE,GAAKoF,EACP,CACE,GAAG7B,CAAG,CACNC,UAAW,QACXwC,aAAc,qBAChB,EACAzC,IAGRJ,GAAgB,EAClB,EAEAe,EAAOU,aAAa,CAAC6C,EACvB,EAEAN,EAAUe,KAAK,EACjB,EAmRQ1I,UAAU,cACV2I,SAAUjF,YAEV,UAACkF,EAAAA,CAAMA,CAAAA,CAAC5I,UAAU,iBAAiB,yBAIrC,WAAC6I,EAAAA,IAAIA,CAAAA,CAACC,aAAa,YAAY9I,UAAU,mBACvC,WAAC+I,EAAAA,QAAQA,CAAAA,CAAC/I,UAAU,oCAClB,WAACgJ,EAAAA,WAAWA,CAAAA,CACVC,MAAM,YACN1H,QAAS,IAAM8B,EAAa,uBAC7B,cACaL,EAAmB1C,MAAM,CAAC,OAExC,UAAC0I,EAAAA,WAAWA,CAAAA,CACVC,MAAM,KACN1H,QAAS,IAAM8B,EAAa,MAC5BsF,SACE,CAACzF,GAA+C,aAA7BA,EAAec,SAAS,UAE9C,WAKH,WAACkF,EAAAA,WAAWA,CAAAA,CAACD,MAAM,YAAYjJ,UAAU,iBACvC,WAACwB,EAAAA,EAAIA,CAAAA,WACH,WAACa,EAAAA,EAAUA,CAAAA,CAACrC,UAAU,iBACpB,UAACsC,EAAAA,EAASA,CAAAA,CAACtC,UAAU,qBAAY,wBACjC,UAACwC,EAAAA,EAAeA,CAAAA,UAAC,4DAInB,UAACE,EAAAA,EAAWA,CAAAA,UACV,UAACyG,EAAAA,CAAUA,CAAAA,CAACnJ,UAAU,0BACpB,UAACc,MAAAA,CAAId,UAAU,qBACZgD,EAAmB9B,GAAG,CAAC,GACtB,WAACM,EAAAA,EAAIA,CAAAA,CAEHxB,UAAW,CAAC,gBAAgB,EAAEkD,GAAgB1C,KAAOuD,EAAIvD,EAAE,CAAG,iBAAmB,IAAI,WAErF,UAAC6B,EAAAA,EAAUA,CAAAA,CAACrC,UAAU,eACpB,WAACc,MAAAA,CAAId,UAAU,6CACb,WAACc,MAAAA,CAAId,UAAU,wCACb,UAACoJ,EAAAA,CAAIA,CAAAA,CAACpJ,UAAU,kCAChB,WAACc,MAAAA,WACC,UAACuI,KAAAA,CAAGrJ,UAAU,4CACX+D,EAAI+B,IAAI,GAEX,UAACrD,IAAAA,CAAEzC,UAAU,yCACV+D,EAAI9B,IAAI,SAIf,UAACqH,EAAAA,CAAKA,CAAAA,CACJjI,QACE0C,eAAIC,SAAS,CACT,UACkB,eAAlBD,EAAIC,SAAS,CACX,UACkB,UAAlBD,EAAIC,SAAS,CACX,cACA,qBAGTD,EAAIC,SAAS,QAKD,eAAlBD,EAAIC,SAAS,EACZ,WAAClD,MAAAA,CAAId,UAAU,sBACb,UAACuJ,EAAAA,CAAQA,CAAAA,CAACN,MAAOlF,EAAIE,QAAQ,CAAEjE,UAAU,QACzC,WAACyC,IAAAA,CAAEzC,UAAU,+CAAqC,eACnC+D,EAAIE,QAAQ,CAAC,UAKb,aAAlBF,EAAIC,SAAS,EACZ,UAACrB,EAAAA,EAAUA,CAAAA,CAAC3C,UAAU,oBACpB,UAACoB,EAAAA,CAAMA,CAAAA,CACLC,QAAQ,UACRC,KAAK,KACLtB,UAAU,SACVuB,QAAS,IAAM4B,EAAkBY,YAClC,mBAMc,UAAlBA,EAAIC,SAAS,EACZ,UAAClD,MAAAA,CAAId,UAAU,qBACb,WAACc,MAAAA,CAAId,UAAU,uDACb,UAACwJ,EAAAA,CAAWA,CAAAA,CAACxJ,UAAU,iBACtB+D,EAAIyC,YAAY,EAAI,2BA1DtBzC,EAAIvD,EAAE,YAqEtB0C,GAA+C,aAA7BA,EAAec,SAAS,EACzC,WAACxC,EAAAA,EAAIA,CAAAA,CAACxB,UAAU,iBACd,WAACqC,EAAAA,EAAUA,CAAAA,CAACrC,UAAU,iBACpB,UAACsC,EAAAA,EAASA,CAAAA,CAACtC,UAAU,qBAClBkD,EAAe4C,IAAI,GAEtB,UAACtD,EAAAA,EAAeA,CAAAA,UAAC,mDAInB,UAACE,EAAAA,EAAWA,CAAAA,UACV,UAACyG,EAAAA,CAAUA,CAAAA,CAACnJ,UAAU,0BACpB,UAACc,MAAAA,CAAId,UAAU,sCACb,UAACyJ,EAAAA,CAAeA,CAAAA,CACd9I,QACEuC,EAAemD,OAAO,EAAI,+BAMpC,UAAC1D,EAAAA,EAAUA,CAAAA,UACT,UAACvB,EAAAA,CAAMA,CAAAA,CAACG,QAAS,IAAM8B,EAAa,MAAOrD,UAAU,kBAAS,8CAQtE,UAACkJ,EAAAA,WAAWA,CAAAA,CAACD,MAAM,KAAKjJ,UAAU,gBAC/BkD,GACC,WAACpC,MAAAA,CAAId,UAAU,sBACb,WAACwB,EAAAA,EAAIA,CAAAA,WACH,WAACa,EAAAA,EAAUA,CAAAA,CAACrC,UAAU,iBACpB,WAACsC,EAAAA,EAASA,CAAAA,CAACtC,UAAU,sBAAY,aACpBkD,EAAe4C,IAAI,IAEhC,UAACtD,EAAAA,EAAeA,CAAAA,UAAC,iEAInB,UAACE,EAAAA,EAAWA,CAAAA,UACV,WAACgH,OAAAA,CACCC,SAAU,IACR9E,EAAE+E,cAAc,GAChBjD,GACF,EACA3G,UAAU,gCAEV,UAAC6J,EAAAA,CAAQA,CAAAA,CACPZ,MAAO3F,EACPwG,SAAU,GAAOvG,EAAYsB,EAAEC,MAAM,CAACmE,KAAK,EAC3Cc,YAAY,wCACZ/J,UAAU,iBAEZ,UAACoB,EAAAA,CAAMA,CAAAA,CACLa,KAAK,SACL0G,SAAU,CAACrF,EAASsD,IAAI,IAAMpD,GAAYT,WAEzCS,EAAW,gBAAkB,yBAMrCN,EAAe2D,SAAS,EACvB3D,EAAe2D,SAAS,CAACvG,MAAM,CAAG,GAChC,WAACkB,EAAAA,EAAIA,CAAAA,WACH,UAACa,EAAAA,EAAUA,CAAAA,CAACrC,UAAU,gBACpB,UAACsC,EAAAA,EAASA,CAAAA,CAACtC,UAAU,qBAAY,2BAInC,UAAC0C,EAAAA,EAAWA,CAAAA,UACV,UAACyG,EAAAA,CAAUA,CAAAA,CAACnJ,UAAU,0BACpB,UAACc,MAAAA,CAAId,UAAU,qBACZ,IAAIkD,EAAe2D,SAAS,CAAC,CAC3BmD,OAAO,GACP9I,GAAG,CAAC,CAAC+I,EAAI9I,IACR,WAACL,MAAAA,CAECd,UAAU,kDAEV,WAACyC,IAAAA,CAAEzC,UAAU,gCAAsB,MAC7BiK,EAAG3G,QAAQ,IAEjB,WAACxC,MAAAA,CAAId,UAAU,yBACb,UAACyC,IAAAA,UAAE,QACH,UAACgH,EAAAA,CAAeA,CAAAA,CAAC9I,QAASsJ,EAAGnD,MAAM,QARhC3F,2BAvN5B,IA+OX,uMC9qBA,IAAM+I,EAASzI,EAAAA,UAAgB,CAG7B,CAAC,WAAEzB,CAAS,CAAE,GAAG0B,EAAO,CAAEC,IACxB,UAACwI,EAAAA,EAAqB,EAClBnK,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CACT,8XACAf,GAEH,GAAG0B,CAAK,CACTC,IAAKA,WAEL,UAACwI,EAAAA,EAAsB,EACnBnK,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CACT,mLAKhBmJ,EAAO9H,WAAW,CAAG+H,EAAAA,EAAqB,CAAC/H,WAAW,mTCiC/C,SAASgI,EAAkB,QAChCvH,CAAM,QACN9C,CAAM,WACNgD,CAAS,WACT3C,CAAS,WACTJ,CAAS,CACc,EACvB,GAAM,CAACuE,EAAK8F,EAAO,CAAGlK,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAC,IACzB,CAACmK,EAAUC,EAAY,CAAGpK,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAC,IACnC,CAACqK,EAAYC,EAAc,CAAGtK,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,EAAC,GACvC,CAACgG,EAAOuE,EAAS,CAAGvK,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAgB,MAC5C,CAACwK,EAAiBC,EAAmB,CAAGzK,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAmB,EAAE,EACrE,CAAC0K,EAAwBC,EAA0B,CAAG3K,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAC,IAC/D,CAAC8D,EAAU8G,EAAY,CAAG5K,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAC,GACnC,CAAC6K,EAAYC,EAAc,CAAG9K,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAqB,QAE3D+K,EAAqB,UACzB,GAAI,CAAC3G,EAAIqC,IAAI,GAAI,YACf8D,EAAS,gCAIXD,GAAc,GACdC,EAAS,MACTK,EAAY,GAEZ,GAAI,CAEF,IAAMI,EAAmBC,YAAY,KACnCL,EAAY,IACV,IAAMM,EAAcvH,EAAuB,GAAhBoE,KAAKC,MAAM,GACtC,OAAOkD,EAAc,GAAK,GAAKA,CACjC,EACF,EAAG,IAIH,OAAM,IAAI7G,QAAQ,GAAa+D,WAAW9D,EAAS,MAEnD6G,cAAcH,GACdJ,EAAY,KAGZ,IAAMQ,EAA4B,KAChChH,EACAiH,MAAO,CAAC,aAAa,EAAEjH,EAAAA,CAAK,CAC5B5D,QAAS,CAAC,6BAA6B,EAAE4D,EAAI,+EAA+E,CAAC,CAC7HwC,UAAWC,KAAKC,GAAG,GACnBwE,SAAU,CACRC,OAAQ,IACRC,YAAa,YACbC,gBAAiBf,EACb,CACEgB,aAAc,qBACdC,WAAY,WACZC,iBAAkB,GAClBC,UAAW,CAAC,gBAAiB,SAAS,CACtCC,UAAW,CAAC,OAAQ,OAAQ,eAAe,CAC3CC,aAAc,CACZ,iBACA,6BACA,0BACA,uBACD,CACDC,UAAW,CACT,8BACA,yBACA,sCACA,oDACD,OAEHC,CACN,CACF,EAEAxB,EAAmB,GAAU,CAACW,KAAczH,EAAK,EACjDmH,EAAc,WAGd,IAAMvE,EAAmB,CACvBlG,GAAI,CAAC,OAAO,EAAEwG,KAAKC,GAAG,IAAI,CAC1BpG,KAAM,YACNF,QAAS,CAAC,6BAA6B,EAAE4D,IAAI;;;;AAIrD,EACEsG,EACI,CAAC;;iBAEU,EAAEU,EAAUE,QAAQ,EAAEG,iBAAiBC,aAAa;eACtD,EAAEN,EAAUE,QAAQ,EAAEG,iBAAiBE,WAAW;qBAC5C,EAAEP,EAAUE,QAAQ,EAAEG,iBAAiBG,iBAAiB;aAChE,EAAER,EAAUE,QAAQ,EAAEG,iBAAiBI,WAAWK,KAAK,MAAM;cAC5D,EAAEd,EAAUE,QAAQ,EAAEG,iBAAiBK,WAAWI,KAAK,MAAM;;;AAG3E,EAAEd,EAAUE,QAAQ,EAAEG,iBAAiBM,cAAchL,IAAI,GAAS,CAAC,EAAE,EAAEoL,EAAAA,CAAK,EAAED,KAAK,MAAM;;;AAGzF,EAAEd,EAAUE,QAAQ,EAAEG,iBAAiBO,WAAWjL,IAAI,GAAW,CAAC,EAAE,EAAEqL,EAAAA,CAAO,EAAEF,KAAK,MAAM;AAC1F,CAAC,CACKd,EAAU5K,OAAO,CACtB;;oEAEmE,CAAC,CAG/D,OAAMZ,EAAO2G,GACb2D,EAAO,GACT,CAAE,MAAO7B,EAAU,CACjBkC,EAASlC,EAAI9B,OAAO,EAAI,uBAC1B,QAAU,CACR+D,EAAc,GAChB,CACF,EAEM+B,EAAmB,UACvB,GAAI,CAAClC,EAAS1D,IAAI,GAAI,YACpB8D,EAAS,+BAIX,IAAM+B,EAAOnC,EACVnF,KAAK,CAAC,SACNjE,GAAG,CAAC,GAASqD,EAAIqC,IAAI,IACrB8F,MAAM,CAAC,GAASnI,EAAIjE,MAAM,CAAG,GAEhC,GAAImM,MAAKnM,MAAM,CAAQ,YACrBoK,EAAS,uBAIXD,GAAc,GACdC,EAAS,MACTK,EAAY,GAEZ,GAAI,CACF,IAAI4B,EAAiB,EACfC,EAA4B,EAAE,CAEpC,IAAK,IAAMrI,KAAOkI,EAEhB1B,EAAY,CAFU,CAEQ0B,EAAKnM,MAAM,CAAI,KAG7C,MAAM,IAAIkE,QAAQ,GAAa+D,WAAW9D,EAAS,MAGnDmI,EAAQC,IAAI,CAAC,KACXtI,EACAiH,MAAO,CAAC,aAAa,EAAEjH,EAAAA,CAAK,CAC5B5D,QAAS,CAAC,6BAA6B,EAAE4D,EAAI,+EAA+E,CAAC,CAC7HwC,UAAWC,KAAKC,GAAG,GACnBwE,SAAU,CACRC,OAAQ,IACRC,YAAa,YACbC,gBAAiBf,EACb,CACEgB,aAAc,uBACdC,WAAY,qBACZC,iBAAkB,GAClBC,UAAW,CAAC,gBAAiB,SAAS,CACtCC,UAAW,CAAC,YAAa,eAAe,CACxCC,aAAc,CACZ,iBACA,6BACA,0BACD,CACDC,UAAW,CACT,sCACA,0BACA,+BACD,OAEHC,CACN,CACF,GAEAO,IAGF5B,EAAY,KACZH,EAAmB,GAAU,IAAIgC,KAAY9I,EAAK,EAClDmH,EAAc,WAGd,IAAMvE,EAAmB,CACvBlG,GAAI,CAAC,YAAY,EAAEwG,KAAKC,GAAG,IAAI,CAC/BpG,KAAM,YACNF,QAAS,CAAC;;2BAES,EAAE8L,EAAKnM,MAAM,CAAC;;AAEzC,EAAEsM,EACC1L,GAAG,CACF,CAAC6D,EAAQ5D,IAAU,CAAC;SACf,EAAEA,EAAQ,EAAE,EAAE,EAAE4D,EAAOR,GAAG,CAAC;AACpC,EACEsG,GAA0B9F,EAAO0G,QAAQ,EAAEG,gBACvC,CAAC;iBACU,EAAE7G,EAAO0G,QAAQ,CAACG,eAAe,CAACC,YAAY,CAAC;eACjD,EAAE9G,EAAO0G,QAAQ,CAACG,eAAe,CAACE,UAAU,CAAC;qBACvC,EAAE/G,EAAO0G,QAAQ,CAACG,eAAe,CAACG,gBAAgB,CAAC;cAC1D,EAAEhH,EAAO0G,QAAQ,CAACG,eAAe,CAACK,SAAS,EAAEI,KAAK,MAAM;AACtE,CAAC,CACK,CAAC,kBAAkB,EAAEtH,EAAOpE,OAAO,CAACL,MAAM,CAAC,WAAW,CAAC,CAC5D;AACD,CAAC,EAEE+L,IAAI,CAAC,MAAM;;sDAEwC,CAAC,CAGjD,OAAMtM,EAAO2G,GACb6D,EAAY,GACd,CAAE,MAAO/B,EAAU,CACjBkC,EAASlC,EAAI9B,OAAO,EAAI,wBAC1B,QAAU,CACR+D,GAAc,EAChB,CACF,SAEA,EAKE,EALE,CAKF,QAAC3J,MAAAA,CAAId,UAAW,CAAC,4CAA4C,EAAEA,EAAAA,CAAW,WACxE,WAACc,MAAAA,CAAId,UAAU,2DACb,WAACc,MAAAA,CAAId,UAAU,8BACb,UAAC8M,EAAAA,CAAMA,CAAAA,CAAC9M,UAAU,iBAClB,UAACuC,KAAAA,CAAGvC,UAAU,yBAAgB,mBAEhC,WAACc,MAAAA,CAAId,UAAU,uBACb,UAACoB,EAAAA,CAAMA,CAAAA,CACLE,KAAK,KACLD,QAAQ,UACRE,QAAS,IACP0J,EAA6B,WAAS,UAAY,iBAGnDD,WAAwB,eAAiB,eAE5C,WAAC5J,EAAAA,CAAMA,CAAAA,CACLE,KAAK,KACLD,QAAQ,QACRrB,UAAU,cACVuB,QAAS,IACP+F,SAASC,aAAa,CAAC,IAAIC,YAAY,iCAGzC,UAACC,EAAAA,CAACA,CAAAA,CAACzH,UAAU,YACb,UAACiB,OAAAA,CAAKjB,UAAU,mBAAU,mBAKhB,SAAfgL,EACC,WAACxJ,EAAAA,EAAIA,CAAAA,WACH,WAACa,EAAAA,EAAUA,CAAAA,WACT,UAACC,EAAAA,EAASA,CAAAA,CAACtC,UAAU,mBAAU,wBAC/B,UAACwC,EAAAA,EAAeA,CAAAA,UAAC,mDAInB,WAACE,EAAAA,EAAWA,CAAAA,CAAC1C,UAAU,sBACrB,WAACc,MAAAA,CAAId,UAAU,sBACb,WAACc,MAAAA,CAAId,UAAU,sBACb,UAAC+M,EAAAA,CAAKA,CAAAA,CAACC,QAAQ,eAAM,kBACrB,WAAClM,MAAAA,CAAId,UAAU,uBACb,UAACiN,EAAAA,CAAKA,CAAAA,CACJzM,GAAG,MACHyB,KAAK,MACL8H,YAAY,uCACZd,MAAO1E,EACPuF,SAAU,GAAOO,EAAOxF,EAAEC,MAAM,CAACmE,KAAK,EACtCN,SAAU6B,IAEZ,UAACpJ,EAAAA,CAAMA,CAAAA,CACLG,QAAS2J,EACTvC,SAAU6B,GAAc,CAACjG,EAAIqC,IAAI,YAEhC4D,EACC,UAAC0C,EAAAA,CAAOA,CAAAA,CAAClN,UAAU,yBAEnB,iBAMR,WAACc,MAAAA,CAAId,UAAU,0BACb,UAAC+M,EAAAA,CAAKA,CAAAA,CAACC,QAAQ,YAAYhN,UAAU,sBAAa,6BAGlD,UAAC6J,EAAAA,CAAQA,CAAAA,CACPrJ,GAAG,YACHuJ,YAAY,uEACZd,MAAOqB,EACPR,SAAU,GAAOS,EAAY1F,EAAEC,MAAM,CAACmE,KAAK,EAC3CN,SAAU6B,EACV2C,KAAM,EACNnN,UAAU,SAEZ,WAACoB,EAAAA,CAAMA,CAAAA,CACLG,QAASiL,EACT7D,SAAU6B,GAAc,CAACF,EAAS1D,IAAI,GACtC5G,UAAU,mBAETwK,EACC,UAAC0C,EAAAA,CAAOA,CAAAA,CAAClN,UAAU,8BACjB,KACHwK,EAAa,gBAAkB,wBAIpC,WAAC1J,MAAAA,CAAId,UAAU,6CACb,UAACkK,EAAAA,CAAMA,CAAAA,CACL1J,GAAG,eACH4M,QAASvC,EACTwC,gBAAiBvC,EACjBnC,SAAU6B,IAEZ,UAACuC,EAAAA,CAAKA,CAAAA,CAACC,QAAQ,wBAAe,mCAIjCxC,GACC,WAAC1J,MAAAA,CAAId,UAAU,sBACb,WAACc,MAAAA,CAAId,UAAU,yCACb,UAACiB,OAAAA,UAAK,4BACN,WAACA,OAAAA,WAAMiH,KAAKoF,KAAK,CAACrJ,GAAU,UAE9B,UAACsF,EAAAA,CAAQA,CAAAA,CAACN,MAAOhF,EAAUjE,UAAU,WAIxCmG,GACC,WAACoH,EAAAA,EAAKA,CAAAA,CAAClM,QAAQ,wBACb,UAACmI,EAAAA,CAAWA,CAAAA,CAACxJ,UAAU,YACvB,UAACwN,EAAAA,EAAUA,CAAAA,UAAC,UACZ,UAACC,EAAAA,EAAgBA,CAAAA,UAAEtH,aAM3B,WAACrF,MAAAA,CAAId,UAAU,sBACb,WAACuC,KAAAA,CAAGvC,UAAU,wBAAc,qBACP2K,EAAgBrK,MAAM,CAAC,OAG3CqK,MAAgBrK,MAAM,CACrB,UAACQ,MAAAA,CAAId,UAAU,iDAAwC,wDAIvD,UAACmJ,EAAAA,CAAUA,CAAAA,CAACnJ,UAAU,iCACpB,UAACc,MAAAA,CAAId,UAAU,0BACZ2K,EAAgBzJ,GAAG,CAAC,CAAC6D,EAAQ5D,IAC5B,WAACK,EAAAA,EAAIA,CAAAA,CAEHxB,UAAU,4BAEV,WAACqC,EAAAA,EAAUA,CAAAA,CAACrC,UAAU,iBACpB,WAACsC,EAAAA,EAASA,CAAAA,CAACtC,UAAU,8CACnB,UAAC0N,EAAAA,CAAQA,CAAAA,CAAC1N,UAAU,YACpB,UAAC2N,IAAAA,CACCC,KAAM7I,EAAOR,GAAG,CAChBO,OAAO,SACP+I,IAAI,sBACJ7N,UAAU,sEAET+E,EAAOR,GAAG,MAGf,WAACzD,MAAAA,CAAId,UAAU,sCACb,UAACsJ,EAAAA,CAAKA,CAAAA,CAACjI,QAAQ,UAAUrB,UAAU,mBAChC,IAAIgH,KAAKjC,EAAOgC,SAAS,EAAE+G,cAAc,KAE3C/I,EAAO0G,QAAQ,EAAEG,iBAChB,WAACtC,EAAAA,CAAKA,CAAAA,CAACjI,QAAQ,YAAYrB,UAAU,oBAAU,SACtC,IACN+E,EAAO0G,QAAQ,CAACG,eAAe,CAACG,gBAAgB,CAAC,aAK1D,WAACrJ,EAAAA,EAAWA,CAAAA,CAAC1C,UAAU,oBACpB+E,EAAO0G,QAAQ,EAAEG,gBAChB,WAAC9K,MAAAA,CAAId,UAAU,sBACb,WAACc,MAAAA,WACC,UAACG,OAAAA,CAAKjB,UAAU,uBAAc,UAAa,IAC1C+E,EAAO0G,QAAQ,CAACG,eAAe,CAACC,YAAY,CAAC,KAC7C9G,EAAO0G,QAAQ,CAACG,eAAe,CAACE,UAAU,CAAC,OAE7C/G,EAAO0G,QAAQ,CAACG,eAAe,CAACI,SAAS,EACxC,WAAClL,MAAAA,WACC,UAACG,OAAAA,CAAKjB,UAAU,uBAAc,eAAkB,IAC/C+E,EAAO0G,QAAQ,CAACG,eAAe,CAACI,SAAS,CAACK,IAAI,CAC7C,SAILtH,EAAO0G,QAAQ,CAACG,eAAe,CAACK,SAAS,EACxC,WAACnL,MAAAA,WACC,UAACG,OAAAA,CAAKjB,UAAU,uBAAc,gBAAmB,IAChD+E,EAAO0G,QAAQ,CAACG,eAAe,CAACK,SAAS,CAACI,IAAI,CAC7C,SAILtH,EAAO0G,QAAQ,CAACG,eAAe,CAACM,YAAY,EAC3C,WAACpL,MAAAA,WACC,UAACG,OAAAA,CAAKjB,UAAU,uBAAc,kBAC9B,UAAC+N,KAAAA,CAAG/N,UAAU,0BACX+E,EAAO0G,QAAQ,CAACG,eAAe,CAACM,YAAY,CAAChL,GAAG,CAC/C,CAACoL,EAAK0B,IACJ,UAACC,KAAAA,UAAY3B,GAAJ0B,YAQrB,UAACvE,EAAAA,CAAeA,CAAAA,CACd9I,QAASoE,EAAOpE,OAAO,CAACyH,SAAS,CAAC,EAAG,KAAO,QAGhD,UAAChH,EAAAA,CAAMA,CAAAA,CACLC,QAAQ,OACRrB,UAAU,0BACVuB,QAAS,KAEP,IAAMmF,EAAmB,CACvBlG,GAAI,CAAC,OAAO,EAAEwG,KAAKC,GAAG,IAAI,CAC1BpG,KAAM,YACNF,QAAS,CAAC,4BAA4B,EAAEoE,EAAOR,GAAG,CAAC,oEAAoE,CAAC,EAE1HxE,EAAO2G,EACT,WACD,qBAjFE,GAAG3B,EAAOR,GAAG,CAAC,CAAC,EAAEpD,EAAAA,CAAO,aA1ItC,IAwOX,qLC7fA,SAAS4L,EAAM,WACb/M,CAAS,CACT,GAAG0B,EAC8C,EACjD,MACE,UAACwM,EAAAA,CAAmB,EAClBC,YAAU,QACVnO,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CACX,sNACAf,GAED,GAAG0B,CAAK,EAGf,oFCRM,MAAqB,cAAgB,CAAC,oBAAsB,EAChE,CAAC,MAAQ,EAAE,EAAG,CAAc,gBAAK,SAAU,EAC3C,CAAC,MAAQ,EAAE,EAAG,CAAW,aAAK,SAAU,EACxC,CAAC,MAAQ,EAAE,EAAG,CAAY,cAAK,SAAU,EACzC,CAAC,MAAQ,EAAE,EAAG,CAAU,YAAK,SAAU,EACxC,8DCoCD,IAAM0M,EAA2B,CAACC,EAAiBC,EAAAA,CAAa,GASvDC,CARmC,CACxCC,GAAI,QACJC,GAAI,QACJC,GAAI,QACJC,GAAI,OAEN,EAEgB,CAACN,EAAO,EAAI,QAGjBO,CAH0B,CAGH,CAAC,UACnCC,CAAQ,SACRC,CAAO,OACPC,CAAK,QANuE,EAOnET,EAAAA,CAAa,CACM,IAC5B,GAAM,CAACU,EAAaC,EAAe,CAAG9O,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,EAAC,GACzC,CAAC+O,EAAaC,EAAe,CAAGhP,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,EAAC,GACzCiP,EAAiBC,CAAAA,EAAAA,EAAAA,MAAAA,CAAMA,CAA2B,MAGlDC,EAAWlB,EAAyBC,GAE1CkB,CAAAA,EAAAA,EAAAA,SAAAA,CAASA,CAAC,KAER,IAAMC,EACJ,OAAgBC,iBAAiB,EACjC,OAAgBC,uBAAuB,CAEzC,GAAI,KAAgC,IAAzBF,EAAsC,CAC/CL,GAAe,GACf,GAAI,CAEFC,EAAeO,OAAO,CACpB,IAAKH,CACT,CAAE,MAAOrJ,EAAO,CACdI,QAAQJ,KAAK,CAAC,0CAA2CA,GACzDgJ,GAAe,GACf,MACF,CAGIC,EAAeO,OAAO,EAAE,CAC1BP,EAAeO,OAAO,CAACC,UAAU,EAAG,EACpCR,EAAeO,OAAO,CAACE,cAAc,EAAG,EACxCT,EAAeO,OAAO,CAACG,IAAI,CAAGR,EAE9BF,EAAeO,OAAO,CAACI,QAAQ,CAAG,IAChC,IAAIC,EAAkB,GAClBC,EAAoB,GAClBrD,EAAU,EAAkCA,OAAO,CAEzD,IACE,IAAIoB,EAAI,EAAkCkC,WAAW,CACrDlC,EAAIpB,EAAQtM,MAAM,CAClB,EAAE0N,EACF,CACW,CAACA,EAAE,CAACmC,OAAO,CACpBH,CADsB,EACHpD,CAAO,CAACoB,EAAE,CAAC,EAAE,CAACoC,UAAU,CAAG,IAE9CH,GAAqBrD,CAAO,CAACoB,EAAE,CAAC,EAAE,CAACoC,UAAU,CAGjD,IAAMA,EAAaJ,EAAgBpJ,IAAI,IAAMqJ,EAAkBrJ,IAAI,GAC/DwJ,GACFvB,EAASuB,EAEb,EAEAhB,EAAeO,CALG,MAKI,CAAClH,OAAO,CAAIH,IAChC,IAAMnC,EAAQmC,EAAMnC,KAAK,EAAI,gBAC7BI,QAAQJ,KAAK,CAAC,4BAA6BA,GACvC2I,GACFA,EAAQ3I,GAIV,CALa,GAKPkK,EAAO,KACX,GAAIjB,EAAeO,OAAO,EAAIX,EAC5B,GAAI,CACFI,EAAeO,KAFwB,EAEjB,CAACU,IAAI,EAC7B,CAAE,MAAOxL,EAAG,CACV0B,QAAQJ,KAAK,CAAC,aAActB,GAC5BoK,GAAe,EACjB,CAEJ,CAEI9I,kBAAmC,WAAW,CAArBA,EAC3BkK,KAEU,gBAAVlK,GACU,wBAAVA,CAAU,GACV,CACAgJ,GAAe,GACfkB,IAEJ,EAEAjB,EAAeO,OAAO,CAACW,KAAK,CAAG,KACzBvB,GACFA,IAEFE,GAAe,EACjB,EAEJ,MACE1I,CADK,OACGgK,IAAI,CAAC,yDACbpB,GAAe,GAIjB,MAAO,KACL,GAAIC,EAAeO,OAAO,CAAE,CAC1BP,EAAeO,OAAO,CAACI,QAAQ,CAAG,KAClCX,EAAeO,OAAO,CAAClH,OAAO,CAAG,KACjC2G,EAAeO,OAAO,CAACW,KAAK,CAAG,KAC/B,GAAI,CACFlB,EAAeO,OAAO,CAACU,IAAI,EAC7B,CAAE,MAAOxL,EAAG,CAEZ,CACF,CACF,CAEF,EAAG,CAACyK,EAAS,EAEb,CAFgB,GAEVkB,EAAiB5M,CAAAA,EAAAA,EAAAA,WAAAA,CAAWA,CAAC,KACjC,GAAIwL,EAAeO,OAAO,EAAIT,GAAe,CAACF,EAC5C,GAAI,CACFI,EAAeO,KAFwC,EAEjC,CAACc,KAAK,GAC5BxB,GAAe,EACjB,CAAE,KAP2F,CAOpF9I,EAAO,CACdI,QAAQJ,KAAK,CAAC,qCAAsCA,GAChD2I,GAASA,EAAQ3I,GACrB8I,GAAe,EACjB,KACS,CAACC,IACV3I,QAAQgK,CADe,GACX,CAAC,sDACTzB,GAASA,EAAQ,iBAEzB,EAAG,CAACE,EAAaE,EAAaJ,EAAQ,EAEhC4B,EAAgB9M,CAAAA,EAAAA,EAAAA,WAAAA,CAAWA,CAAC,KAChC,GAAIwL,EAAeO,OAAO,EAAIX,EAC5B,GAAI,CACFI,EAAeO,KAFwB,EAEjB,CAACU,IAAI,EAC7B,CAAE,MAAOlK,EAAO,CACdI,QAAQJ,KAAK,CAAC,qCAAsCA,GAEpD8I,GAAe,EACjB,CAGJ,EAAG,CAACD,EAAY,EAEhB,MAAO,aAAEA,EAAawB,+BAAgBE,cAAexB,CAAY,CACnE,EAAE,sKC1MK,SAASyB,IACd,GAAM,CAAEC,SAAUC,CAAY,CAAE,CAAGC,CAAAA,EAAAA,EAAAA,EAAAA,CAAWA,GACxCC,EAAgBC,CAAAA,EAAAA,EAAAA,EAAAA,CAAgBA,GAMhCC,EAAaC,EAAAA,EAAmBA,CAAC/M,IAAI,CACzC,GAASgN,EAAIC,IAAI,GAAKP,EAAaO,IAAI,EAGnCC,EAAoBJ,GAAYK,UAEtC,MACE,UAACxQ,MAAAA,CACCd,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CACX,2FACA,uBACA,kBAGF,WAACD,MAAAA,CAAId,UAAU,iCACb,WAACc,MAAAA,CAAId,UAAU,yEACb,WAACc,MAAAA,CAAId,UAAU,kCACZ6Q,EAAarF,KAAK,EAAIyF,GAAYG,MAAQ,WAClB,cAAxBP,EAAanF,MAAM,EAClB,UAACzK,OAAAA,CAAKjB,UAAU,8CAAqC,sBAKzD,UAACoB,EAAAA,CAAMA,CAAAA,CACLC,QAAQ,QACRC,KAAK,OACLC,QA/BU,CA+BDgQ,IA9BjBR,GACF,EA8BU/Q,UAAU,mBAEV,UAACyH,EAAAA,CAACA,CAAAA,CAACzH,UAAU,iBAIjB,UAACc,MAAAA,CAAId,UAAU,kCACb,UAACmJ,EAAAA,CAAUA,CAAAA,CAACnJ,UAAU,kBACpB,UAACc,MAAAA,CAAId,UAAU,eACZqR,EACC,UAACA,EAAAA,CAAkBT,SAAUC,IAE7B,UAAC/P,MAAAA,CAAId,UAAU,mDACb,UAACyC,IAAAA,CAAEzC,UAAU,iCACV6Q,EAAaO,IAAI,CACd,CAAC,gBAAgB,EAAEP,EAAaO,IAAI,CAAC,UAAU,CAAC,CAChD,sCAUxB,uFC5DM,MAAe,cAAgB,CAAC,cAAgB,EACpD,CAAC,QAAU,EAAE,EAAI,MAAM,CAAI,OAAM,CAAG,KAAK,GAAK,UAAU,EACxD,CAAC,QAAU,EAAE,EAAI,MAAM,CAAI,MAAK,CAAG,KAAK,GAAK,UAAU,EACvD,CAAC,QAAU,EAAE,EAAI,MAAM,CAAI,OAAM,CAAG,KAAK,GAAK,UAAU,EACzD,8FCTM,SAASI,EAAuB,WAAExR,CAAS,CAA+B,EAC7E,MACI,WAACc,MAAAA,CAAId,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CAAC,0BAA2Bf,aAC1C,UAACc,MAAAA,CAAId,UAAU,gHACX,UAACiB,OAAAA,CAAKjB,UAAU,mBAAU,SAE9B,WAACc,MAAAA,CAAId,UAAU,4EACX,WAACc,MAAAA,CAAId,UAAU,2BACX,UAACc,MAAAA,CAAId,UAAU,iFACf,UAACc,MAAAA,CAAId,UAAU,kFACf,UAACc,MAAAA,CAAId,UAAU,4DAEnB,UAACiB,OAAAA,CAAKjB,UAAU,8CAAqC,qBAIrE,oFCXM,MAAQ,cAAgB,CAAC,OAAS,EACtC,CAAC,MAAQ,EAAE,EAAG,CAAmC,qCAAK,SAAU,EAChE,CACE,OACA,CACE,CAAG,gGACH,GAAK,SACP,EACF,CACA,CACE,OACA,CAAE,EAAG,kEAAoE,KAAK,QAAS,EACzF,CACA,CAAC,QAAU,EAAE,EAAI,MAAM,CAAI,OAAM,CAAG,MAAM,GAAK,UAAU,EAC1D,2MCjBM,eAAKyR,CAAAA,qEAAAA,OAKX,IAaYC,EAAwC,CACnDN,KAAM,KACN1F,OAAQ,OACRF,MAAO,GACP7K,QAAS,IACX,EAAE,EAwBuD,CACvD,CACEyQ,IAAI,QACJO,KAAMtK,EAAAA,CAAQA,CACdiK,UAAWM,EAAAA,CAAYA,CACvBC,aAAc,CAAC,YAAEC,CAAU,aAAEC,CAAW,CAAE,IAEhB,cAAc,CAAlCD,EAAW7P,IAAI,EACjB8P,EAAY,GAAY,EACtB,GADsB,CACd,CAERpR,QACE,CAA0B,UAAzB,OAAOqR,EAAMrR,OAAO,CAAgBqR,EAAMrR,OAAO,CAAG,GAAC,CACtDmR,EAAWnR,OAAO,CACpB+K,OAAQ,YACV,EAIJ,CACF,EACA,CACE0F,IAAI,QACJO,KAAMM,EAAAA,CAAIA,CACVX,UAAWY,EAAAA,CAAYA,CACvBL,aAAc,CAAC,YAAEC,CAAU,aAAEC,CAAW,CAAE,IAEpCD,cAAkC,GAAvB7P,IAAI,EACjB8P,EAAY,GAAY,EACtB,GADsB,CACd,CAERpR,QACE,CAA0B,UAAzB,OAAOqR,EAAMrR,OAAO,CAAgBqR,EAAMrR,OAAO,CAAG,GAAC,CACtDmR,EAAWnR,OAAO,CACpB+K,OAAQ,YACV,EAIJ,CACF,EACA,CACE0F,IAAI,SACJO,KAAMQ,EAAAA,CAAKA,CACXb,UAAWc,EAAAA,CAAaA,CACxBP,aAAc,CAAC,YAAEC,CAAU,CAAEC,aAAW,CAAE,IACxCA,EAAY,IAEV,IAAIM,EAAiBL,EAAMrR,OAAO,OAWlC,CATY,UAAVqR,CACCK,CADKjB,IAAI,EACU,OAAnBiB,GAC2B,UAA1B,EACA,KADOA,GACNA,EAAelF,IAAI,EACnBkF,EAAD,OAAuB,GACzB,EACiB,CAAEC,QAAS,EAAE,CAAEnF,KAAM,EAAE,CAAC,EAGnB,eAAe,CAAnC2E,EAAW7P,IAAI,EAIe,UAA9B,OAAO6P,EAAWnR,OAAO,EACzB4R,MAAMC,OAAO,CAACV,EAAWnR,OAAO,GAChC,CAEE,GAAGqR,CAAK,CACRrR,QAAS,CACP,GAAG0R,CAAc,CACjBlF,KAAM,IAAKkF,EAAelF,IAAI,EAAI,EAAE,IAAM2E,EAAWnR,OAAO,CAAC,EAE/D+K,OAAQ,WACV,EAIGsG,CACT,EACF,CACF,EAED,CAAC,qDALyE,ECzHrE,MAAU,cAAgB,CAAC,SAAW,EAC1C,CAAC,OAAQ,CAAE,MAAO,KAAM,CAAQ,UAAK,CAAG,KAAK,EAAG,CAAK,MAAI,CAAK,OAAK,SAAU,EAC7E,CAAC,MAAQ,EAAE,EAAG,CAA4C,8CAAK,SAAU,EACzE,CAAC,MAAQ,EAAE,EAAG,CAAY,cAAK,SAAU,EAC1C,oCCJK,MAAQ,cAAgB,CAAC,OAAS,EACtC,CAAC,QAAU,EAAE,EAAI,MAAM,CAAI,OAAM,CAAG,MAAM,GAAK,UAAU,EACzD,CAAC,UAAY,EAAE,OAAQ,CAAoB,sBAAK,SAAU,EAC3D,oCCHK,MAAY,cAAgB,CAAC,WAAa,EAC9C,CACE,OACA,CACE,CAAG,mHACH,GAAK,SACP,EACF,CACD,qICPD,IAAMnI,EAAWpI,EAAAA,UAAgB,CAC7B,CAAC,WAAEzB,CAAS,CAAE,GAAG0B,EAAO,CAAEC,IAElB,UAAC8Q,WAAAA,CACGzS,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CACT,uSACAf,GAEJ2B,IAAKA,EACJ,GAAGD,CAAK,IAKzBmI,EAASzH,WAAW,CAAG,2WC0DhB,SAASsQ,EAAqB,IACnClS,CAAE,WACFR,CAAS,YACT2S,GAAa,CAAK,CACQ,EAC1B,GAAM,CAAEC,MAAI,SAAEC,CAAO,CAAE,CAAGC,CAAAA,EAAAA,EAAAA,OAAAA,CAAOA,GAC3B,OAAEC,CAAK,CAAE,CAAGC,CAAAA,EAAAA,EAAAA,CAAAA,CAAQA,GACpBC,EAAWC,CAAAA,EAAAA,EAAAA,EAAAA,CAAkBA,GAmB7B,CAACC,EAAeC,EAAiB,CAAGjT,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAASK,GAAM6S,CAAAA,EAAAA,EAAAA,CAAAA,CAAMA,IACjE,CAACC,EAAcC,EAAgB,CAAGpT,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAC,UAC3C,CAACqT,EAAmBC,EAAqB,CAAGtT,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAC,WACrD,CAAC2C,EAAa4Q,EAAe,CAAGvT,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAuB,EAAE,EACjE,CAACwT,EAAcC,EAAgB,CAAGzT,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAC,oBAG3C0T,EAAgBC,CAAAA,EAAAA,EAAAA,EAAAA,CAAgBA,CAAEC,GAAUA,EAAMnD,QAAQ,EAC5CoD,CAAAA,EAAAA,EAAAA,EAAAA,CAAcA,GAClC,IAAMjD,EAAgBC,CAAAA,EAAAA,EAAAA,EAAAA,CAAgBA,GAGhCiD,EAA2C,OAAvBJ,EAAczC,IAAI,CACtC,CAAC8C,EAAmBC,EAAqB,CAAGhU,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAC,IACrD,CAACiU,EAA4BC,EAA8B,CAC/DlU,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,EAAC,GACL,CAACmU,EAAqBC,EAAuB,CAAGpU,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,EAAC,GACzD,CAACqU,EAAoBC,EAAsB,CAAGtU,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAC,IAGvDuU,EAAmB9Q,CAAAA,EAAAA,EAAAA,WAAAA,CAAWA,CAClC,MAAOf,IACL,GAAI,CAACoQ,EAAU,CACb1M,QAAQJ,KAAK,CACX,6EAEFyN,EAAgB,oBAChB,CADqC,KAEvC,CACA,GAAI,CAAC/Q,CAH6C,CAGrC,CACX0D,QAAQgK,IAAI,CACV,kEAGFqD,EAAgB,oBAChB,CADqC,KAEvC,CAIA,GAAI,CAEF,GAAM,CAAEe,KAAMC,CAAkB,CAAEzO,MAAO0O,CAAgB,CAAE,CACzD,MAAM5B,EAAS6B,IAAI,CAACC,UAAU,GAO5BF,GACFtO,QAAQJ,KAAK,CACX,CAFkB,2EAGlB0O,GAIA,GAAqBhC,SAAS,QACxBtC,IAAI,CACV,mHAIJ,GAAM,MAAEoE,CAAI,OAAExO,CAAK,CAAE,CAAG,MAAM8M,EAC3B+B,IAAI,CAAC,iBACLC,MAAM,CAAC,KACPC,EAAE,CAAC,KAAMrS,GACTsS,MAAM,GAET,GAAIhP,GAAS,CAACwO,EAAM,CAElB,IAAK,IAAIS,EAAU,EAAGA,GAAW,EAAGA,IAAW,CAC7C,MAAM,IAAI5Q,QAAQ,GAAS+D,WAAW8M,EAAe,IAAVD,IAC3C,GAAM,CAAET,KAAMW,CAAS,CAAEnP,MAAOoP,CAAQ,CAAE,CAAG,MAAMtC,EAChD+B,IAAI,CAAC,iBACLC,MAAM,CAAC,KACPC,EAAE,CAAC,KAAMrS,GACTsS,MAAM,GACT,GAAI,CAACI,GAAYD,GAAW9J,MAAO,YACjCoI,EAAgB0B,EAAU9J,KAAK,CAGnC,CACAjF,QAAQJ,KAAK,CACX,0FACAtD,EACA,kBACAsD,GAAS,oBAEXyN,EAAgB,oBAChB,MACF,CAEIe,EAAKnJ,KAAK,CAIZoI,CAJc,CAIEe,EAAKnJ,KAAK,EAM1BoI,EAAgB,mBAEpB,CAAE,MAAOpL,EAAU,CACjBjC,QAAQJ,KAAK,CACX,gFACAtD,EACA,iBACA2F,EACA,iBACAA,GAAK9B,QACL,eACA8B,GAAKgN,OAEP5B,EAAgB,mBAClB,CACF,EACA,CAACX,EAAS,CAAC,CAQP,UACJnT,CAAQ,OACR2V,CAAK,UACLC,CAAQ,cAXgD,KAYxDC,CAAiB,cACjBC,CAAY,MACZvF,CAAI,WACJtN,EAAS,CACToD,MAAO0P,EAAa,MACpBlB,EAAI,aACJmB,EAAW,QACX/V,EAAM,QACNgW,EAAM,CACP,CAAGC,CAAAA,EAAAA,EAAAA,EAAAA,CAAOA,CAAC,CACVC,IAlByB,CAkBpBC,WACL1V,GAAI2S,EACJgD,gBAAiB,EAAE,CACnB1Q,KAAM,CACJ2Q,kBAAmB9C,EACnB+C,WAAY7C,CACd,EACAhO,QAAS,CAEP,GAAIqN,GAASyD,cAAgB,CAC3BC,cAAe,CAAC,OAAO,EAAE1D,EAAQyD,YAAY,EAAE,CAChD,EAEHE,WAAY,IAAMnD,CAAAA,EAAAA,EAAAA,CAAAA,CAAMA,GACxBoD,SAAU,MAAO/P,IAGXyM,GAEF,MAAMuB,EAAiBvB,EAE3B,EAJqB,QAKZ,IACP5M,QAAQJ,KAAK,CACX,6CACAqC,EACA,eACA9C,KAAKC,SAAS,CAAC6C,IAEjB,IAAMhC,EACJ,GAAcE,SAAW,+CAC3BqM,EAAM,CACJvH,MAAO,aACPkL,YAAalQ,EACbnF,QAAS,aACX,EACF,CACF,GAkF+BgO,CAAAA,EAAAA,EAAAA,MAAAA,CAAMA,CAAC,CAAC,GAwDvC,IAAMsH,GAAmB/S,CAAAA,EAAAA,EAAAA,WAAAA,CAAWA,CAClC,MAAOiB,IAEL,GADAA,EAAE+E,cAAc,GACZ,CAAC6L,EAAM7O,IAAI,IAA6B,IAAvB9D,EAAYxC,MAAM,CAAQ,OAAOkE,QAAQC,OAAO,GACrE,IAAMmS,EAAmB9T,EACtB4J,MAAM,CAAEiB,QAAgBvB,IAAVuB,EAAEpJ,GAAG,EACnBrD,GAAG,CAAC,GAAQ,EACXV,GAAImN,EAAEnN,EAAE,CACRsF,KAAM6H,EAAE7H,IAAI,CACZvB,IAAKoJ,EAAEpJ,GAAG,CACVtC,KAAM0L,EAAE1L,IAAI,CACZX,KAAMqM,EAAErM,IAAI,EAAI,EAClB,GACIuV,EACJD,EAAiBtW,MAAM,CAAG,EAAIsW,OAAmBxK,EAQnD,OAHAwJ,EAAa/Q,EAAG,CAAE8P,KAJCkC,CAIKC,CAHpB,CAAEhU,YAAa+T,CAAmB,OAClCzK,CAE+B,GACnCsJ,EAAS,IACThC,EAAe,EAAE,EACVlP,QAAQC,OAAO,EACxB,EACA,CAACgR,EAAO3S,EAAa8S,EAAcF,EAAS,EAGxCqB,GAAenT,CAAAA,EAAAA,EAAAA,WAAAA,CAAWA,CAC9B,MAAOoT,IACL,GAAI,CAACA,EAEH,OADAzQ,QAAQgK,EADc,EACV,CAAC,8CACN/L,QAAQC,OAAO,GAGxB,GAAI8N,MAAMC,OAAO,CAACwE,GAChB,IAAK,IAAMC,KAAOD,EACZC,EAAItW,OAAO,EAAE,KADkB,CAE3BZ,GAAOkX,QAGRD,EAAkBrW,OAAO,EAAE,MAC9BZ,GAAOiX,GAEf,OAAOxS,QAAQC,OAAO,EACxB,EACA,CAAC1E,GAAO,EAGJmX,GAAmBtT,CAAAA,EAAAA,EAAAA,WAAAA,CAAWA,CAAC,UACnC,IAAMuT,EAAQ9D,CAAAA,EAAAA,EAAAA,CAAAA,CAAMA,GAYpB,OAVAD,EAAiB+D,GACjBrB,GAAY,EAAE,EACdpC,EAAe,EAAE,EACjBgC,EAAS,IACT3E,IACA6C,EAAgB,oBAChBb,EAAM,CACJvH,MAAO,mBACPkL,YAAa,CAAC,YAAY,EAAES,EAAM/O,SAAS,CAAC,EAAG,GAAG,GAAG,CACvD,GACO5D,QAAQC,OAAO,EACxB,EAAG,CAACiR,EAAU3C,EAAO+C,GAAa/E,EAAc,EAE1CqG,GAAsBxT,CAAAA,EAAAA,EAAAA,WAAAA,CAAWA,CACrC,IACMyT,IAAclE,IAElBC,EAAiBiE,GACjB3D,EAAe,EAAE,EACjBgC,EAAS,IACX,EACA,CAACvC,EAAeuC,EAAS,EAGrB4B,GAAiB1T,CAAAA,EAAAA,EAAAA,WAAAA,CAAWA,CAAC,KAEnC,EAAG,EAAE,EACC2T,GAAiB3T,CAAAA,EAAAA,EAAAA,WAAAA,CAAWA,CAAC,IAAMuQ,EAAqB,GAAO,CAACqD,GAAI,EAAE,EACtEC,GAA0B7T,CAAAA,EAAAA,EAAAA,WAAAA,CAAWA,CACzC,IAAMyQ,EAA+BmD,GAAM,CAACA,GAC5C,EAAE,EAEEE,GAAmB9T,CAAAA,EAAAA,EAAAA,WAAAA,CAAWA,CAClC,IAAM2Q,EAAuB,GAAO,CAACiD,GACrC,EAAE,EAEEG,GAAkB/T,CAAAA,EAAAA,EAAAA,WAAAA,CAAWA,CACjC,IAAM6Q,EAAsB,GAAO,CAAC+C,GACpC,EAAE,EAGEI,GAAoBhU,CAAAA,EAAAA,EAAAA,WAAAA,CAAWA,CACnC,GAAmB2P,EAAgBsE,GACnC,EAAE,EAEEC,GAAyBlU,CAAAA,EAAAA,EAAAA,WAAAA,CAAWA,CACxC,GAAiB6P,EAAqBsE,GACtC,EAAE,EAGEC,GAA8BpU,CAAAA,EAAAA,EAAAA,WAAAA,CAAWA,CAAC,IAC9CgQ,EAAgBqE,EAClB,EAAG,EAAE,SAEL,GAActF,EAWZ,GAXW,EAWX,KAXwB,CAWvB7R,MAAAA,CAAId,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CAAC,uBAAwBf,aACzC,UAACkY,EAAAA,CAAiBA,CAAAA,CAChBrV,OAAQsQ,EACRgF,aAAcxE,EACdyE,cAAe9E,EACf+E,mBAAoB7E,EACpB8E,cAAeV,GACfW,mBAAoBT,GACpBU,cAAeR,GACfrF,WAAYA,EACZ8F,aAAcvB,GACdwB,gBAAiBtB,GACjBE,eAAgBA,GAChBC,eAAgBA,GAChBE,wBAAyBA,GACzBC,iBAAkBA,GAClBC,gBAAiBA,GACjB1D,kBAAmBA,EACnBC,kBAAmBA,EACnBE,2BAA4BA,EAC5BE,oBAAqBA,EACrBE,mBAAoBA,IAEtB,WAAC1T,MAAAA,CAAId,UAAU,iDACb,UAACc,MAAAA,CACCd,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CACX,6BACAuT,GACEJ,GACAE,GACAI,EACE,2BACA,aAGN,UAACmE,EAAAA,CAAkBA,CAAAA,CACjB7Y,SAAUA,EACViD,UAAWA,GACXF,OAAQsQ,MAGXc,GAAqB,UAACtD,EAAAA,CAAeA,CAAAA,CAAAA,GACrCuD,GACC,UAAC0E,EAAAA,CAAwBA,CAAAA,CACvB/V,OAAQsQ,EACRpT,OAAQgX,GACRjX,SAAUA,EACViD,UAAWA,GACX3C,UAAW8T,EACXlU,UAAU,4BAGboU,GACC,UAACxR,EAAAA,CAAwBA,CAAAA,CACvBC,OAAQsQ,EACRpT,OAAQgX,GACRjU,YAAaA,EACbC,UAAWA,GACX3C,UAAWgU,EACXpU,UAAU,4BAGbsU,GACC,UAAClK,EAAAA,CAAiBA,CAAAA,CAChBvH,OAAQsQ,EACRpT,OAAQgX,GACRhU,UAAWA,GACX3C,UAAWkU,EACXtU,UAAU,4BAGbwU,GACC,UAACqE,EAAAA,CAAaA,CAAAA,CACZhW,OAAQsQ,EACRnT,UAAU,+BAIhB,WAACc,MAAAA,CAAId,UAAU,yBACb,UAACH,EAAAA,CAAkBA,CAAAA,CAACE,OAAQgX,GAAcjX,SAAUA,IACpD,UAACgZ,EAAAA,CAAmBA,CAAAA,CAClBrD,MAAOA,EACPC,SAAUA,EACVE,aAAce,GACd5T,UAAWA,GACXsN,KAAMA,EACNvN,YAAaA,EACb4Q,eAAgBA,EAChB7Q,OAAQsQ,EACR4F,UACElD,IAAiB,CAAC9S,GAAa8S,GAAcnP,OAAO,EAAI,KAAQ,aAnGtE,UAAClF,EAAAA,EAAIA,CAAAA,CAACxB,UAAU,uDACd,UAACyC,IAAAA,CAAEzC,UAAU,iCAAwB,sCAwG7C,mPC1mBO,IAAM8T,EAAmBkF,CAAAA,EAAAA,EAAAA,EAAAA,CAAMA,CAAgB,GAAU,EAC9DpI,CAD8D,QACpDc,EAAAA,EAAmBA,CAC7BjG,SAAU,CAAC,EACXsG,YAAckH,GACZC,EAAI,GAAY,EAAEtI,GAAF,MAAYqI,EAAQlF,EAAMnD,QAAQ,EAAE,GACtDuI,YAAa,GACXD,EAAI,GAAY,EAAEzN,GAAF,MAAYwN,EAAQlF,EAAMtI,QAAQ,CAAE,IACtDsF,cAAe,IAAMmI,EAAI,CAAEtI,SAAUc,EAAAA,EAAmBA,CAAEjG,SAAU,CAAC,CAAE,GACzE,GAGauI,CAHT,CAG0B,IAC5BF,EAAkBC,GAAUA,EAAMhC,WAAW,EAAE,EACjB,IAC9B+B,EAAiB,GAAWC,EAAMhD,aAAa,EAAE,SAsBnCD,IACd,GAAM,CAAE6D,KAAMyE,CAAa,CAAEC,OAAQC,CAAgB,CAAE,CACrDC,CAAAA,EAAAA,EAAAA,EAAAA,CAAMA,CAAmB,WAAY,KAAM,CACzCC,aAAc9H,EAAAA,EAAmBA,GAG/Bd,EAAW6I,CAAAA,EAAAA,EAAAA,OAAAA,CAAOA,CAAC,IACvB,GAA2B/H,CAAvB,CAAuBA,EAAmBA,CAE7C,CAAC0H,EAAc,EAEZrH,EAJgB,CAIFnO,EAAAA,EAAAA,WAAAA,CAAWA,CAC7B,IAKE0V,EAAiB,IACf,IAAMI,EAAmBC,GAAmBjI,EAAAA,EAAmBA,OAE/D,YAAI,OAAOkI,EACFA,EAAUF,GAGZE,CACT,EACF,EACA,CAACN,EAAiB,EAGd,CAAE3E,KAAMkF,CAAqB,CAAER,OAAQS,CAAwB,CAAE,CACrEP,CAAAA,EAAAA,EAAAA,EAAAA,CAAMA,CACJ,IACE3I,EAASmJ,UAAU,CAAG,CAAC,kBAAkB,EAAEnJ,EAASmJ,UAAU,EAAE,CAAG,KACrE,KACA,CACEP,aAAc,IAChB,GAGJ,MAAOC,CAAAA,EAAAA,EAAAA,OAAAA,CAAOA,CACZ,IAAO,WACL7I,cACAmB,EACAtG,SAAUoO,EACVV,YAAaW,EACf,EACA,CAAClJ,EAAUmB,EAAa8H,EAAuBC,EAAyB,CAE5E,sKChGO,IAAMlI,EAA4C,CAAC,CAAEhB,UAAQ,CAAE,GAE9D,WAACpP,EAAAA,EAAIA,CAAAA,CAACxB,UAAU,iCACZ,UAACqC,EAAAA,EAAUA,CAAAA,UACP,UAACC,EAAAA,EAASA,CAAAA,UAAEsO,EAASpF,KAAK,EAAI,oBAElC,UAAC9I,EAAAA,EAAWA,CAAAA,CAAC1C,UAAU,gCACU,UAA5B,OAAO4Q,EAASjQ,OAAO,CACpB,UAAC8I,EAAAA,CAAeA,CAAAA,CAAC9I,QAASiQ,EAASjQ,OAAO,GAE1C,UAACqZ,MAAAA,CAAIha,UAAU,yCAAgC,uFCR7D,MAAa,cAAgB,CAAC,YAAc,EAChD,CAAC,QAAU,EAAE,EAAI,MAAM,CAAI,OAAM,CAAG,MAAM,GAAK,UAAU,EACzD,CAAC,MAAQ,EAAE,EAAG,CAAW,aAAK,SAAU,EACxC,CAAC,MAAQ,EAAE,EAAG,CAAW,aAAK,SAAU,EACzC,oCCJK,MAAS,cAAgB,CAAC,QAAU,EACxC,CAAC,MAAQ,EAAE,EAAG,CAAoD,sDAAK,SAAU,EACjF,CAAC,MAAQ,EAAE,EAAG,CAAa,eAAK,SAAU,EAC3C,2PC0BM,SAAS8Y,EAAoB,OAClCrD,CAAK,UACLC,CAAQ,cACRE,CAAY,WACZ7S,CAAS,MACTsN,CAAI,CACJvN,aAAW,gBACX4Q,CAAc,QACd7Q,CAAM,WACNkW,CAAS,CACgB,EACzB,GAAM,OAAEhG,CAAK,CAAE,CAAGC,CAAAA,EAAAA,EAAAA,CAAAA,CAAQA,GACpB,QAAE3E,CAAM,GAAE4L,CAAC,CAAE,CAAGC,CAAAA,EAAAA,EAAAA,OAAAA,CAAOA,GACvBC,EAAU9K,CAAAA,EAAAA,EAAAA,MAAAA,CAAMA,CAAkB,MAClC+K,EAAW/K,CAAAA,EAAAA,EAAAA,MAAAA,CAAMA,CAAsB,MACvCgL,EAAehL,CAAAA,EAAAA,EAAAA,MAAAA,CAAMA,CAAmB,MACxC,CAACiL,EAAgBC,EAAkB,CAAGpa,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,EAAC,GAC/C,CAACqa,EAAaC,EAAe,CAAGta,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAgB,MACxD,SAAE0S,CAAO,MAAED,CAAI,CAAE7P,UAAW2X,CAAgB,CAAE,CAAGC,CAAAA,EAAAA,EAAAA,UAAAA,CAAUA,GAG3D,CACJ3L,aAAW,CACXwB,gBAAc,eACdE,CAAa,CACbxB,YAAa0L,CAAiB,CAC/B,CAAGhM,CAAAA,EAAAA,EAAAA,CAAAA,CAAoBA,CAAC,CACvBP,SACAQ,SAAU,IACR6G,EAAStF,GACTqK,EAAe,KACjB,EACA3L,CAHwB,OAGf,IACPvI,QAAQJ,KAAK,CAAC,gCAJiE,SAIvBA,GACxD,IAAIO,EAAUuT,EAAE,wCACF,iBAAV9T,GAAqC,uBAAuB,CAAjCA,EAC7BO,EAAUuT,EAAE,4CACH9T,aAAuB,GAChCO,EAAUuT,EAAE,0CACO,WAAW,CAArB9T,EACTO,EAAUuT,EAAE,yCACO,iBAAiB,CAA3B9T,IACTO,EAAUuT,EAAE,+CAEdQ,EAAe/T,GAEfqM,EAAM,CACJvH,MAAOyO,EAAE,SACTvD,YAAahQ,EACbrF,QAAS,aACX,EACF,EACA0N,MAAO,KAELqL,EAASzK,OAAO,EAAEkL,OACpB,CACF,CAF+B,EAKzB,cAAEC,CAAY,CAAEC,cAAeC,CAAqB,CAAE,CAAGC,CAAAA,EAAAA,EAAAA,EAAAA,CAAWA,CAAC,CACzEC,SAAS,EACTC,YAAY,EACZC,SAAU,GACVC,QAAS,KAAK,IACdxT,GADqB,IACb,CACN,UAAW,CAAC,OAAQ,OAAQ,QAAS,OAAQ,QAAQ,CACrD,kBAAmB,CAAC,OAAO,CAC3B,aAAc,CAAC,OAAO,CACtB,WAAY,CAAC,OAAO,CACpB,oEAAqE,CACnE,QACD,CACD,0EACE,CAAC,QAAQ,EAEbyT,YAAa,IAAMf,GAAkB,GACrCgB,YAAa,IAAMhB,EAAkB,IACrCiB,OAAQ,MAAOC,EAAeC,KAa5B,GAZAnB,GAAkB,GAGdmB,EAAcpb,MAAM,CAAG,GAAG,EACtB,CACJkL,MAAO,qBACPkL,YACE,4DACFrV,QAAS,aACX,GAG2B,GAAG,CAA5Boa,EAAcnb,MAAM,CAExB,GAAI,CAEF,IAAMqb,EAAiB,MAAMnX,QAAQoX,GAAG,CACtCH,EAAcva,GAAG,CAAC,MAAO+G,IACvB,IAAM4T,EAAW,IAAIC,SACrBD,EAAS9b,MAAM,CAAC,OAAQkI,GACxB4T,EAAS9b,MAAM,CAAC,SAAU8C,GAE1B,IAAMwC,EAAW,MAAMC,MAAM,oBAAqB,CAChDC,OAAQ,OACRE,KAAMoW,CACR,GAEA,GAAI,CAACxW,EAASW,EAAE,CACd,CADgB,KACV,MAAU,CAAC,uBAAuB,EAAEiC,EAAKnC,IAAI,EAAE,EAGvD,IAAM6O,EAAO,MAAMtP,EAASa,IAAI,GAEhC,MAAO,CACL1F,GAAImU,EAAKnU,EAAE,CACXsF,KAAMmC,EAAKnC,IAAI,CACf7D,KAAMgG,EAAKhG,IAAI,CACfX,KAAM2G,EAAK3G,IAAI,CACfiD,IAAKoQ,EAAKpQ,GAAG,CAEjB,IAGFmP,EAAe,IAAI5Q,KAAgB6Y,EAAe,EAClD5I,EAAM,CACJvH,MAAO,iBACPkL,YAAa,CAAC,sBAAsB,EAAE+E,EAAcnb,MAAM,CAAC,QAAQ,CAAC,EAExE,CAAE,MAAO6F,EAAO,CACdI,QAAQJ,KAAK,CAAC,yBAA0BA,GACxC4M,EAAM,CACJvH,MAAO,gBACPkL,YAAa,4CACbrV,QAAS,aACX,EACF,CACF,CACF,GA4BM0a,EAAmB,MAAOlX,IAC9B,IAAMmD,EAAQnD,EAAEC,MAAM,CAACkD,KAAK,CACvBA,GAA0B,GAAG,CAApBA,EAAM1H,MAAM,GAM1B,MAAM0b,EAAiBzJ,MAAMyC,IAAI,CAAChN,IAG9BqS,EAAa1K,OAAO,EAAE,CACxB0K,EAAa1K,OAAO,CAAC1G,KAAK,CAAG,IAEjC,EAGM+S,EAAmB,MAAOC,IAC9B,GAAI,CAKF,IAAMN,EAAiB,MAAMnX,QAAQoX,GAAG,CACtCK,EAAc/a,GAAG,CAAC,MAAO+G,IACvB,IAAM4T,EAAW,IAAIC,SACrBD,EAAS9b,MAAM,CAAC,OAAQkI,GACxB4T,EAAS9b,MAAM,CAAC,SAAU8C,GAC1B,IAAMwC,EAAW,MAAMC,MAAM,oBAAqB,CAChDC,OAAQ,OACRE,KAAMoW,CACR,GACA,GAAI,CAACxW,EAASW,EAAE,CACd,CADgB,KACV,MAAU,CAAC,uBAAuB,EAAEiC,EAAKnC,IAAI,EAAE,EAEvD,IAAM6O,EAAO,MAAMtP,EAASa,IAAI,GAChC,MAAO,CACL1F,GAAImU,EAAKnU,EAAE,CACXsF,KAAMmC,EAAKnC,IAAI,CACf7D,KAAMgG,EAAKhG,IAAI,CACfX,KAAM2G,EAAK3G,IAAI,CACfiD,IAAKoQ,EAAKpQ,GAAG,CAEjB,IAEFmP,EAAe,IAAI5Q,KAAgB6Y,EAAe,EAClD5I,EAAM,CACJvH,MAAO,iBACPkL,YAAa,CAAC,SAAS,EAAEuF,EAAc3b,MAAM,CAAC,QAAQ,CAAC,EAE3D,CAAE,MAAO6F,EAAO,CACdI,QAAQJ,KAAK,CAAC,yBAA0BA,GACxC4M,EAAM,CAAEvH,MAAO,gBAAiBnK,QAAS,aAAc,EACzD,CACF,EAEM6a,EAAmB,IACvBxI,EAAe5Q,EAAY4J,MAAM,CAAC,GAAUzE,EAAKzH,EAAE,GAAKA,GAC1D,EASA,MACE,UAACM,MAAAA,CACE,GAAGga,GAAc,CAClB9a,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CACX,kCACAuZ,GACE,iJAGJ,WAAC5Q,OAAAA,CACC/H,IAAKwY,EACLxQ,SAAU,IACHqF,EAGHnK,EAAE+E,SAHc,KAGA,GAFhBgM,CAEoB,CAFP/Q,EAIjB,EACA7E,UAAU,wBAHqD,KAGxB,UAGvC,IAHqD,CAGrD,KAACyV,QAAAA,CAAO,GAAGuF,GAAuB,GAClC,UAACvF,QAAAA,CACCxT,KAAK,OACLN,IAAK0Y,EACLra,UAAU,SACV8H,QAAQ,IACRD,OAAO,qCACPiC,SAAUiS,IAIVhD,CAAAA,GAAayB,CAAAA,CAAU,EACvB,WAAC1Z,MAAAA,CAAId,UAAU,wGACZ+Y,GAAa,UAACjY,MAAAA,UAAKiY,IACnByB,GAAe,UAAC1Z,MAAAA,UAAK0Z,OAKzB1X,EAAYxC,MAAM,CAAG,GACpB,UAACQ,MAAAA,CAAId,UAAU,qCACZ8C,EAAY5B,GAAG,CAAC,GACf,WAACJ,MAAAA,CAECd,UAAU,4EAEV,UAACiB,OAAAA,CAAKjB,UAAU,kCAA0BiI,EAAKnC,IAAI,GACnD,UAAC1E,EAAAA,CAAMA,CAAAA,CACLa,KAAK,SACLZ,QAAQ,QACRC,KAAK,OACLtB,UAAU,UACVuB,QAAS,IAAM2a,EAAiBjU,EAAKzH,EAAE,WAEvC,UAACiH,EAAAA,CAACA,CAAAA,CAACzH,UAAU,gBAXViI,EAAKzH,EAAE,KAmBpB,WAACM,MAAAA,CAAId,UAAU,0CAEb,UAACoB,EAAAA,CAAMA,CAAAA,CACLa,KAAK,SACLZ,QAAQ,QACRC,KAAK,OACLqH,SAAU5F,GAAaiM,EACvBhP,UAAU,sCACVuB,QA9IoB,CA8IX4a,IA7IjB9B,EAAa1K,OAAO,EAAEjH,OACxB,EA6IU0T,aAAYnC,EAAE,kCAEd,UAACoC,EAAAA,CAASA,CAAAA,CAACrc,UAAU,cAIvB,UAAC6J,EAAAA,CAAQA,CAAAA,CACPlI,IAAKyY,EACLkC,SAAU,EACVvS,YACEiF,EACIiL,EAAE,mCACFA,EAAE,0BAERhR,MAAOwM,EACP3L,SAAU,IACR4L,EAAS7Q,EAAEC,MAAM,CAACmE,KAAK,CACzB,EACAsT,UA5KY,CA4KDC,GA3KL,UAAV3X,EAAE4X,GAAG,EAAgB,CAAC5X,EAAE6X,QAAQ,EAAE,CACpC7X,EAAE+E,cAAc,GACZ,GAEFuQ,EAAQxK,OAAO,CAFC,CAECgN,gBAGvB,EAqKU3c,UAAU,kFACVmN,KAAM,EACNxE,SAAU5F,GAAaiM,IAGzB,WAAClO,MAAAA,CAAId,UAAU,8DAEZ4a,EACC,UAACxZ,EAAAA,CAAMA,CAAAA,CACLa,KAAK,SACLZ,QAAQ,QACRC,KAAK,OACLqH,SAAU5F,EACV/C,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CACX,wBACAiO,GAAe,8BAEjBzN,QAASyN,EAAc0B,EAAgBF,EACvC4L,aACEpN,EACIiL,EAAE,4BACFA,EAAE,sCAGPjL,EACC,UAAC4N,EAAAA,CAAMA,CAAAA,CAAC5c,UAAU,YAElB,UAAC6c,EAAAA,CAAGA,CAAAA,CAAC7c,UAAU,cAInB,UAACoB,EAAAA,CAAMA,CAAAA,CACLa,KAAK,SACLZ,QAAQ,QACRC,KAAK,OACLqH,QAAQ,IACR6C,MAAOyO,EAAE,yCAET,UAAC2C,EAAAA,CAAMA,CAAAA,CAAC5c,UAAU,uCAKrB+C,EACC,UAAC3B,EAAAA,CAAMA,CAAAA,CACLa,KAAK,SACLZ,QAAQ,QACRC,KAAK,OACLC,QAAS8O,EACT+L,aAAYnC,EAAE,4BAEd,UAAC6C,EAAAA,CAAUA,CAAAA,CAAC9c,UAAU,cAGxB,UAACoB,EAAAA,CAAMA,CAAAA,CACLa,KAAK,SACLZ,QAAQ,QACRC,KAAK,OACLqH,SACE,CAAE8M,EAAM7O,IAAI,IAA6B,IAAvB9D,EAAYxC,MAAM,EAAW0O,EAEjDoN,aAAYnC,EAAE,4BAEd,UAAC8C,EAAAA,CAAaA,CAAAA,CAAC/c,UAAU,wBAQzC,qFCraM,MAAa,cAAgB,CAAC,YAAc,EAChD,CAAC,MAAQ,EAAE,EAAG,CAAY,cAAK,SAAU,EACzC,CACE,OACA,CACE,CAAG,6JACH,GAAK,QACP,EACF,CACD,mICJM,SAAS2Y,EAAmB,UAC/B7Y,CAAQ,WACRiD,GAAY,CAAK,CACjB/C,WAAS,CACTiU,qBAAoB,CAAK,QACzBpR,CAAM,CACgB,EACtB,IAAMma,EAAiB3N,CAAAA,EAAAA,EAAAA,MAAAA,CAAMA,CAAiB,MAuB9C,MACI,WAACvO,MAAAA,CACGd,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CACT,0CACAkT,EAAoB,0BAA4B,GAChDjU,aAGiB,IAApBF,EAASQ,MAAM,CACZ,WAACQ,MAAAA,CAAId,UAAU,mFACX,UAACuC,KAAAA,CAAGvC,UAAU,iCAAwB,uBACtC,UAACyC,IAAAA,CAAEzC,UAAU,yCAAgC,2DAKjDF,EAASoB,GAAG,CAAC,CAACwF,EAASvF,IACnB,UAACL,MAAAA,CAA8Bd,UAAU,2BACrC,UAACid,EAAAA,CAAcA,CAAAA,CACXvW,QAASA,EACTwW,cAAe/b,IAAUrB,EAASQ,MAAM,CAAG,EAC3CuC,OAAQA,KAJN6D,EAAQlG,EAAE,EAAIW,IAU/B4B,GAAa,UAACyO,EAAAA,CAAsBA,CAAAA,CAAAA,GAGrC,UAAC1Q,MAAAA,CAAIa,IAAKqb,MAGtB,wNClEO,IAAMvT,EAAkB0T,CAAAA,EAAAA,EAAAA,IAAAA,CAAIA,CAAC,SAAS1T,SAC3C9I,CAAO,WACPX,CAAS,CACY,SAMhBW,EAMH,EANE,CAMF,IANY,CAMZ,EAACyc,EAAAA,EAAaA,CAAAA,CACZpd,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CAAC,0BAA2Bf,GACzCqd,cAAe,CAACC,EAAAA,CAASA,CAAC,CAC1BC,WAAY,KACVvD,CAAI,UAAEwD,CAAQ,CAAE,GACP,+BAAGA,IAEZC,KAAK,MAAEC,CAAI,WAAE1d,CAAS,UAAEwd,CAAQ,CAAE,GAAG9b,EAAO,EAC1C,IAAMic,EAAQ,iBAAiBC,IAAI,CAAC5d,GAAa,IAC3Cyd,EAAOI,OAAOL,GAAUM,OAAO,CAAC,MAAO,WAE7C,EAeE,EAfE,CAeF,EAfU,GAeV,EAACC,EAAAA,CAAgBA,CAAAA,CACfC,SAAUL,CAAK,CAAC,EAAE,CAClBF,KAAMA,EACNzd,UAAWA,EACV,GAAG0B,CAAK,GAjBT,UAAC+b,OAAAA,CACCzd,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CACX,oDACAf,GAED,GAAG0B,CAAK,UAER+b,GAaT,CACF,WAEC9c,KAzCH4F,QAAQgK,IAAI,CAAC,oCACN,KA2CX,GAAG,+MCjEH,IAAM4B,EAAQ1Q,EAAAA,UAAgB,CAG5B,CAAC,WAAEzB,CAAS,CAAE,GAAG0B,EAAO,CAAEC,IACxB,UAACb,MAAAA,CAAId,UAAU,yCACX,UAACie,QAAAA,CACGtc,IAAKA,EACL3B,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CAAC,gCAAiCf,GAC9C,GAAG0B,CAAK,MAIrByQ,EAAM/P,WAAW,CAAG,QAEpB,IAAM8b,EAAczc,EAAAA,UAAgB,CAGlC,CAAC,WAAEzB,CAAS,CAAE,GAAG0B,EAAO,CAAEC,IACxB,UAACwc,QAAAA,CAAMxc,IAAKA,EAAK3B,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CAAC,kBAAmBf,GAAa,GAAG0B,CAAK,IAE3Ewc,EAAY9b,WAAW,CAAG,cAE1B,IAAMgc,EAAY3c,EAAAA,UAAgB,CAGhC,CAAC,CAAEzB,WAAS,CAAE,GAAG0B,EAAO,CAAEC,IACxB,UAAC0c,QAAAA,CACG1c,IAAKA,EACL3B,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CAAC,6BAA8Bf,GAC3C,GAAG0B,CAAK,IAGjB0c,EAAUhc,WAAW,CAAG,YAEJX,EAAAA,UAAgB,CAGlC,CAAC,WAAEzB,CAAS,CAAE,GAAG0B,EAAO,CAAEC,IACxB,UAAC2c,QAAAA,CACG3c,IAAKA,EACL3B,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CACT,0DACAf,GAEH,GAAG0B,CAAK,IAGLU,WAAW,CAAG,cAE1B,IAAMmc,EAAW9c,EAAAA,UAAgB,CAG/B,CAAC,WAAEzB,CAAS,CAAE,GAAG0B,EAAO,CAAEC,IACxB,UAAC6c,KAAAA,CACG7c,IAAKA,EACL3B,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CACT,8EACAf,GAEH,GAAG0B,CAAK,IAGjB6c,EAASnc,WAAW,CAAG,WAEvB,IAAMqc,EAAYhd,EAAAA,UAAgB,CAGhC,CAAC,WAAEzB,CAAS,CAAE,GAAG0B,EAAO,CAAEC,IACxB,UAAC+c,KAAAA,CACG/c,IAAKA,EACL3B,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CACT,mGACAf,GAEH,GAAG0B,CAAK,IAGjB+c,EAAUrc,WAAW,CAAG,YAExB,IAAMuc,EAAYld,EAAAA,UAAgB,CAGhC,CAAC,WAAEzB,CAAS,CAAE,GAAG0B,EAAO,CAAEC,IACxB,UAACid,KAAAA,CACGjd,IAAKA,EACL3B,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CAAC,iDAAkDf,GAC/D,GAAG0B,CAAK,IAGjBid,EAAUvc,WAAW,CAAG,YAExB,IAAMyc,EAAepd,EAAAA,UAAgB,CAGnC,CAAC,WAAEzB,CAAS,CAAE,GAAG0B,EAAO,CAAEC,IACxB,UAACmd,UAAAA,CACGnd,IAAKA,EACL3B,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CAAC,qCAAsCf,GACnD,GAAG0B,CAAK,IAGjBmd,EAAazc,WAAW,CAAG,sEC5FrB,MAAa,cAAgB,CAAC,YAAc,EAChD,CAAC,QAAU,EAAE,EAAI,MAAM,CAAI,OAAM,CAAG,MAAM,GAAK,UAAU,EACzD,CAAC,OAAQ,CAAE,MAAO,CAAK,UAAQ,CAAK,KAAG,GAAK,GAAG,GAAK,KAAK,SAAU,EACpE,oCCHK,MAAY,cAAgB,CAAC,WAAa,EAC9C,CAAC,MAAQ,EAAE,EAAG,CAAY,cAAK,SAAU,EACzC,CAAC,MAAQ,EAAE,EAAG,CAAY,cAAK,SAAU,EACzC,CAAC,QAAU,EAAE,EAAI,MAAM,CAAI,OAAM,CAAG,KAAK,GAAK,UAAU,EACxD,CAAC,QAAU,EAAE,EAAI,KAAK,CAAI,MAAK,CAAG,KAAK,GAAK,UAAU,EACvD,kJCMM,IAAMgQ,EAA8C,CAAC,UAAExB,CAAQ,CAAE,IAEpE,IAAMjQ,EAAWiQ,EAASjQ,OAAO,EAAI,CAAE2R,QAAS,EAAE,CAAEnF,KAAM,EAAE,EACtDmF,EAAU3R,EAAQ2R,OAAO,EAAI,EAAE,CAC/BnF,EAAOxM,EAAQwM,IAAI,EAAI,EAAE,CAE/B,MACI,WAAC3L,EAAAA,EAAIA,CAAAA,CAACxB,UAAU,iCACZ,UAACqC,EAAAA,EAAUA,CAAAA,UACP,UAACC,EAAAA,EAASA,CAAAA,UAAEsO,EAASpF,KAAK,EAAI,iBAElC,UAAC9I,EAAAA,EAAWA,CAAAA,CAAC1C,UAAU,gCAClBsS,EAAQhS,MAAM,CAAG,EACd,WAAC6R,EAAAA,EAAKA,CAAAA,WACF,UAAC+L,EAAAA,EAAWA,CAAAA,UACR,UAACK,EAAAA,EAAQA,CAAAA,UACJjM,EAAQpR,GAAG,CAAC,CAAC6d,EAAK5d,IACf,UAACsd,EAAAA,EAASA,CAAAA,UAA0BM,GAApB,CAAC,OAAO,EAAE5d,EAAAA,CAAO,OAI7C,UAACid,EAAAA,EAASA,CAAAA,UACLjR,EAAKjM,GAAG,CAAC,CAAC8d,EAAKC,IACZ,UAACV,EAAAA,EAAQA,CAAAA,UACJjM,EAAQpR,GAAG,CAAC,CAAC6d,EAAKG,IACf,UAACP,EAAAA,EAASA,CAAAA,UAELd,OAAOmB,CAAG,CAACD,EAAI,EAAI,KAFR,CAAC,KAAK,EAAEE,EAAS,CAAC,EAAEC,EAAAA,CAAU,IAFvC,CAAC,IAAI,EAAED,EAAAA,CAAU,KAUvB,IAAhB9R,EAAK7M,MAAM,EAA8B,cAApBsQ,EAASlF,MAAM,EACjC,UAACmT,EAAAA,EAAYA,CAAAA,UAAC,4BAEG,cAApBjO,EAASlF,MAAM,EACZ,UAACmT,EAAAA,EAAYA,CAAAA,UAAC,yBAItB,UAACpc,IAAAA,CAAEzC,UAAU,6CACY,cAApB4Q,EAASlF,MAAM,CAAmB,4BAA8B,iCAMzF,EAAE,uDC3DI,MAAW,cAAgB,CAAC,UAAY,EAC5C,CAAC,MAAQ,EAAE,EAAG,CAAY,cAAK,SAAU,EACzC,CACE,OACA,CACE,CAAG,8JACH,GAAK,SACP,EACF,CACD,qJCNM,SAASqS,EAAiB,UAC/BC,CAAQ,MACRP,CAAI,CACJzd,WAAS,CACa,EACtB,GAAM,CAACmf,EAAUC,EAAY,CAAGjf,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,EAAC,GAEnCkf,EAAkB,UACtB,MAAMC,UAAUC,SAAS,CAACC,SAAS,CAAC/B,GACpC2B,GAAY,GACZ7W,WAAW,IAAM6W,GAAY,GAAQ,IACvC,EAEA,MACE,WAACte,MAAAA,CAAId,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CAAC,oCAAqCf,aACtD,WAACc,MAAAA,CAAId,UAAU,gGACb,UAACc,MAAAA,CAAId,UAAU,iCAAyBge,IACxC,WAAC5c,EAAAA,CAAMA,CAAAA,CACLC,QAAQ,QACRC,KAAK,OACLtB,UAAU,UACVuB,QAAS8d,YAERF,EACC,UAACM,EAAAA,CAASA,CAAAA,CAACzf,UAAU,6BAErB,UAAC0f,EAAAA,CAAQA,CAAAA,CAAC1f,UAAU,gBAEtB,UAACiB,OAAAA,CAAKjB,UAAU,mBAAU,oBAG9B,UAAC2f,EAAAA,KAAiBA,CAAAA,CAChB3B,SAAUA,EACV4B,YAAa,CAAEC,OAAQ,EAAGC,aAAc,uBAAwB,WAE/DrC,MAIT,mFC1CM,MAAS,cAAgB,CAAC,QAAU,EACxC,CAAC,OAAQ,CAAE,GAAI,CAAK,MAAI,CAAM,OAAI,GAAK,IAAI,IAAM,KAAK,SAAU,EAChE,CAAC,MAAQ,EAAE,EAAG,CAAyC,2CAAK,SAAU,EACtE,CAAC,MAAQ,EAAE,EAAG,CAA0B,4BAAK,SAAU,EACvD,CAAC,MAAQ,EAAE,EAAG,CAAkC,oCAAK,SAAU,EAC/D,CAAC,MAAQ,EAAE,EAAG,CAA8B,gCAAK,SAAU,EAC3D,CAAC,OAAQ,CAAE,GAAI,CAAM,OAAI,CAAM,OAAI,IAAM,IAAI,IAAM,KAAK,SAAU,EACnE,oCCPK,MAAiB,cAAgB,CAAC,gBAAkB,EACxD,CAAC,MAAQ,EAAE,EAAG,CAAsB,wBAAK,SAAU,EACnD,CAAC,MAAQ,EAAE,EAAG,CAAY,cAAK,SAAU,EAC1C,4KCTD,SAAS5U,EAAK,WACZ7I,CAAS,CACT,GAAG0B,EAC6C,EAChD,MACE,UAACqe,EAAAA,EAAkB,EACjB5R,YAAU,OACVnO,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CAAC,sBAAuBf,GACpC,GAAG0B,CAAK,EAGf,CAEA,SAASqH,EAAS,WAChB/I,CAAS,CACT,GAAG0B,EAC6C,EAChD,MACE,UAACqe,EAAAA,EAAkB,EACjB5R,YAAU,YACVnO,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CACX,sGACAf,GAED,GAAG0B,CAAK,EAGf,CAEA,SAASsH,EAAY,WACnBhJ,CAAS,CACT,GAAG0B,EACgD,EACnD,MACE,UAACqe,EAAAA,EAAqB,EACpB5R,YAAU,eACVnO,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CACX,kqBACAf,GAED,GAAG0B,CAAK,EAGf,CAEA,SAASwH,EAAY,WACnBlJ,CAAS,CACT,GAAG0B,EACgD,EACnD,MACE,UAACqe,EAAAA,EAAqB,EACpB5R,YAAU,eACVnO,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CAAC,sBAAuBf,GACpC,GAAG0B,CAAK,EAGf,oPCzCO,SAASmX,EAAc,QAAEhW,CAAM,WAAE7C,CAAS,CAAsB,EACrE,GAAM,CAACggB,EAAWC,EAAa,CAAGxe,EAAAA,QAAc,CAAiB,CAC/D,CACEye,MAAO,iBACPjX,MAAO,EACP0I,KAAM,UAACwO,EAAAA,CAAaA,CAAAA,CAACngB,UAAU,YAC/B0W,YAAa,0BACf,EACA,CACEwJ,MAAO,eACPjX,MAAO,EACP0I,KAAM,UAACyO,EAAAA,CAAKA,CAAAA,CAACpgB,UAAU,YACvB0W,YAAa,wBACf,EACA,CACEwJ,MAAO,mBACPjX,MAAO,KACP0I,KAAM,UAAC0O,EAAAA,CAAKA,CAAAA,CAACrgB,UAAU,YACvB0W,YAAa,0BACf,EACA,CACEwJ,MAAO,gBACPjX,MAAO,KACP0I,KAAM,UAAC2O,EAAAA,CAAQA,CAAAA,CAACtgB,UAAU,YAC1B0W,YAAa,uBACf,EACD,EAqBD,OAlBAjV,EAAAA,SAAe,CAAC,KACd,GAAI,CAACoB,EAAQ,OAEb,IAAM0d,EAAiB,UAOvB,EAEAA,IACA,IAAMC,EAAWpV,YAAYmV,EAAgB,KAE7C,GAFqD,GAE9C,IAAMjV,YAF2D,EAE7CkV,EAC7B,EAAG,CAAC3d,EAAO,EAGT,WAAC/B,MAAAA,CACCd,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CAAC,8CAA+Cf,aAE7D,WAACc,MAAAA,CAAId,UAAU,2DACb,WAACc,MAAAA,CAAId,UAAU,8BACb,UAACsgB,EAAAA,CAAQA,CAAAA,CAACtgB,UAAU,iBACpB,UAACuC,KAAAA,CAAGvC,UAAU,yBAAgB,iBAEhC,WAACoB,EAAAA,CAAMA,CAAAA,CACLE,KAAK,KACLD,QAAQ,QACRrB,UAAU,cACVuB,QAAS,IACP+F,SAASC,aAAa,CAAC,IAAIC,YAAY,+BAGzC,UAACC,EAAAA,CAACA,CAAAA,CAACzH,UAAU,YACb,UAACiB,OAAAA,CAAKjB,UAAU,mBAAU,gBAI9B,UAACc,MAAAA,CAAId,UAAU,eACb,UAACmJ,EAAAA,CAAUA,CAAAA,CAACnJ,UAAU,iCACpB,UAACc,MAAAA,CAAId,UAAU,sBACZggB,EAAU9e,GAAG,CAAC,CAACuf,EAAMtf,IACpB,UAACK,EAAAA,EAAIA,CAAAA,CAAaxB,UAAU,eAC1B,WAACc,MAAAA,CAAId,UAAU,oCACb,UAACc,MAAAA,CAAId,UAAU,mCAA2BygB,EAAK9O,IAAI,GACnD,WAAC7Q,MAAAA,CAAId,UAAU,6BACb,UAACyC,IAAAA,CAAEzC,UAAU,4CACVygB,EAAKP,KAAK,GAEb,UAACzd,IAAAA,CAAEzC,UAAU,8BAAsBygB,EAAKxX,KAAK,GAC5CwX,EAAK/J,WAAW,EACf,UAACjU,IAAAA,CAAEzC,UAAU,yCACVygB,EAAK/J,WAAW,UAVhBvV,YAsBzB,qFCxGM,MAAe,cAAgB,CAAC,cAAgB,EACpD,CAAC,MAAQ,EAAE,EAAG,CAAa,eAAK,SAAU,EAC1C,CAAC,MAAQ,EAAE,EAAG,CAAe,iBAAK,SAAU,EAC5C,CAAC,MAAQ,EAAE,EAAG,CAA4D,8DAAK,SAAU,EAC1F,6NCYM,SAAS8b,EAAe,CAAEvW,SAAO,eAAEwW,CAAa,QAAEra,CAAM,CAAuB,EAClF,GAAM,OAAEkQ,CAAK,CAAE,CAAGC,CAAAA,EAAAA,EAAAA,CAAAA,CAAQA,GACpB,CAAC0N,EAAUC,EAAY,CAAGxgB,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAA8B,MAChE,CAACgf,EAAUC,EAAY,CAAGjf,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,EAAC,GACnCygB,EAA0B,SAAjBla,EAAQ7F,IAAI,CAOrBwe,EAAkB,UACpB,GAAI,CACA,MAAMC,UAAUC,SAAS,CAACC,SAAS,CAAC9Y,EAAQ/F,OAAO,EACnDye,GAAY,GACZ7W,WAAW,IAAM6W,GAAY,GAAQ,KACrCrM,EAAM,CACFvH,MAAO,sBACPkL,YAAa,qCACjB,EACJ,CAAE,MAAOvQ,EAAO,CACZ4M,EAAM,CACFvH,MAAO,iBACPkL,YAAa,sCACbrV,QAAS,aACb,EACJ,CACJ,EAEMwf,EAAiB,MAAO5e,IAC1B,GAAI,CAEA,GAAqB,cAAjByE,EAAQ7F,IAAI,CAAkB,OAElC,IAAMigB,EAAuB,SAAT7e,EAAkB,QAAU,WAqBhD,GAlBIye,IAAaI,EACbH,EAAY,MAEZA,EAAYG,CAHc,EAkB1B,CAACzb,CAZY,MAAMC,MAAM,qBAAsB,CAC/CC,OAAQ,OACRC,QAAS,CACL,eAAgB,kBACpB,EACAC,KAAMC,KAAKC,SAAS,CAAC,CACjBob,UAAWra,EAAQlG,EAAE,QACrBqC,OACAZ,CACJ,EACJ,IAEc+D,EAAE,CACZ,CADc,KACJS,MAAM,4BAExB,CAAE,MAAON,EAAO,CACZ4M,EAAM,CACFvH,MAAO,QACPkL,YAAa,4BACbrV,QAAS,aACb,EACJ,CACJ,EAEA,MACI,WAACP,MAAAA,CACGd,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CACT,mCACA6f,EAAS,mBAAqB,YAElCpgB,GAAIkG,EAAQlG,EAAE,WAGd,UAACM,MAAAA,CAAId,UAAU,gHACV4gB,EACG,UAACI,EAAAA,EAAMA,CAAAA,UACH,UAACC,EAAAA,EAAcA,CAAAA,UAAC,QAGpB,WAACD,EAAAA,EAAMA,CAAAA,WACH,UAACE,EAAAA,EAAWA,CAAAA,CAACC,IAAI,kBAAkBC,IAAI,OACvC,UAACH,EAAAA,EAAcA,CAAAA,UAAC,YAM5B,WAACngB,MAAAA,CAAId,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CACd,sDACA6f,EAAS,YAAc,yBAEvB,UAAC9f,MAAAA,CAAId,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CACd,qDACA6f,EAAS,qCAAuC,qBAEhD,UAACnX,EAAAA,CAAeA,CAAAA,CACZ9I,QAAS+F,EAAQ/F,OAAO,CACxBX,UAAW4gB,EAAS,eAAiB,OAK5C,CAACA,GACE,WAAC9f,MAAAA,CAAId,UAAU,yFACX,UAACoB,EAAAA,CAAMA,CAAAA,CACHC,QAAQ,QACRC,KAAK,OACLtB,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CACT,UACa,UAAb2f,EAAuB,iBAAmB,yBAE9Cnf,QAAS,IAAMsf,EAAe,iBAE9B,UAACQ,EAAAA,CAAQA,CAAAA,CAACrhB,UAAU,cAExB,UAACoB,EAAAA,CAAMA,CAAAA,CACHC,QAAQ,QACRC,KAAK,OACLtB,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CACT,UACA2f,eAA0B,eAAiB,yBAE/Cnf,QAAS,IAAMsf,EAAe,oBAE9B,UAACS,EAAAA,CAAUA,CAAAA,CAACthB,UAAU,cAE1B,WAACuhB,EAAAA,EAAYA,CAAAA,WACT,UAACC,EAAAA,EAAmBA,CAAAA,CAACC,OAAO,aACxB,UAACrgB,EAAAA,CAAMA,CAAAA,CAACC,QAAQ,QAAQC,KAAK,OAAOtB,UAAU,yCAC1C,UAAC0hB,EAAAA,CAAYA,CAAAA,CAAC1hB,UAAU,gBAGhC,UAAC2hB,EAAAA,EAAmBA,CAAAA,CAACC,MAAM,eACvB,WAACC,EAAAA,EAAgBA,CAAAA,CAACtgB,QAAS8d,YACtBF,EACG,UAAC2C,EAAAA,CAAKA,CAAAA,CAAC9hB,UAAU,gCAEjB,UAAC+hB,EAAAA,CAAIA,CAAAA,CAAC/hB,UAAU,iBAClB,+BAUtC,yFCvKM,MAAM,cAAgB,CAAC,KAAO,EAClC,CAAC,MAAQ,EAAE,EAAG,CAAwD,0DAAK,SAAU,EACrF,CAAC,MAAQ,EAAE,EAAG,CAA8B,gCAAK,SAAU,EAC3D,CAAC,OAAQ,CAAE,GAAI,CAAM,OAAI,CAAM,OAAI,IAAM,IAAI,IAAM,KAAK,SAAU,EACnE,oCCJK,MAAQ,cAAgB,CAAC,OAAS,EACtC,CAAC,MAAQ,EAAE,EAAG,CAAW,aAAK,SAAU,EACxC,CAAC,MAAQ,EAAE,EAAG,CAAyC,2CAAK,SAAU,EACtE,CAAC,MAAQ,EAAE,EAAG,CAAsC,wCAAK,SAAU,EACpE,sPC6DM,SAAS4Y,EAAyB,QACvC/V,CAAM,CACN/C,UAAQ,QACRC,CAAM,WACNgD,CAAS,WACT3C,CAAS,WACTJ,CAAS,CACqB,EAC9B,GAAM,CAACgiB,EAASC,EAAW,CAAG9hB,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAe,EAAE,EACjD,CAAC+hB,EAAYC,EAAc,CAAGhiB,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAiB,EAAE,EACzD,CAACiiB,EAAUC,EAAY,CAAGliB,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAgB,EAAE,EACpD,CAACmiB,EAAOC,EAAS,CAAGpiB,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAgB,CAAEwP,QAAS,EAAG6S,IAAK,CAAE,GACjE,CAACve,EAAU8G,EAAY,CAAG5K,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAmB,CACzDsiB,eAAgB,EAChBC,WAAY,CACd,GACM,CAACtf,EAAWC,EAAa,CAAGlD,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAC,WACrC,CAACwiB,EAAeC,EAAiB,CAAGziB,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,EAAC,GA+B7C0iB,EACJ5e,EAASye,UAAU,CAAG,EAClBxa,KAAKoF,KAAK,CAAC,EAAUmV,cAAc,CAAGxe,EAASye,UAAU,CAAI,KAC7D,EAGAI,EAAgB,UACpB,GAAIH,GAAiB5f,EAAW,OAEhC6f,GAAiB,GAGjB,IAAMG,EAAgC,CACpC,CACE9gB,KAAM,SACNyE,QAAS,+CACTgF,OAAQ,UACR4W,MAAO,EACPvb,UAAWC,KAAKC,GAAG,EACrB,EACD,CAEDkb,EAAcY,GACdhY,EAAY,CAAE0X,eAAgB,EAAGC,WAAY,CAAE,GAC/CH,EAAS,CAAE5S,QAAS,EAAG6S,IAAK,CAAE,GAG9B,IAAMQ,EAAkB,IAAIljB,EAAS,CAClCkK,OAAO,GACP7F,IAAI,CAAC,GAAO8e,WAAEpiB,IAAI,EACfqiB,EAAgBF,GAAiBriB,SAAW,sBAG5CyG,EAAgB,CACpB5G,GAAIwG,KAAKC,GAAG,GAAGjC,QAAQ,GACvBnE,KAAM,SACNF,QAAS,CAAC,0BAA0B,EAAEuiB,EAAc;;;;yEAIe,CAAC,CAItE,OAAMnjB,EAAOqH,GAKb+b,GACF,EAGMA,EAA2B,KAE/B5a,WAAW,KACT4Z,EAAc,GAAU,CACtB,CAAE,GAAGre,CAAI,CAAC,EAAE,CAAE4H,OAAQ,UAAW,EACjC,CACEzJ,KAAM,SACNyE,QAAS,+CACTgF,OAAQ,UACR4W,MAAO,EACPvb,UAAWC,KAAKC,GAAG,EACrB,EACD,EACD8D,EAAY,GAAW,EAAE,EAAF,CAAKjH,CAAI,CAAE2e,eAAgB,EAAE,GAGpDR,EAAW,CACT,CACE1d,IAAK,2DACLiH,MAAO,iDACPkL,YACE,8DACFzU,KAAM,MACNmhB,UAAW,GACb,EACD,CACH,EAAG,KAGH7a,WAAW,KACT4Z,EAAc,GAAU,IACnBre,EAAKuf,KAAK,CAAC,EAAG,GACjB,CAAE,GAAGvf,CAAI,CAAC,EAAE,CAAE4H,OAAQ,UAAW,EACjC,CACEzJ,KAAM,UACNyE,QAAS,iDACTgF,OAAQ,UACR4W,MAAO,EACPvb,UAAWC,KAAKC,GAAG,EACrB,EACD,EACD8D,EAAY,GAAW,EAAE,EAAF,CAAKjH,CAAI,CAAE2e,eAAgB,CAAE,IAGpDR,EAAW,GAAU,IAChBne,EACH,CACES,IAAK,mCACLiH,MAAO,oCACPkL,YAAa,oDACbzU,KAAM,MACNmhB,UAAW,EACb,EACD,CACH,EAAG,KAGH7a,WAAW,KACT4Z,EAAere,GAAS,IACnBA,EAAKuf,KAAK,CAAC,EAAG,GACjB,CAAE,GAAGvf,CAAI,CAAC,EAAE,CAAE4H,OAAQ,UAAW,EACjC,CACEzJ,KAAM,YACNyE,QAAS,+CACTgF,OAAQ,UACR4W,MAAO,EACPvb,UAAWC,KAAKC,GAAG,EACrB,EACD,EACD8D,EAAY,GAAW,EAAE,EAAF,CAAKjH,CAAI,CAAE2e,eAAgB,CAAE,IACpDF,EAAS,GAAW,EAAE,EAAF,CAAKze,CAAI,CAAE6L,QAAS,EAAE,GAG1C0S,EAAY,CACV,CACE1hB,QACE,0IACF2iB,WAAY,GACZtB,QAAS,CAAC,iDAAiD,CAC3Djb,UAAWC,KAAKC,GAAG,EACrB,EACD,CACH,EAAG,KAGHsB,WAAW,KACT4Z,EAAc,GAAU,IACnBre,EAAKuf,KAAK,CAAC,EAAG,GACjB,CAAE,GAAGvf,CAAI,CAAC,EAAE,CAAE4H,OAAQ,UAAW,EAClC,EACDX,EAAY,GAAW,EAAE,EAAF,CAAKjH,CAAI,CAAE2e,eAAgB,EAAE,GAGpDJ,EAAY,GAAU,IACjBve,EACH,CACEnD,QACE,4GACF2iB,WAAY,IACZtB,QAAS,CAAC,oCAAoC,CAC9Cjb,UAAWC,KAAKC,GAAG,EACrB,EACD,EAED2b,GAAiB,EACnB,EAAG,IACL,SAEA,EAGuB,EAHnB,EAGAZ,EAAQ1hB,GAHI,GAGE,EAAgC,GAAG,CAAzB4hB,EAAW5hB,MAAM,CAEzC,WAACQ,MAAAA,CACCd,UAAW,CAAC,4CAA4C,EAAEA,EAAAA,CAAW,WAErE,WAACc,MAAAA,CAAId,UAAU,2DACb,WAACc,MAAAA,CAAId,UAAU,8BACb,UAACujB,EAAAA,CAAQA,CAAAA,CAACvjB,UAAU,iBACpB,UAACuC,KAAAA,CAAGvC,UAAU,yBAAgB,0BAEhC,WAACoB,EAAAA,CAAMA,CAAAA,CACLE,KAAK,KACLD,QAAQ,QACRrB,UAAU,cACVuB,QAAS,IACP+F,SAASC,aAAa,CAAC,IAAIC,YAAY,8BAGzC,UAACC,EAAAA,CAACA,CAAAA,CAACzH,UAAU,YACb,UAACiB,OAAAA,CAAKjB,UAAU,mBAAU,gBAG9B,WAACc,MAAAA,CAAId,UAAU,gBACb,WAACuN,EAAAA,EAAKA,CAAAA,WACJ,UAACiW,EAAAA,CAAQA,CAAAA,CAACxjB,UAAU,YACpB,UAACwN,EAAAA,EAAUA,CAAAA,UAAC,uBACZ,UAACC,EAAAA,EAAgBA,CAAAA,UAAC,sEAKpB,UAACrM,EAAAA,CAAMA,CAAAA,CACLG,QAASuhB,EACTna,SAAUga,GAAiB5f,EAC3B/C,UAAU,uBAET2iB,EAAgB,iBAAmB,yBAQ5C,WAAC7hB,MAAAA,CAAId,UAAW,CAAC,4CAA4C,EAAEA,EAAAA,CAAW,WACxE,WAACc,MAAAA,CAAId,UAAU,2DACb,WAACc,MAAAA,CAAId,UAAU,8BACb,UAACujB,EAAAA,CAAQA,CAAAA,CAACvjB,UAAU,iBACpB,UAACuC,KAAAA,CAAGvC,UAAU,yBAAgB,0BAEhC,WAACoB,EAAAA,CAAMA,CAAAA,CACLE,KAAK,KACLD,QAAQ,QACRrB,UAAU,cACVuB,QAAS,IACP+F,SAASC,aAAa,CAAC,IAAIC,YAAY,8BAGzC,UAACC,EAAAA,CAACA,CAAAA,CAACzH,UAAU,YACb,UAACiB,OAAAA,CAAKjB,UAAU,mBAAU,gBAG9B,WAACc,MAAAA,CAAId,UAAU,0BACb,WAACc,MAAAA,CAAId,UAAU,oCACb,UAACc,MAAAA,CAAId,UAAU,kBACb,UAACuJ,EAAAA,CAAQA,CAAAA,CAACN,MAAO4Z,EAAoB7iB,UAAU,UAEjD,WAACc,MAAAA,CAAId,UAAU,4DACZiE,EAASwe,cAAc,CAAC,MAAIxe,EAASye,UAAU,CAAC,eAIpDJ,EAAME,GAAG,CAAG,GACX,WAAC1hB,MAAAA,CAAId,UAAU,kEACb,UAACiB,OAAAA,UAAK,oBACN,UAACH,MAAAA,CAAId,UAAU,kBACb,UAACuJ,EAAAA,CAAQA,CAAAA,CACPN,MAAO,EAAO0G,OAAO,CAAG2S,EAAME,GAAG,CAAI,IACrCxiB,UAAU,UAGd,WAACiB,OAAAA,WACEqhB,EAAM3S,OAAO,CAAC,MAAI2S,EAAME,GAAG,OAKlC,WAAC3Z,EAAAA,IAAIA,CAAAA,CAACC,aAAa,UAAU9I,UAAU,mBACrC,WAAC+I,EAAAA,QAAQA,CAAAA,CAAC/I,UAAU,oCAClB,WAACgJ,EAAAA,WAAWA,CAAAA,CAACC,MAAM,oBAAU,YACjB+Y,EAAQ1hB,MAAM,CAAC,OAE3B,WAAC0I,EAAAA,WAAWA,CAAAA,CAACC,MAAM,uBAAa,eACjBiZ,EAAW5hB,MAAM,CAAC,OAEjC,WAAC0I,EAAAA,WAAWA,CAAAA,CAACC,MAAM,qBAAW,aACjBmZ,EAAS9hB,MAAM,CAAC,UAI/B,UAAC4I,EAAAA,WAAWA,CAAAA,CAACD,MAAM,UAAUjJ,UAAU,gBACrC,WAACwB,EAAAA,EAAIA,CAAAA,WACH,WAACa,EAAAA,EAAUA,CAAAA,CAACrC,UAAU,iBACpB,UAACsC,EAAAA,EAASA,CAAAA,CAACtC,UAAU,qBAAY,qBACjC,UAACwC,EAAAA,EAAeA,CAAAA,UAAC,qDAInB,UAACE,EAAAA,EAAWA,CAAAA,UACV,UAACyG,EAAAA,CAAUA,CAAAA,CAACnJ,UAAU,0BACpB,UAACc,MAAAA,CAAId,UAAU,qBACZgiB,EAAQ9gB,GAAG,CAAC,CAACuiB,EAAQtiB,IACpB,UAACL,MAAAA,CAAgBd,UAAU,mCACzB,WAACc,MAAAA,CAAId,UAAU,6BACb,UAACc,MAAAA,CAAId,UAAU,uBACb,UAACqH,EAAAA,CAAQA,CAAAA,CAACrH,UAAU,oCAEtB,WAACc,MAAAA,CAAId,UAAU,mBACb,WAACc,MAAAA,CAAId,UAAU,2FACZyjB,EAAOjY,KAAK,CACb,UAACkY,EAAAA,CAAYA,CAAAA,CAAC1jB,UAAU,oBAE1B,UAACyC,IAAAA,CAAEzC,UAAU,yCACVyjB,EAAO/M,WAAW,UAXjBvV,eAuBtB,UAAC+H,EAAAA,WAAWA,CAAAA,CAACD,MAAM,aAAajJ,UAAU,gBACxC,WAACwB,EAAAA,EAAIA,CAAAA,WACH,WAACa,EAAAA,EAAUA,CAAAA,CAACrC,UAAU,iBACpB,UAACsC,EAAAA,EAASA,CAAAA,CAACtC,UAAU,qBAAY,wBACjC,UAACwC,EAAAA,EAAeA,CAAAA,UAAC,+CAInB,UAACE,EAAAA,EAAWA,CAAAA,UACV,UAACyG,EAAAA,CAAUA,CAAAA,CAACnJ,UAAU,0BACpB,UAACc,MAAAA,CAAId,UAAU,qBACZkiB,EAAWhhB,GAAG,CAAC,CAACyiB,EAAUxiB,IACzB,WAACL,MAAAA,CAECd,UAAU,sEAEV,WAACc,MAAAA,CAAId,UAAU,sBACM,WAAlB2jB,EAAS1hB,IAAI,EACZ,UAAC6K,EAAAA,CAAMA,CAAAA,CAAC9M,UAAU,0BAED,YAAlB2jB,EAAS1hB,IAAI,EACZ,UAACoF,EAAAA,CAAQA,CAAAA,CAACrH,UAAU,2BAEH,YAAlB2jB,EAAS1hB,IAAI,EACZ,UAACshB,EAAAA,CAAQA,CAAAA,CAACvjB,UAAU,2BAEH,cAAlB2jB,EAAS1hB,IAAI,EACZ,UAACuhB,EAAAA,CAAQA,CAAAA,CAACxjB,UAAU,4BAEpB2jB,CAAkB,cAAlBA,EAAS1hB,IAAI,EACK,YAAlB0hB,EAAS1hB,IAAI,CAAa,EAC1B,UAACshB,EAAAA,CAAQA,CAAAA,CAACvjB,UAAU,+BAGxB,WAACc,MAAAA,CAAId,UAAU,mBACb,WAACc,MAAAA,CAAId,UAAU,oCACb,UAACsJ,EAAAA,CAAKA,CAAAA,CACJjI,QACsB,aAApBsiB,EAASjY,MAAM,CACX,UACoB,YAApBiY,EAASjY,MAAM,CACb,UACA,cAER1L,UAAU,+BAET2jB,EAASjY,MAAM,GAElB,WAACzK,OAAAA,CAAKjB,UAAU,0CAAgC,UACtC2jB,EAASrB,KAAK,OAG1B,UAAC7f,IAAAA,CAAEzC,UAAU,wBAAgB2jB,EAASjd,OAAO,QAvC1CvF,eAiDnB,UAAC+H,EAAAA,WAAWA,CAAAA,CAACD,MAAM,WAAWjJ,UAAU,gBACtC,WAACwB,EAAAA,EAAIA,CAAAA,WACH,WAACa,EAAAA,EAAUA,CAAAA,CAACrC,UAAU,iBACpB,UAACsC,EAAAA,EAASA,CAAAA,CAACtC,UAAU,qBAAY,sBACjC,UAACwC,EAAAA,EAAeA,CAAAA,UAAC,+CAInB,UAACE,EAAAA,EAAWA,CAAAA,UACV,UAACyG,EAAAA,CAAUA,CAAAA,CAACnJ,UAAU,0BACnBoiB,EAAS9hB,MAAM,CAAG,EACjB,UAACQ,MAAAA,CAAId,UAAU,qBACZoiB,EAASlhB,GAAG,CAAC,CAAC0iB,EAASziB,IACtB,WAACL,MAAAA,CAECd,UAAU,kDAEV,UAACyC,IAAAA,CAAEzC,UAAU,wBAAgB4jB,EAAQjjB,OAAO,GAC5C,WAACG,MAAAA,CAAId,UAAU,qDACb,WAACiB,OAAAA,WAAK,cACQ,IACV2iB,CAAqB,MAAbN,UAAU,CAAK,CAAGO,OAAO,CAAC,GAAG,OAEzC,WAAC5iB,OAAAA,WAAK,YAAU2iB,EAAQ5B,OAAO,CAAC3V,IAAI,CAAC,cATlClL,MAeX,UAACL,MAAAA,CAAId,UAAU,kDAAyC,mEAUnE2iB,GACC,UAAC7hB,MAAAA,CAAId,UAAU,qDAA4C,4CAhP5C,IAuPzB,gdC9dO,IAAM8jB,EAAwB,CACnC,CACE7a,MAAO,UACPiX,MAAO,UACPvO,KAAMoS,EAAAA,CAAIA,CACVrN,YAAa,6BACf,EACA,CACEzN,MAAO,SACPiX,MAAO,SACPvO,KAAMqS,EAAAA,CAAKA,CACXtN,YAAa,yCACf,EACA,CACEzN,MAAO,OACPiX,MAAO,OACPvO,KAAMyO,EAAAA,CAAKA,CACX1J,YAAa,sCACf,EACD,CAAC,EAEsB,CACtB,CAAEzN,MAAO,SAAUiX,MAAO,QAAS,EACnC,CAAEjX,MAAO,gBAAiBiX,MAAO,eAAgB,EAClD,CAyCM,SAAShI,EAAkB,QAChCrV,CAAM,cACNsV,CAAY,eACZC,CAAa,oBACbC,CAAkB,eAClBC,CAAa,oBACbC,CAAkB,eAClBC,CAAa,cACbC,CAAY,iBACZC,CAAe,YACf/F,GAAa,CAAK,gBAClB2E,CAAc,mBACdrD,GAAoB,CAAK,gBACzBsD,CAAc,CACdrD,oBAAoB,EAAK,yBACzBuD,CAAuB,4BACvBrD,GAA6B,CAAK,kBAClCsD,CAAgB,qBAChBpD,GAAsB,CAAK,iBAC3BqD,CAAe,oBACfnD,EAAqB,EAAK,CACH,EACvB,GAAM,CAAE5B,MAAI,CAAE,CAAGE,CAAAA,EAAAA,EAAAA,OAAAA,CAAOA,GAClB,OAAEC,CAAK,CAAE,CAAGC,CAAAA,EAAAA,EAAAA,CAAAA,CAAQA,GACpBC,EAAWC,CAAAA,EAAAA,EAAAA,EAAAA,CAAkBA,GAC7B,CAAC+Q,EAAUC,EAAY,CAAG/jB,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAAgB,EAAE,EACpD,CAACgkB,EAAmBC,EAAqB,CAAGjkB,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,EAAC,GACrD,CAACkkB,GAAWC,GAAa,CAAGnkB,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,EAAC,GACrC,CAACokB,GAAWC,GAAa,CAAGrkB,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,EAAC,GACrC,CAACskB,GAAaC,GAAe,CAAGvkB,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,EAAC,GACzC,CAACwkB,GAAeC,GAAiB,CAAGzkB,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,EAAC,GAC7C,CAAC0kB,GAAYC,GAAc,CAAG3kB,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,EAAC,GACvC,CAAC4kB,GAAgBC,GAAkB,CAAG7kB,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,EAAC,GAC/C,CAACwT,GAAcC,GAAgB,CAAGzT,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,CAACgY,GAC3C,CAAC8M,GAAeC,GAAiB,CAAG/kB,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,EAAC,GAC7C,CAACglB,GAAuBC,GAAyB,CAAGjlB,CAAAA,EAAAA,EAAAA,QAAAA,CAAQA,EAAC,GAwJ7DklB,GAAmBvB,EAAsB3f,IAAI,CACjD,GAAYmhB,EAAOrc,KAAK,GAAKoP,GAEzBkN,GAAiBF,IAAkB1T,MAAQoS,EAAAA,CAAIA,CAE/CyB,GAAiB,UACrBlB,IAAa,GACb,GAAI,CACF,IAAMmB,EAAU,GAAGC,OAAOC,QAAQ,CAACC,MAAM,CAAC,MAAM,EAAE/iB,EAAAA,CAClD,OAAMyc,UAAUC,SAAS,CAACC,SAAS,CAACiG,GACpC1S,EAAM,CACJvH,MAAO,cACPkL,YAAa,+BACf,EACF,CAAE,MAAOvQ,EAAO,CACdI,QAAQJ,KAAK,CAAC,uBAAwBA,GACtC4M,EAAM,CACJvH,MAAO,sBACPkL,YAAa,2CACbrV,QAAS,aACX,EACF,QAAU,CACRijB,IAAa,EACf,CACF,EAEMuB,GAAkB,MAAOC,IAC7B,GACEA,IAAkBzN,IAClBkM,IACCtR,GACAL,GAAMpS,GADP,CAGA,EAFA,EAGW,GACb,GAAI,CACF,GAAM,CAAE2F,MAAO4f,CAAW,CAAE,CAAG,MAAM9S,EAClC+B,IAAI,CAAC,iBACLgR,MAAM,CAAC,CACN3P,WAAYyP,EACZG,WAAY,IAAIjf,OAAOkf,WAAW,EACpC,GACChR,EAAE,CAAC,KAAMrS,GACTqS,EAAE,CAAC,UAAWtC,EAAKpS,EAAE,EACxB,GAAIulB,EAAa,MAAMA,EACvBxN,EAAmBuN,GACnB/S,EAAM,CACJvH,MAAO,0BACPkL,YAAa,CAAC,YAAY,EAAEoP,EAAAA,CAC9B,EACF,CAAE,MAAO3f,EAAY,CACnBI,QAAQJ,KAAK,CAAC,+BAAgCA,GAC9C4M,EAAM,CACJvH,MAAO,8BACPkL,YAAavQ,EAAMO,OAAO,CAC1BrF,QAAS,aACX,EACF,QAAU,CACRmjB,IAAa,EACf,EACF,EAEM2B,GAAoB,UACxB,IAAI1B,IACJC,IAAe,GACf,EAFiB,CAEb,CAIF,GAAI,CAACrf,CAHY,MAAMC,MAAM,CAAC,UAAU,EAAEzC,EAAO,QAAQ,CAAC,CAAE,CAC1D0C,OAAQ,KACV,IACcS,EAAE,CAAE,MAAM,MAAU,0BAClC+M,EAAM,CAAEvH,MAAO,eAAgB,GAC/B4Z,IAAyB,EAC3B,CAAE,MAAOjf,EAAY,CACnBI,QAAQJ,KAAK,CAAC,0BAA2BA,GACzC4M,EAAM,CACJvH,MAAO,yBACPkL,YAAavQ,EAAMO,OAAO,CAC1BrF,QAAS,aACX,EACF,QAAU,CACRqjB,IAAe,EACjB,EACF,EAEM0B,GAAsB,UAC1B,IAAIzB,IACJC,GAAiB,IACjB,GAAI,CAFe,GAMb,CAACvf,CAHY,MAAMC,MAAM,CAAC,UAAU,EAAEzC,EAAO,UAAU,CAAC,CAAE,CAC5D0C,OAAQ,KACV,IACcS,EAAE,CAAE,MAAM,MAAU,4BAClC+M,EAAM,CAAEvH,MAAO,iBAAkB,GACjC4Z,GAAyB,GAC3B,CAAE,MAAOjf,EAAY,CACnBI,QAAQJ,KAAK,CAAC,4BAA6BA,GAC3C4M,EAAM,CACJvH,MAAO,2BACPkL,YAAavQ,EAAMO,OAAO,CAC1BrF,QAAS,aACX,EACF,QAAU,CACRujB,IAAiB,EACnB,EACF,EAEMyB,GAAmB,UACvB,IAAIxB,IACJC,IAAc,GACd,CAFgB,EAEZ,CAEF,GAAI,CAACzf,CADY,MAAMC,MAAM,CAAC,UAAU,EAAEzC,EAAAA,CAAQ,CAAE,CAAE0C,OAAQ,QAAS,IACzDS,EAAE,CAAE,MAAM,MAAU,yBAClC+M,EAAM,CAAEvH,MAAO,cAAe,GAC9BiN,GACF,CAAE,MAAOtS,EAAY,CACnBI,QAAQJ,KAAK,CAAC,yBAA0BA,GACxC4M,EAAM,CACJvH,MAAO,wBACPkL,YAAavQ,EAAMO,OAAO,CAC1BrF,QAAS,aACX,EACF,QAAU,CACRyjB,IAAc,EAChB,EACF,EAMMwB,GAAkB1iB,CAAAA,EAAAA,EAAAA,WAAAA,CAAWA,CAAC,UAClC,IAAM2iB,EAAe5S,GAAa/M,IAAI,GACtC,GACE,CAACqM,GACD,CAACL,GAAMpS,IACP,CAAC+lB,GACDA,IAAiBpO,GACjB8M,GACA,CACAD,IAAkB,GACduB,IAAiBpO,GAAcvE,GAAgBuE,GACnD,MACF,CACA+M,IAAiB,GACjB,GAAI,CACF,GAAM,OAAE/e,CAAK,CAAE,CAAG,MAAM8M,EACrB+B,IAAI,CAAC,iBACLgR,MAAM,CAAC,CAAExa,MAAO+a,EAAcN,WAAY,IAAIjf,OAAOkf,WAAW,EAAG,GACnEhR,EAAE,CAAC,KAAMrS,GACZ,GAAIsD,EAAO,MAAMA,EACjB4M,EAAM,CAAEvH,MAAO,eAAgB,GAC/BwZ,IAAkB,GAClBd,EAAY,GACVpgB,EAAK5C,GAAG,CAAC,GAAQslB,EAAEhmB,EAAE,GAAKqC,EAAS,CAAE,GAAG2jB,CAAC,CAAEhb,MAAO+a,CAAa,EAAIC,IAEjEhO,GACFA,EAAc+N,EAElB,CAAE,MAAO/d,CAHY,CAGF,CACjBjC,QAAQJ,KAAK,CAAC,0BAA2BqC,GACzCuK,EAAM,CAAEvH,MAAO,uBAAwBnK,QAAS,aAAc,GAC9DuS,GAAgBuE,EAClB,QAAU,CACR+M,IAAiB,GACjBF,IAAkB,EACpB,CACF,EAAG,CACD/R,EACAL,GAAMpS,GACNqC,EACA8Q,GACAwE,EACApF,EACAkS,GACAzM,EACD,EAYKiO,GAAmB,UACvB,GAAI,CACF,IAAMphB,EAAW,MAAMC,MAAM,CAAC,UAAU,EAAEzC,EAAO,SAAS,CAAC,CAAE,CAC3D0C,OAAQ,MACRC,QAAS,CACP,eAAgB,kBAClB,CACF,GAEA,GAAI,CAACH,EAASW,EAAE,CACd,CADgB,KACV,MAAU,iCAGlB,IAAMlG,EAAW,MAAMuF,EAASa,IAAI,GAEpC,GAAI,CAACpG,GAAgC,IAApBA,EAASQ,MAAM,CAAQ,YACtCyS,EAAM,CACJvH,MAAO,wBACPkL,YAAa,sCACf,GAKF,IAAMgQ,EAAY/S,IAAgB,CAAC,KAAK,EAAE9Q,EAAAA,CAAQ,CAC5C8jB,EAAgB,IAAI3f,OAAOkf,WAAW,GAAG/gB,KAAK,CAAC,IAAI,CAAC,EAAE,CACxDyhB,EAAgB,CAAC,EAAE,EAAEF,UAAU;AAAE,CAAC,CACtCE,GAAiB,CAAC,eAAe,EAAED,cAAc;AAAA;AAAI,CAAC,CAEtD7mB,EAAS+mB,OAAO,CAAC,IACf,IAAM9f,EAAY,IAAIC,KAAKN,EAAQogB,UAAU,EAAEhZ,cAAc,GACvDjN,EACJ6F,EAAQ7F,IAAI,CAACkmB,MAAM,CAAC,GAAGC,WAAW,GAAKtgB,EAAQ7F,IAAI,CAACwiB,KAAK,CAAC,GAC5DuD,GAAiB,CAAC,GAAG,EAAE/lB,EAAK,EAAE,EAAEkG,EAAU;AAAG,EAAEL,EAAQ/F,OAAO,CAAC;AAAA;AAAI,CACrE,GAGA,IAAMsmB,EAAO,IAAIC,KAAK,CAACN,EAAc,CAAE,CAAE3kB,KAAM,YAAa,GACtDsC,EAAM4iB,IAAIC,eAAe,CAACH,GAC1BtZ,EAAIrG,SAASM,aAAa,CAAC,KACjC+F,EAAEC,IAAI,CAAGrJ,EACToJ,EAAE0Z,QAAQ,CAAG,GAAGX,EAAU5I,OAAO,CAAC,OAAQ,KAAK,CAAC,EAAE6I,EAAc,IAAI,CAAC,CACrErf,SAAS7B,IAAI,CAAC6hB,WAAW,CAAC3Z,GAC1BA,EAAEjF,KAAK,GACPpB,SAAS7B,IAAI,CAAC8hB,WAAW,CAAC5Z,GAC1BwZ,IAAIK,eAAe,CAACjjB,GAEpBwO,EAAM,CACJvH,MAAO,6BACPkL,YAAa,CAAC,SAAS,EAAE/I,EAAE0Z,QAAQ,EAAE,EAEzC,CAAE,MAAOlhB,EAAY,CACnBI,QAAQJ,KAAK,CAAC,yBAA0BA,GACxC4M,EAAM,CACJvH,MAAO,wBACPkL,YAAavQ,EAAMO,OAAO,EAAI,+BAC9BrF,QAAS,aACX,EACF,CACF,EAMA,OAHE4iB,EAAS9f,IAAI,CAAC,GAAOqiB,EAAEhmB,EAAE,GAAKqC,IAAS2I,OAC9B3I,EAAT,CAAC,MAAM,IAAoB,EAAG,GAAG,CAGjC,GAHqC,CAAC,GAGtC,EAAC4kB,EAAAA,EAAeA,CAAAA,CAACC,cAAe,WAC9B,WAAC5mB,MAAAA,CAAId,UAAU,6FACb,WAACc,MAAAA,CAAId,UAAU,oCACb,UAACc,MAAAA,CAAId,UAAU,mCACZ+kB,GACC,iCACE,UAAC9X,EAAAA,CAAKA,CAAAA,CACJhE,MAAO0K,GACP7J,SAvIWjF,CAuID8iB,GAtIxB/T,GAAgB/O,EAAEC,MAAM,CAACmE,KAAK,CAChC,EAsIgB2e,OAAQtB,GACR/J,UAtFe,CAsFJsL,GArFX,SAAS,CAAnBhjB,EAAE4X,GAAG,EACP5X,EAAE+E,cAAc,GAChB0c,MACmB,UAAU,CAApBzhB,EAAE4X,GAAG,GACd7I,GAAgBuE,GAChB6M,IAAkB,GAEtB,EA+EgBhlB,UAAU,wBACV8nB,SAAS,IACTnf,SAAUsc,GACVlb,YAAY,eAEd,UAAC3I,EAAAA,CAAMA,CAAAA,CACLC,QAAQ,QACRC,KAAK,KACLC,QAAS+kB,GACT3d,SACEsc,IACAtR,GAAa/M,IAAI,KAAOuR,GACxB,CAACxE,GAAa/M,IAAI,YAGnBqe,GAAgB,YAAc,SAEjC,UAAC7jB,EAAAA,CAAMA,CAAAA,CACLC,QAAQ,QACRC,KAAK,KACLC,QAAS,KACPqS,GAAgBuE,GAChB6M,IAAkB,EACpB,EACArc,SAAUsc,YACX,cAKH,WAAC8C,EAAAA,EAAOA,CAAAA,WACN,UAACC,EAAAA,EAAcA,CAAAA,CAACvG,OAAO,aACrB,WAACrgB,EAAAA,CAAMA,CAAAA,CACLC,QAAQ,QACRrB,UAAU,kEACVuB,QAAS,IAAM,CAACoR,GAAcqS,IAAkB,GAChDrc,SAAUgK,YAEV,UAACwN,EAAAA,CAAaA,CAAAA,CAACngB,UAAU,gDACzB,UAACiB,OAAAA,CACCjB,UAAU,qDACVwL,MAAOmI,YAENA,IAAgB,aAElB,CAAChB,GACA,UAACsV,EAAAA,CAAMA,CAAAA,CAACjoB,UAAU,mHAIxB,UAACkoB,EAAAA,EAAcA,CAAAA,UACZvV,EAAagB,GAAe,oBAMrC,WAAC4N,EAAAA,EAAYA,CAAAA,WACX,WAACwG,EAAAA,EAAOA,CAAAA,WACN,UAACC,EAAAA,EAAcA,CAAAA,CAACvG,OAAO,aACrB,UAACD,EAAAA,EAAmBA,CAAAA,CAACC,OAAO,aAC1B,WAACrgB,EAAAA,CAAMA,CAAAA,CACLC,QAAQ,QACRC,KAAK,OACLtB,UAAU,wBACV2I,SAAUwb,YAEV,UAACgE,EAAAA,CAAWA,CAAAA,CAACnoB,UAAU,YACvB,UAACiB,OAAAA,CAAKjB,UAAU,mBAAU,uBAIhC,UAACkoB,EAAAA,EAAcA,CAAAA,UAAC,mBAElB,WAACvG,EAAAA,EAAmBA,CAAAA,CAACC,MAAM,QAAQ5hB,UAAU,iBAC3C,UAACooB,EAAAA,EAAiBA,CAAAA,UAAC,iBACnB,UAACC,EAAAA,EAAqBA,CAAAA,CAAAA,GACrBlE,EACC,UAACtC,EAAAA,EAAgBA,CAAAA,CAAClZ,QAAQ,aAAC,eACzBsb,EAAS3jB,MAAM,CAAG,EACpB2jB,EAAS/iB,GAAG,CAAE2R,GACZ,UAACgP,EAAAA,EAAgBA,CAAAA,CAEftgB,QAAS,IAAMmX,EAAgB7F,EAAQrS,EAAE,EACzCmI,SAAUkK,EAAQrS,EAAE,GAAKqC,EACzB7C,UAAWe,CAAAA,EAAAA,EAAAA,EAAAA,CAAEA,CAAC8R,EAAQrS,EAAE,GAAKqC,GAAU,sBAEvC,UAAC5B,OAAAA,CAAKjB,UAAU,oBACb6S,EAAQrH,KAAK,EACZ,CAAC,MAAM,EAAEqH,EAAQrS,EAAE,CAAC4H,SAAS,CAAC,EAAG,GAAG,IAAI,CAAC,IAPxCyK,EAAQrS,EAAE,GAYnB,UAACqhB,EAAAA,EAAgBA,CAAAA,CAAClZ,QAAQ,aAAC,0BAKjC,WAACof,EAAAA,EAAOA,CAAAA,WACN,UAACC,EAAAA,EAAcA,CAAAA,CAACvG,OAAO,aACrB,WAACrgB,EAAAA,CAAMA,CAAAA,CACLC,QAAQ,UACRC,KAAK,OACLC,QAASkX,EACTzY,UAAU,kCAEV,UAACsoB,EAAAA,CAAUA,CAAAA,CAACtoB,UAAU,YACtB,UAACiB,OAAAA,CAAKjB,UAAU,mBAAU,kBAG9B,UAACkoB,EAAAA,EAAcA,CAAAA,UAAC,mBAIpB,WAACpnB,MAAAA,CAAId,UAAU,kDACZuX,GACC,WAACwQ,EAAAA,EAAOA,CAAAA,WACN,UAACC,EAAAA,EAAcA,CAAAA,CAACvG,OAAO,aACrB,UAACrgB,EAAAA,CAAMA,CAAAA,CACLC,QAAS6S,EAAoB,YAAc,QAC3C5S,KAAK,OACLC,QAASgW,EACTvX,UAAU,mBAEV,UAAC8M,EAAAA,CAAMA,CAAAA,CAAC9M,UAAU,gBAGtB,UAACkoB,EAAAA,EAAcA,CAAAA,UAAC,sBAGnBzQ,GACC,WAACsQ,EAAAA,EAAOA,CAAAA,WACN,UAACC,EAAAA,EAAcA,CAAAA,CAACvG,OAAO,aACrB,UAACrgB,EAAAA,CAAMA,CAAAA,CACLC,QAAS+S,EAA6B,YAAc,QACpD9S,KAAK,OACLC,QAASkW,EACTzX,UAAU,mBAEV,UAACqH,EAAAA,CAAQA,CAAAA,CAACrH,UAAU,gBAGxB,UAACkoB,EAAAA,EAAcA,CAAAA,UAAC,0BAGnBxQ,GACC,WAACqQ,EAAAA,EAAOA,CAAAA,WACN,UAACC,EAAAA,EAAcA,CAAAA,CAACvG,OAAO,aACrB,UAACrgB,EAAAA,CAAMA,CAAAA,CACLC,QAASiT,EAAsB,YAAc,QAC7ChT,KAAK,OACLC,QAASmW,EACT1X,UAAU,mBAEV,UAACuoB,EAAAA,CAAMA,CAAAA,CAACvoB,UAAU,gBAGtB,UAACkoB,EAAAA,EAAcA,CAAAA,UAAC,mBAGnB5Q,GACC,WAACyQ,EAAAA,EAAOA,CAAAA,WACN,UAACC,EAAAA,EAAcA,CAAAA,CAACvG,OAAO,aACrB,UAACrgB,EAAAA,CAAMA,CAAAA,CACLC,QAAS4S,EAAoB,YAAc,QAC3C3S,KAAK,OACLC,QAAS+V,EACTtX,UAAU,mBAEV,UAACwoB,EAAAA,CAAYA,CAAAA,CAACxoB,UAAU,gBAG5B,UAACkoB,EAAAA,EAAcA,CAAAA,UAAC,uBAGnBvQ,GACC,WAACoQ,EAAAA,EAAOA,CAAAA,WACN,UAACC,EAAAA,EAAcA,CAAAA,CAACvG,OAAO,aACrB,UAACrgB,EAAAA,CAAMA,CAAAA,CACLC,QAASmT,EAAqB,YAAc,QAC5ClT,KAAK,OACLC,QAASoW,EACT3X,UAAU,mBAEV,UAACyoB,EAAAA,CAAkBA,CAAAA,CAACzoB,UAAU,gBAGlC,UAACkoB,EAAAA,EAAcA,CAAAA,UAAC,sBAGlB3Q,CAAAA,GACAE,GACAC,GACAJ,GACAK,CAAAA,CAAc,EAAM,UAAC7W,MAAAA,CAAId,UAAU,4BAErC,WAACuhB,EAAAA,EAAYA,CAAAA,WACX,WAACwG,EAAAA,EAAOA,CAAAA,WACN,UAACC,EAAAA,EAAcA,CAAAA,CAACvG,OAAO,aACrB,UAACD,EAAAA,EAAmBA,CAAAA,CAACC,OAAO,aAC1B,WAACrgB,EAAAA,CAAMA,CAAAA,CACLC,QAAQ,UACRrB,UAAU,+CAEV,UAAC0oB,EAAAA,CAASA,CAAAA,CAAC1oB,UAAU,kCACrB,UAACiB,OAAAA,CAAKjB,UAAU,0CACb2oB,EAAgBxkB,IAAI,CAAC,GAAO8e,EAAEha,KAAK,GAAKmP,IACrC8H,OAAS9H,IAEf,UAAC+P,EAAAA,CAAWA,CAAAA,CAACnoB,UAAU,yCAI7B,UAACkoB,EAAAA,EAAcA,CAAAA,UAAC,oBAElB,WAACvG,EAAAA,EAAmBA,CAAAA,CAACC,MAAM,gBACzB,UAACwG,EAAAA,EAAiBA,CAAAA,UAAC,iBACnB,UAACC,EAAAA,EAAqBA,CAAAA,CAAAA,GACtB,UAACO,EAAAA,EAAsBA,CAAAA,CACrB3f,MAAOmP,EACPyQ,cAAevQ,WAEdqQ,EAAgBznB,GAAG,CAAC,GACnB,UAAC4nB,EAAAA,EAAqBA,CAAAA,CAAmB7f,MAAO4O,EAAM5O,KAAK,UACxD4O,EAAMqI,KAAK,EADcrI,EAAM5O,KAAK,WAQ/C,WAACsY,EAAAA,EAAYA,CAAAA,WACX,WAACwG,EAAAA,EAAOA,CAAAA,WACN,UAACC,EAAAA,EAAcA,CAAAA,CAACvG,OAAO,aACrB,UAACD,EAAAA,EAAmBA,CAAAA,CAACC,OAAO,aAC1B,WAACrgB,EAAAA,CAAMA,CAAAA,CACLC,QAAQ,YACRrB,UAAU,+CAEV,UAACulB,GAAAA,CAAevlB,UAAU,YAC1B,UAACiB,OAAAA,CAAKjB,UAAU,mBACbqlB,IAAkBnF,OAAS,iBAKpC,UAACgI,EAAAA,EAAcA,CAAAA,UAAC,uBAElB,WAACvG,EAAAA,EAAmBA,CAAAA,CAACC,MAAM,MAAM5hB,UAAU,iBACzC,UAACooB,EAAAA,EAAiBA,CAAAA,UAAC,qBAClBtE,EAAsB5iB,GAAG,CAAC,GACzB,WAAC2gB,EAAAA,EAAgBA,CAAAA,CAEftgB,QAAS,IAAMskB,GAAgBP,EAAOrc,KAAK,EAC3CN,SAAU4b,IAAae,EAAOrc,KAAK,GAAKoP,YAExC,UAACiN,EAAO3T,IAAI,EAAC3R,UAAU,iBACvB,WAACc,MAAAA,WACC,UAACA,MAAAA,UAAKwkB,EAAOpF,KAAK,GAClB,UAACpf,MAAAA,CAAId,UAAU,yCACZslB,EAAO5O,WAAW,QARlB4O,EAAOrc,KAAK,GAarB,UAACof,EAAAA,EAAqBA,CAAAA,CAAAA,GACtB,UAACD,EAAAA,EAAiBA,CAAAA,UAAC,kBACnB,WAACvG,EAAAA,EAAgBA,CAAAA,CAACtgB,QAASikB,GAAgB7c,SAAU0b,aACnD,UAACtC,EAAAA,CAAIA,CAAAA,CAAC/hB,UAAU,iBAAkB,IACjCqkB,GAAY,aAAe,eAE9B,WAACxC,EAAAA,EAAgBA,CAAAA,CAACtgB,QAASklB,aACzB,UAACsC,EAAAA,CAAQA,CAAAA,CAAC/oB,UAAU,iBAAiB,kBAEtCmlB,GACC,WAACtD,EAAAA,EAAgBA,CAAAA,CACftgB,QAAS6kB,GACTzd,SAAUgc,aAEV,UAACqE,EAAAA,CAAOA,CAAAA,CAAChpB,UAAU,iBAAkB,IACpC2kB,GAAgB,iBAAmB,eAGtC,WAAC9C,EAAAA,EAAgBA,CAAAA,CACftgB,QAAS4kB,GACTxd,SAAU8b,aAEV,UAACuE,EAAAA,CAAOA,CAAAA,CAAChpB,UAAU,iBAAkB,IACpCykB,GAAc,eAAiB,aAGnC,CAAC9R,GACA,WAACkP,EAAAA,EAAgBA,CAAAA,CACftgB,QAAS8kB,GACT1d,SAAUkc,GACV7kB,UAAU,4EAEV,UAACipB,EAAAA,CAAKA,CAAAA,CAACjpB,UAAU,iBAAkB,IAClC6kB,GAAa,cAAgB,8BAShD,wDCn2BM,MAAW,cAAgB,CAAC,UAAY,EAC5C,CAAC,OAAQ,CAAE,GAAI,CAAM,OAAI,CAAM,OAAI,IAAM,IAAI,IAAM,KAAK,SAAU,EAClE,CAAC,OAAQ,CAAE,GAAI,CAAM,OAAI,CAAM,OAAI,IAAM,IAAI,GAAK,KAAK,SAAU,EACjE,CAAC,OAAQ,CAAE,GAAI,CAAK,MAAI,CAAK,MAAI,IAAM,IAAI,IAAM,KAAK,SAAU,EACjE,oCCJK,MAAgB,cAAgB,CAAC,eAAiB,EACtD,CAAC,MAAQ,EAAE,EAAG,CAAiE,mEAAK,SAAU,EAC/F,kJCJM,IAAM3S,EAA4C,CAAC,CAAEtB,UAAQ,CAAE,IAElE,IAAI6M,EAAO,GACPO,EAAW,YAEf,GAAgC,UAA5B,OAAOpN,EAASjQ,OAAO,CACvB,GAAI,CACA,IAAMuoB,EAASxjB,KAAKyjB,KAAK,CAACvY,EAASjQ,OAAO,EACpB,UAAlB,OAAOuoB,GAAkC,OAAXA,GAAmBA,EAAOzL,IAAI,EAAE,EACvDyL,EAAOzL,IAAI,CAClBO,EAAWkL,EAAOlL,QAAQ,EAAI,aAE9BP,EAAO7M,EAASjQ,OAAO,CAE7B,CAF+B,KAExBkE,EAAG,CACR4Y,EAAO7M,EAASjQ,OAAO,EAAE,GAEM,UAA5B,OAAOiQ,EAASjQ,OAAO,EALuD,OAKtCiQ,EAASjQ,OAAO,EAAa,EAAUA,OAAO,CAAS8c,IAAI,EAAE,CAC5GA,EAAO,EAAU9c,OAAO,CAAS8c,IAAI,CACrCO,EAAW,EAAUrd,OAAO,CAASqd,QAAQ,EAAI,aAIrD,MACI,WAACxc,EAAAA,EAAIA,CAAAA,CAACxB,UAAU,iCACZ,UAACqC,EAAAA,EAAUA,CAAAA,UACP,UAACC,EAAAA,EAASA,CAAAA,UAAEsO,EAASpF,KAAK,EAAI,oBAElC,UAAC9I,EAAAA,EAAWA,CAAAA,CAAC1C,UAAU,oCACnB,UAAC+d,EAAAA,CAAgBA,CAAAA,CAACC,SAAUA,EAAU/U,MAAOwU,QAI7D,EAAE,uDC/BI,MAAW,cAAgB,CAAC,UAAY,EAC5C,CAAC,UAAW,CAAE,GAAI,CAAM,OAAI,CAAK,MAAI,GAAK,IAAI,GAAK,KAAK,SAAU,EAClE,CAAC,MAAQ,EAAE,EAAG,CAA6B,+BAAK,SAAU,EAC1D,CAAC,MAAQ,EAAE,EAAG,CAAyB,2BAAK,SAAU,EACvD,oCCJK,MAAW,cAAgB,CAAC,UAAY,EAC5C,CAAC,MAAQ,EAAE,EAAG,CAA6C,+CAAK,SAAU,EAC1E,CAAC,UAAY,EAAE,OAAQ,CAAoB,sBAAK,SAAU,EAC1D,CAAC,OAAQ,CAAE,GAAI,CAAM,OAAI,CAAM,OAAI,IAAM,IAAI,GAAK,KAAK,SAAU,EAClE,oCCJK,MAAQ,cAAgB,CAAC,OAAS,EACtC,CAAC,QAAU,EAAE,EAAI,MAAM,CAAI,OAAM,CAAG,MAAM,GAAK,UAAU,EACzD,CAAC,MAAQ,EAAE,EAAG,CAAmD,qDAAK,SAAU,EAChF,CAAC,MAAQ,EAAE,EAAG,CAAY,cAAK,SAAU,EAC1C","sources":["webpack://@hijraah/web/../src/switch.tsx","webpack://@hijraah/web/./src/components/ui/unified-chat/UnifiedSuggestions.tsx","webpack://@hijraah/web/./src/components/ui/card.tsx","webpack://@hijraah/web/../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/esm/native.js?d497","webpack://@hijraah/web/../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/esm/rng.js?6e6f","webpack://@hijraah/web/../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/esm/stringify.js?ec9a","webpack://@hijraah/web/../../node_modules/.pnpm/uuid@11.1.0/node_modules/uuid/dist/esm/v4.js?63db","webpack://@hijraah/web/./src/components/ui/unified-chat/UnifiedDocumentProcessor.tsx","webpack://@hijraah/web/./src/components/ui/switch.tsx","webpack://@hijraah/web/./src/components/ui/unified-chat/UnifiedWebScraper.tsx","webpack://@hijraah/web/./src/components/ui/label.tsx","webpack://@hijraah/web/../../../src/icons/bar-chart-horizontal.ts","webpack://@hijraah/web/./src/hooks/useSpeechRecognition.ts","webpack://@hijraah/web/./src/components/ui/unified-chat/UnifiedArtifact.tsx","webpack://@hijraah/web/../../../src/icons/more-vertical.ts","webpack://@hijraah/web/./src/components/ui/unified-chat/UnifiedTypingIndicator.tsx","webpack://@hijraah/web/../../../src/icons/earth.ts","webpack://@hijraah/web/./src/artifacts/index.ts","webpack://@hijraah/web/../../../src/icons/archive.ts","webpack://@hijraah/web/../../../src/icons/clock.ts","webpack://@hijraah/web/../../../src/icons/paperclip.ts","webpack://@hijraah/web/./src/components/ui/textarea.tsx","webpack://@hijraah/web/./src/components/ui/unified-chat/UnifiedChatContainer.tsx","webpack://@hijraah/web/./src/hooks/use-artifact.ts","webpack://@hijraah/web/./src/artifacts/text/TextArtifact.tsx","webpack://@hijraah/web/../../../src/icons/plus-circle.ts","webpack://@hijraah/web/../../../src/icons/pencil.ts","webpack://@hijraah/web/./src/components/ui/unified-chat/UnifiedMessageInput.tsx","webpack://@hijraah/web/../../../src/icons/thumbs-down.ts","webpack://@hijraah/web/./src/components/ui/unified-chat/UnifiedMessageList.tsx","webpack://@hijraah/web/./src/components/ui/unified-chat/UnifiedMarkdown.tsx","webpack://@hijraah/web/./src/components/ui/table.tsx","webpack://@hijraah/web/../../../src/icons/stop-circle.ts","webpack://@hijraah/web/../../../src/icons/settings-2.ts","webpack://@hijraah/web/./src/artifacts/sheet/SheetArtifact.tsx","webpack://@hijraah/web/../../../src/icons/thumbs-up.ts","webpack://@hijraah/web/./src/components/ui/unified-chat/UnifiedCodeBlock.tsx","webpack://@hijraah/web/../../../src/icons/mic-off.ts","webpack://@hijraah/web/../../../src/icons/send-horizontal.ts","webpack://@hijraah/web/./src/components/ui/tabs.tsx","webpack://@hijraah/web/./src/components/ui/unified-chat/chat-analytics.tsx","webpack://@hijraah/web/../../../src/icons/external-link.ts","webpack://@hijraah/web/./src/components/ui/unified-chat/UnifiedMessage.tsx","webpack://@hijraah/web/../../../src/icons/mic.ts","webpack://@hijraah/web/../../../src/icons/trash.ts","webpack://@hijraah/web/./src/components/ui/unified-chat/UnifiedResearchContainer.tsx","webpack://@hijraah/web/./src/components/ui/unified-chat/UnifiedChatHeader.tsx","webpack://@hijraah/web/../../../src/icons/bar-chart.ts","webpack://@hijraah/web/../../../src/icons/message-square.ts","webpack://@hijraah/web/./src/artifacts/code/CodeArtifact.tsx","webpack://@hijraah/web/../../../src/icons/database.ts","webpack://@hijraah/web/../../../src/icons/download.ts","webpack://@hijraah/web/../../../src/icons/globe.ts"],"sourcesContent":["import * as React from 'react';\nimport { composeEventHandlers } from '@radix-ui/primitive';\nimport { useComposedRefs } from '@radix-ui/react-compose-refs';\nimport { createContextScope } from '@radix-ui/react-context';\nimport { useControllableState } from '@radix-ui/react-use-controllable-state';\nimport { usePrevious } from '@radix-ui/react-use-previous';\nimport { useSize } from '@radix-ui/react-use-size';\nimport { Primitive } from '@radix-ui/react-primitive';\n\nimport type { Scope } from '@radix-ui/react-context';\n\n/* -------------------------------------------------------------------------------------------------\n * Switch\n * -----------------------------------------------------------------------------------------------*/\n\nconst SWITCH_NAME = 'Switch';\n\ntype ScopedProps<P> = P & { __scopeSwitch?: Scope };\nconst [createSwitchContext, createSwitchScope] = createContextScope(SWITCH_NAME);\n\ntype SwitchContextValue = { checked: boolean; disabled?: boolean };\nconst [SwitchProvider, useSwitchContext] = createSwitchContext<SwitchContextValue>(SWITCH_NAME);\n\ntype SwitchElement = React.ComponentRef<typeof Primitive.button>;\ntype PrimitiveButtonProps = React.ComponentPropsWithoutRef<typeof Primitive.button>;\ninterface SwitchProps extends PrimitiveButtonProps {\n  checked?: boolean;\n  defaultChecked?: boolean;\n  required?: boolean;\n  onCheckedChange?(checked: boolean): void;\n}\n\nconst Switch = React.forwardRef<SwitchElement, SwitchProps>(\n  (props: ScopedProps<SwitchProps>, forwardedRef) => {\n    const {\n      __scopeSwitch,\n      name,\n      checked: checkedProp,\n      defaultChecked,\n      required,\n      disabled,\n      value = 'on',\n      onCheckedChange,\n      form,\n      ...switchProps\n    } = props;\n    const [button, setButton] = React.useState<HTMLButtonElement | null>(null);\n    const composedRefs = useComposedRefs(forwardedRef, (node) => setButton(node));\n    const hasConsumerStoppedPropagationRef = React.useRef(false);\n    // We set this to true by default so that events bubble to forms without JS (SSR)\n    const isFormControl = button ? form || !!button.closest('form') : true;\n    const [checked, setChecked] = useControllableState({\n      prop: checkedProp,\n      defaultProp: defaultChecked ?? false,\n      onChange: onCheckedChange,\n      caller: SWITCH_NAME,\n    });\n\n    return (\n      <SwitchProvider scope={__scopeSwitch} checked={checked} disabled={disabled}>\n        <Primitive.button\n          type=\"button\"\n          role=\"switch\"\n          aria-checked={checked}\n          aria-required={required}\n          data-state={getState(checked)}\n          data-disabled={disabled ? '' : undefined}\n          disabled={disabled}\n          value={value}\n          {...switchProps}\n          ref={composedRefs}\n          onClick={composeEventHandlers(props.onClick, (event) => {\n            setChecked((prevChecked) => !prevChecked);\n            if (isFormControl) {\n              hasConsumerStoppedPropagationRef.current = event.isPropagationStopped();\n              // if switch is in a form, stop propagation from the button so that we only propagate\n              // one click event (from the input). We propagate changes from an input so that native\n              // form validation works and form events reflect switch updates.\n              if (!hasConsumerStoppedPropagationRef.current) event.stopPropagation();\n            }\n          })}\n        />\n        {isFormControl && (\n          <SwitchBubbleInput\n            control={button}\n            bubbles={!hasConsumerStoppedPropagationRef.current}\n            name={name}\n            value={value}\n            checked={checked}\n            required={required}\n            disabled={disabled}\n            form={form}\n            // We transform because the input is absolutely positioned but we have\n            // rendered it **after** the button. This pulls it back to sit on top\n            // of the button.\n            style={{ transform: 'translateX(-100%)' }}\n          />\n        )}\n      </SwitchProvider>\n    );\n  }\n);\n\nSwitch.displayName = SWITCH_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * SwitchThumb\n * -----------------------------------------------------------------------------------------------*/\n\nconst THUMB_NAME = 'SwitchThumb';\n\ntype SwitchThumbElement = React.ComponentRef<typeof Primitive.span>;\ntype PrimitiveSpanProps = React.ComponentPropsWithoutRef<typeof Primitive.span>;\ninterface SwitchThumbProps extends PrimitiveSpanProps {}\n\nconst SwitchThumb = React.forwardRef<SwitchThumbElement, SwitchThumbProps>(\n  (props: ScopedProps<SwitchThumbProps>, forwardedRef) => {\n    const { __scopeSwitch, ...thumbProps } = props;\n    const context = useSwitchContext(THUMB_NAME, __scopeSwitch);\n    return (\n      <Primitive.span\n        data-state={getState(context.checked)}\n        data-disabled={context.disabled ? '' : undefined}\n        {...thumbProps}\n        ref={forwardedRef}\n      />\n    );\n  }\n);\n\nSwitchThumb.displayName = THUMB_NAME;\n\n/* -------------------------------------------------------------------------------------------------\n * SwitchBubbleInput\n * -----------------------------------------------------------------------------------------------*/\n\nconst BUBBLE_INPUT_NAME = 'SwitchBubbleInput';\n\ntype InputProps = React.ComponentPropsWithoutRef<typeof Primitive.input>;\ninterface SwitchBubbleInputProps extends Omit<InputProps, 'checked'> {\n  checked: boolean;\n  control: HTMLElement | null;\n  bubbles: boolean;\n}\n\nconst SwitchBubbleInput = React.forwardRef<HTMLInputElement, SwitchBubbleInputProps>(\n  (\n    {\n      __scopeSwitch,\n      control,\n      checked,\n      bubbles = true,\n      ...props\n    }: ScopedProps<SwitchBubbleInputProps>,\n    forwardedRef\n  ) => {\n    const ref = React.useRef<HTMLInputElement>(null);\n    const composedRefs = useComposedRefs(ref, forwardedRef);\n    const prevChecked = usePrevious(checked);\n    const controlSize = useSize(control);\n\n    // Bubble checked change to parents (e.g form change event)\n    React.useEffect(() => {\n      const input = ref.current;\n      if (!input) return;\n\n      const inputProto = window.HTMLInputElement.prototype;\n      const descriptor = Object.getOwnPropertyDescriptor(\n        inputProto,\n        'checked'\n      ) as PropertyDescriptor;\n      const setChecked = descriptor.set;\n      if (prevChecked !== checked && setChecked) {\n        const event = new Event('click', { bubbles });\n        setChecked.call(input, checked);\n        input.dispatchEvent(event);\n      }\n    }, [prevChecked, checked, bubbles]);\n\n    return (\n      <input\n        type=\"checkbox\"\n        aria-hidden\n        defaultChecked={checked}\n        {...props}\n        tabIndex={-1}\n        ref={composedRefs}\n        style={{\n          ...props.style,\n          ...controlSize,\n          position: 'absolute',\n          pointerEvents: 'none',\n          opacity: 0,\n          margin: 0,\n        }}\n      />\n    );\n  }\n);\n\nSwitchBubbleInput.displayName = BUBBLE_INPUT_NAME;\n\n/* -----------------------------------------------------------------------------------------------*/\n\nfunction getState(checked: boolean) {\n  return checked ? 'checked' : 'unchecked';\n}\n\nconst Root = Switch;\nconst Thumb = SwitchThumb;\n\nexport {\n  createSwitchScope,\n  //\n  Switch,\n  SwitchThumb,\n  //\n  Root,\n  Thumb,\n};\nexport type { SwitchProps, SwitchThumbProps };\n","'use client'\r\n\r\nimport { Message } from 'ai'\r\nimport { Sparkles } from 'lucide-react'\r\nimport { useEffect, useState } from 'react'\r\n\r\nimport { Button } from '@/components/ui/button'\r\nimport { cn } from '@/lib/utils'\r\n\r\ninterface UnifiedSuggestionsProps {\r\n    messages: Message[]\r\n    append: (message: Message | Message[]) => Promise<void>\r\n    className?: string\r\n}\r\n\r\n// Sample suggested prompts - in production these could be dynamically generated based on context\r\nconst initialSuggestions = [\r\n    'Can you explain the Canada Express Entry requirements?',\r\n    'What documents do I need for a US H1B visa?',\r\n    'Compare UK and Australia immigration policies',\r\n    'How long does the immigration process usually take?'\r\n]\r\n\r\nconst followUpSuggestions = [\r\n    'Can you elaborate on the financial requirements?',\r\n    'What are the next steps in the process?',\r\n    'Are there any exceptions to these rules?'\r\n]\r\n\r\nexport function UnifiedSuggestions({ messages, append, className }: UnifiedSuggestionsProps) {\r\n    const [suggestions, setSuggestions] = useState<string[]>([])\r\n    const [isVisible, setIsVisible] = useState(true)\r\n\r\n    // Logic adapted from AISuggestions:\r\n    // Show initial suggestions, then contextual ones, then hide.\r\n    useEffect(() => {\r\n        if (messages.length === 0) {\r\n            // Initial suggestions for new conversations\r\n            setSuggestions(initialSuggestions)\r\n            setIsVisible(true)\r\n        } else if (messages.length === 2) {\r\n            // After first exchange, provide follow-up suggestions\r\n            const lastMessage = messages[messages.length - 1]\r\n            if (lastMessage.role === 'assistant') {\r\n                // Generate contextual suggestions based on the assistant's response\r\n                // This could be enhanced with an API call to generate dynamic suggestions\r\n                setSuggestions(followUpSuggestions) // Use placeholder follow-ups\r\n                setIsVisible(true)\r\n            } else {\r\n                // If user sent the second message, hide suggestions for now\r\n                setIsVisible(false)\r\n            }\r\n        } else if (messages.length > 2) {\r\n            // Hide suggestions after the initial exchange (adjust threshold as needed)\r\n            setIsVisible(false)\r\n        } else {\r\n            // Keep suggestions hidden if only one message exists (user's first message)\r\n            setIsVisible(false)\r\n        }\r\n    }, [messages])\r\n\r\n    if (!isVisible || suggestions.length === 0) return null\r\n\r\n    const handleSuggestionClick = (suggestion: string) => {\r\n        append({\r\n            id: crypto.randomUUID(), // Use crypto.randomUUID()\r\n            content: suggestion,\r\n            role: 'user',\r\n        })\r\n        // No need to explicitly setIsVisible(false) here,\r\n        // the useEffect will handle it when messages update.\r\n    }\r\n\r\n    return (\r\n        // Apply className to the root div\r\n        <div className={cn('mb-4', className)}>\r\n            <div className=\"mb-2 flex items-center gap-2\">\r\n                <Sparkles className=\"h-4 w-4 text-primary\" />\r\n                <span className=\"text-sm font-medium\">Suggested questions</span>\r\n            </div>\r\n            <div className=\"flex flex-wrap gap-2\">\r\n                {suggestions.map((suggestion, index) => (\r\n                    <Button\r\n                        key={index}\r\n                        variant=\"outline\"\r\n                        size=\"sm\"\r\n                        className=\"text-xs\"\r\n                        onClick={() => handleSuggestionClick(suggestion)} // Use handler\r\n                    >\r\n                        {suggestion}\r\n                    </Button>\r\n                ))}\r\n            </div>\r\n        </div>\r\n    );\r\n} ","/**\r\n * Card component and related sub-components.\r\n * Provides a container for related content with variants for different use cases.\r\n */\r\n\r\nimport { motion, HTMLMotionProps } from \"motion/react\";\r\nimport * as React from \"react\";\r\n\r\nimport { cn } from \"@/lib/utils\";\r\n\r\n// Define a type for CardProps\r\n// Omit 'className' from HTMLMotionProps because we handle it with `cn`\r\n// Omit 'ref' as it's typed by React.forwardRef\r\ninterface CardProps extends Omit<HTMLMotionProps<\"div\">, \"className\" | \"ref\"> {\r\n  className?: string;\r\n}\r\n\r\nconst Card = React.forwardRef<HTMLDivElement, CardProps>(\r\n  ({ className, ...props }, ref) => (\r\n    <motion.div\r\n      ref={ref}\r\n      className={cn(\r\n        \"rounded-lg border bg-card text-card-foreground shadow-sm\",\r\n        className\r\n      )}\r\n      whileHover={{\r\n        scale: 1.03,\r\n        boxShadow:\r\n          \"0px 7px 25px rgba(0,0,0,0.08), 0px 3px 10px rgba(0,0,0,0.04)\",\r\n      }}\r\n      transition={{ type: \"spring\", stiffness: 300, damping: 20 }}\r\n      {...props}\r\n    />\r\n  )\r\n);\r\nCard.displayName = \"Card\";\r\n\r\nconst CardHeader = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\r\n    {...props}\r\n  />\r\n));\r\nCardHeader.displayName = \"CardHeader\";\r\n\r\nconst CardTitle = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLHeadingElement>\r\n>(({ className, ...props }, ref) => (\r\n  <h3\r\n    ref={ref}\r\n    className={cn(\r\n      \"text-2xl font-semibold leading-none tracking-tight\",\r\n      className\r\n    )}\r\n    {...props}\r\n  />\r\n));\r\nCardTitle.displayName = \"CardTitle\";\r\n\r\nconst CardDescription = React.forwardRef<\r\n  HTMLParagraphElement,\r\n  React.HTMLAttributes<HTMLParagraphElement>\r\n>(({ className, ...props }, ref) => (\r\n  <p\r\n    ref={ref}\r\n    className={cn(\"text-sm text-muted-foreground\", className)}\r\n    {...props}\r\n  />\r\n));\r\nCardDescription.displayName = \"CardDescription\";\r\n\r\nconst CardContent = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\r\n));\r\nCardContent.displayName = \"CardContent\";\r\n\r\nconst CardFooter = React.forwardRef<\r\n  HTMLDivElement,\r\n  React.HTMLAttributes<HTMLDivElement>\r\n>(({ className, ...props }, ref) => (\r\n  <div\r\n    ref={ref}\r\n    className={cn(\"flex items-center p-6 pt-0\", className)}\r\n    {...props}\r\n  />\r\n));\r\nCardFooter.displayName = \"CardFooter\";\r\n\r\nexport {\r\n  Card,\r\n  CardHeader,\r\n  CardFooter,\r\n  CardTitle,\r\n  CardDescription,\r\n  CardContent,\r\n};\r\n","import { randomUUID } from 'crypto';\nexport default { randomUUID };\n","import { randomFillSync } from 'crypto';\nconst rnds8Pool = new Uint8Array(256);\nlet poolPtr = rnds8Pool.length;\nexport default function rng() {\n    if (poolPtr > rnds8Pool.length - 16) {\n        randomFillSync(rnds8Pool);\n        poolPtr = 0;\n    }\n    return rnds8Pool.slice(poolPtr, (poolPtr += 16));\n}\n","import validate from './validate.js';\nconst byteToHex = [];\nfor (let i = 0; i < 256; ++i) {\n    byteToHex.push((i + 0x100).toString(16).slice(1));\n}\nexport function unsafeStringify(arr, offset = 0) {\n    return (byteToHex[arr[offset + 0]] +\n        byteToHex[arr[offset + 1]] +\n        byteToHex[arr[offset + 2]] +\n        byteToHex[arr[offset + 3]] +\n        '-' +\n        byteToHex[arr[offset + 4]] +\n        byteToHex[arr[offset + 5]] +\n        '-' +\n        byteToHex[arr[offset + 6]] +\n        byteToHex[arr[offset + 7]] +\n        '-' +\n        byteToHex[arr[offset + 8]] +\n        byteToHex[arr[offset + 9]] +\n        '-' +\n        byteToHex[arr[offset + 10]] +\n        byteToHex[arr[offset + 11]] +\n        byteToHex[arr[offset + 12]] +\n        byteToHex[arr[offset + 13]] +\n        byteToHex[arr[offset + 14]] +\n        byteToHex[arr[offset + 15]]).toLowerCase();\n}\nfunction stringify(arr, offset = 0) {\n    const uuid = unsafeStringify(arr, offset);\n    if (!validate(uuid)) {\n        throw TypeError('Stringified UUID is invalid');\n    }\n    return uuid;\n}\nexport default stringify;\n","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\nfunction v4(options, buf, offset) {\n    if (native.randomUUID && !buf && !options) {\n        return native.randomUUID();\n    }\n    options = options || {};\n    const rnds = options.random ?? options.rng?.() ?? rng();\n    if (rnds.length < 16) {\n        throw new Error('Random bytes length must be >= 16');\n    }\n    rnds[6] = (rnds[6] & 0x0f) | 0x40;\n    rnds[8] = (rnds[8] & 0x3f) | 0x80;\n    if (buf) {\n        offset = offset || 0;\n        if (offset < 0 || offset + 16 > buf.length) {\n            throw new RangeError(`UUID byte range ${offset}:${offset + 15} is out of buffer bounds`);\n        }\n        for (let i = 0; i < 16; ++i) {\n            buf[offset + i] = rnds[i];\n        }\n        return buf;\n    }\n    return unsafeStringify(rnds);\n}\nexport default v4;\n","\"use client\";\r\n\r\nimport { Message } from \"ai\";\r\nimport { FileText, Upload, Search, File, AlertCircle, X } from \"lucide-react\";\r\nimport { useState, useEffect, useCallback } from \"react\";\r\n\r\nimport { Alert, AlertTitle, AlertDescription } from \"@/components/ui/alert\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n  Card,\r\n  CardHeader,\r\n  CardTitle,\r\n  CardDescription,\r\n  CardContent,\r\n  CardFooter,\r\n} from \"@/components/ui/card\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Progress } from \"@/components/ui/progress\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\n\r\nimport { UnifiedMarkdown } from \"./UnifiedMarkdown\";\r\n\r\n// Type for the input attachments (adjust if needed)\r\ninterface ExtendedAttachment extends File {\r\n  id: string; // Unique identifier for the attachment instance\r\n  url?: string; // Optional URL if it's already uploaded/stored\r\n  type: string; // MIME type\r\n  name: string;\r\n  size: number;\r\n}\r\n\r\n// Interface for the state tracking processed documents\r\ninterface ProcessedDocument {\r\n  id: string; // Matches ExtendedAttachment id\r\n  name: string;\r\n  type: string;\r\n  url?: string;\r\n  size: number;\r\n  ocrStatus: \"idle\" | \"processing\" | \"complete\" | \"error\";\r\n  progress: number;\r\n  errorMessage?: string;\r\n  ocrText?: string;\r\n  questions?: Array<{ question: string; answer: string; timestamp: number }>;\r\n}\r\n\r\ninterface UnifiedDocumentProcessorProps {\r\n  chatId: string;\r\n  attachments: ExtendedAttachment[];\r\n  append: (message: Message | Message[]) => Promise<void>;\r\n  isLoading: boolean;\r\n  isVisible: boolean;\r\n  className?: string;\r\n}\r\n\r\nexport function UnifiedDocumentProcessor({\r\n  chatId,\r\n  attachments,\r\n  append,\r\n  isLoading,\r\n  isVisible,\r\n  className,\r\n}: UnifiedDocumentProcessorProps) {\r\n  const [processedDocuments, setProcessedDocuments] = useState<\r\n    ProcessedDocument[]\r\n  >([]);\r\n  const [activeDocument, setActiveDocument] =\r\n    useState<ProcessedDocument | null>(null);\r\n  const [activeTab, setActiveTab] = useState(\"documents\");\r\n  const [question, setQuestion] = useState(\"\");\r\n  const [isAsking, setIsAsking] = useState(false);\r\n  const [isProcessing, setIsProcessing] = useState(false);\r\n\r\n  // Load processed documents from sessionStorage on initial render\r\n  useEffect(() => {\r\n    if (!chatId) return;\r\n\r\n    const storedDocuments = sessionStorage.getItem(`documents-${chatId}`);\r\n    if (storedDocuments) {\r\n      setProcessedDocuments(JSON.parse(storedDocuments));\r\n    }\r\n  }, [chatId]);\r\n\r\n  // Save processed documents to sessionStorage when they change\r\n  useEffect(() => {\r\n    if (!chatId) return;\r\n\r\n    sessionStorage.setItem(\r\n      `documents-${chatId}`,\r\n      JSON.stringify(processedDocuments)\r\n    );\r\n  }, [chatId, processedDocuments]);\r\n\r\n  // Handle file upload through a custom file input\r\n  const handleNewFile = () => {\r\n    // Create and click a hidden file input\r\n    const fileInput = document.createElement(\"input\");\r\n    fileInput.type = \"file\";\r\n    fileInput.accept =\r\n      \"application/pdf,image/jpeg,image/png,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document\";\r\n    fileInput.multiple = false;\r\n\r\n    fileInput.onchange = (e) => {\r\n      const files = (e.target as HTMLInputElement).files;\r\n      if (!files || files.length === 0) return;\r\n\r\n      const file = files[0];\r\n      const fileId = Math.random().toString(36).substring(2, 9);\r\n\r\n      // Create a new document entry\r\n      const newDoc: ProcessedDocument = {\r\n        id: fileId,\r\n        name: file.name,\r\n        type: file.type,\r\n        size: file.size,\r\n        ocrStatus: \"idle\",\r\n        progress: 0,\r\n      };\r\n\r\n      setProcessedDocuments((prev) => [...prev, newDoc]);\r\n\r\n      // Process the document\r\n      const reader = new FileReader();\r\n      reader.onload = async (event) => {\r\n        if (!event.target?.result) return;\r\n\r\n        setIsProcessing(true);\r\n\r\n        try {\r\n          // In a real implementation, this would upload the file to a server\r\n          // and trigger OCR processing\r\n\r\n          // Mock OCR processing for demo\r\n          setProcessedDocuments((prev) =>\r\n            prev.map((doc) =>\r\n              doc.id === fileId\r\n                ? { ...doc, ocrStatus: \"processing\", progress: 10 }\r\n                : doc\r\n            )\r\n          );\r\n\r\n          // Simulate processing delay\r\n          await new Promise((resolve) => setTimeout(resolve, 2000));\r\n\r\n          setProcessedDocuments((prev) =>\r\n            prev.map((doc) =>\r\n              doc.id === fileId ? { ...doc, progress: 50 } : doc\r\n            )\r\n          );\r\n\r\n          await new Promise((resolve) => setTimeout(resolve, 1000));\r\n\r\n          // Complete with mock data\r\n          setProcessedDocuments((prev) =>\r\n            prev.map((doc) =>\r\n              doc.id === fileId\r\n                ? {\r\n                    ...doc,\r\n                    ocrStatus: \"complete\",\r\n                    progress: 100,\r\n                    ocrText: `This is example extracted text from ${file.name}.\\n\\nIn a real implementation, this would be the actual content extracted from the document using OCR technology.`,\r\n                  }\r\n                : doc\r\n            )\r\n          );\r\n        } catch (err) {\r\n          console.error(\"Error processing file:\", err);\r\n          setProcessedDocuments((prev) =>\r\n            prev.map((doc) =>\r\n              doc.id === fileId\r\n                ? {\r\n                    ...doc,\r\n                    ocrStatus: \"error\",\r\n                    progress: 0,\r\n                    errorMessage: \"Failed to process document\",\r\n                  }\r\n                : doc\r\n            )\r\n          );\r\n        } finally {\r\n          setIsProcessing(false);\r\n        }\r\n      };\r\n\r\n      reader.onerror = () => {\r\n        setProcessedDocuments((prev) =>\r\n          prev.map((doc) =>\r\n            doc.id === fileId\r\n              ? {\r\n                  ...doc,\r\n                  ocrStatus: \"error\",\r\n                  errorMessage: \"Failed to read file\",\r\n                }\r\n              : doc\r\n          )\r\n        );\r\n        setIsProcessing(false);\r\n      };\r\n\r\n      reader.readAsDataURL(file);\r\n    };\r\n\r\n    fileInput.click();\r\n  };\r\n\r\n  // Process document using Mistral OCR API\r\n  const processDocument = useCallback(\r\n    async (docId: string) => {\r\n      // Update status to processing\r\n      setProcessedDocuments((prev) =>\r\n        prev.map((doc) =>\r\n          doc.id === docId\r\n            ? { ...doc, ocrStatus: \"processing\" as const, progress: 10 }\r\n            : doc\r\n        )\r\n      );\r\n\r\n      try {\r\n        const attachment = attachments.find((att) => att.id === docId);\r\n        if (!attachment) {\r\n          throw new Error(\"Attachment not found\");\r\n        }\r\n\r\n        // Prepare the file content\r\n        let fileContent = \"\";\r\n        let fileUrl = \"\";\r\n\r\n        // If the attachment has a URL, use it\r\n        if (attachment.url) {\r\n          fileUrl = attachment.url;\r\n        } else {\r\n          // Otherwise read the file content as base64\r\n          fileContent = await new Promise<string>((resolve) => {\r\n            const reader = new FileReader();\r\n            reader.onload = (e) => {\r\n              if (e.target?.result) {\r\n                // Extract the base64 part if it's a data URL\r\n                const result = e.target.result.toString();\r\n                const base64 = result.includes(\"base64,\")\r\n                  ? result.split(\"base64,\")[1]\r\n                  : result;\r\n                resolve(base64);\r\n              } else {\r\n                resolve(\"\");\r\n              }\r\n            };\r\n            reader.readAsDataURL(attachment);\r\n          });\r\n        }\r\n\r\n        // Update progress\r\n        setProcessedDocuments((prev) =>\r\n          prev.map((doc) => (doc.id === docId ? { ...doc, progress: 30 } : doc))\r\n        );\r\n\r\n        // Call the OCR API\r\n        const response = await fetch(\"/api/documents/ocr\", {\r\n          method: \"POST\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n          },\r\n          body: JSON.stringify({\r\n            fileId: docId,\r\n            chatId,\r\n            fileName: attachment.name,\r\n            fileType: attachment.type,\r\n            fileUrl,\r\n            fileContent,\r\n          }),\r\n        });\r\n\r\n        if (!response.ok) {\r\n          const errorData = await response.json();\r\n          throw new Error(errorData.error || \"Failed to process document\");\r\n        }\r\n\r\n        // Update progress\r\n        setProcessedDocuments((prev) =>\r\n          prev.map((doc) => (doc.id === docId ? { ...doc, progress: 90 } : doc))\r\n        );\r\n\r\n        const ocrResult = await response.json();\r\n\r\n        // Update the document with the OCR result\r\n        setProcessedDocuments((prev) =>\r\n          prev.map((doc) =>\r\n            doc.id === docId\r\n              ? {\r\n                  ...doc,\r\n                  ocrStatus: \"complete\" as const,\r\n                  progress: 100,\r\n                  ocrText: ocrResult.text,\r\n                }\r\n              : doc\r\n          )\r\n        );\r\n      } catch (error) {\r\n        console.error(\"Error processing document:\", error);\r\n\r\n        // Update status to error\r\n        setProcessedDocuments((prev) =>\r\n          prev.map((doc) =>\r\n            doc.id === docId\r\n              ? {\r\n                  ...doc,\r\n                  ocrStatus: \"error\" as const,\r\n                  progress: 0,\r\n                  errorMessage:\r\n                    error instanceof Error ? error.message : \"Unknown error\",\r\n                }\r\n              : doc\r\n          )\r\n        );\r\n      }\r\n    },\r\n    [attachments, chatId]\r\n  );\r\n\r\n  // Effect to process new attachments\r\n  useEffect(() => {\r\n    // Find attachments that haven't been processed yet\r\n    const newAttachments = attachments.filter(\r\n      (att) => !processedDocuments.some((doc) => doc.id === att.id)\r\n    );\r\n\r\n    if (newAttachments.length === 0) return;\r\n\r\n    // Add new attachments to the processed documents list\r\n    const newProcessedDocs = newAttachments.map((att) => ({\r\n      id: att.id,\r\n      name: att.name,\r\n      type: att.type,\r\n      url: att.url,\r\n      size: att.size,\r\n      ocrStatus: \"idle\" as const,\r\n      progress: 0,\r\n      errorMessage: \"\",\r\n      questions: [],\r\n    }));\r\n\r\n    setProcessedDocuments((prev) => [...prev, ...newProcessedDocs]);\r\n\r\n    // Process each new attachment\r\n    newProcessedDocs.forEach((doc) => {\r\n      processDocument(doc.id);\r\n    });\r\n  }, [attachments, processedDocuments, processDocument]);\r\n\r\n  // Ask a question about the document\r\n  const askQuestion = async () => {\r\n    if (!activeDocument || !question.trim() || isAsking || isLoading) return;\r\n\r\n    setIsAsking(true);\r\n\r\n    // Add the question to the document's question list\r\n    setProcessedDocuments((prev) =>\r\n      prev.map((doc) =>\r\n        doc.id === activeDocument.id\r\n          ? {\r\n              ...doc,\r\n              questions: [\r\n                ...(doc.questions || []),\r\n                {\r\n                  question,\r\n                  answer: \"Processing...\",\r\n                  timestamp: Date.now(),\r\n                },\r\n              ],\r\n            }\r\n          : doc\r\n      )\r\n    );\r\n\r\n    try {\r\n      // Call the document Q&A API\r\n      const response = await fetch(\"/api/documents/ocr/question\", {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify({\r\n          fileId: activeDocument.id,\r\n          chatId,\r\n          question,\r\n        }),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        const errorData = await response.json();\r\n        throw new Error(errorData.error || \"Failed to process question\");\r\n      }\r\n\r\n      const result = await response.json();\r\n\r\n      // Update the answer in the document's question list\r\n      setProcessedDocuments((prev) =>\r\n        prev.map((doc) => {\r\n          if (doc.id === activeDocument.id) {\r\n            const updatedQuestions = [...(doc.questions || [])];\r\n            const lastQuestionIndex = updatedQuestions.length - 1;\r\n\r\n            if (lastQuestionIndex >= 0) {\r\n              updatedQuestions[lastQuestionIndex].answer = result.answer;\r\n            }\r\n\r\n            return { ...doc, questions: updatedQuestions };\r\n          }\r\n          return doc;\r\n        })\r\n      );\r\n\r\n      // Create a system message to add to chat\r\n      const systemMessage = {\r\n        id: Date.now().toString(),\r\n        role: \"system\" as const,\r\n        content: `Document Q&A:\r\n      \r\nDocument: ${activeDocument.name}\r\nQuestion: ${question}\r\nAnswer: ${result.answer}`,\r\n      };\r\n\r\n      // Append system message to chat\r\n      await append(systemMessage);\r\n\r\n      setQuestion(\"\");\r\n    } catch (error) {\r\n      console.error(\"Error asking question:\", error);\r\n\r\n      // Update the answer with error message\r\n      setProcessedDocuments((prev) =>\r\n        prev.map((doc) => {\r\n          if (doc.id === activeDocument.id) {\r\n            const updatedQuestions = [...(doc.questions || [])];\r\n            const lastQuestionIndex = updatedQuestions.length - 1;\r\n\r\n            if (lastQuestionIndex >= 0) {\r\n              updatedQuestions[lastQuestionIndex].answer =\r\n                `Error: ${error instanceof Error ? error.message : \"Failed to process question\"}`;\r\n            }\r\n\r\n            return { ...doc, questions: updatedQuestions };\r\n          }\r\n          return doc;\r\n        })\r\n      );\r\n    } finally {\r\n      setIsAsking(false);\r\n    }\r\n  };\r\n\r\n  if (!isVisible) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className={`h-full border-l bg-background overflow-auto ${className}`}>\r\n      <div className=\"flex items-center justify-between p-4 border-b\">\r\n        <div className=\"flex items-center\">\r\n          <FileText className=\"h-5 w-5 mr-2\" />\r\n          <h3 className=\"font-semibold\">Document Processor</h3>\r\n        </div>\r\n        <Button\r\n          size=\"sm\"\r\n          variant=\"ghost\"\r\n          className=\"h-8 w-8 p-0\"\r\n          onClick={() =>\r\n            document.dispatchEvent(new CustomEvent(\"toggle-document-processor\"))\r\n          }\r\n        >\r\n          <X className=\"h-4 w-4\" />\r\n          <span className=\"sr-only\">Close</span>\r\n        </Button>\r\n      </div>\r\n\r\n      <div className=\"p-4\">\r\n        <Button\r\n          onClick={handleNewFile}\r\n          className=\"w-full mb-4\"\r\n          disabled={isProcessing}\r\n        >\r\n          <Upload className=\"h-4 w-4 mr-2\" />\r\n          Upload New Document\r\n        </Button>\r\n\r\n        <Tabs defaultValue=\"documents\" className=\"w-full\">\r\n          <TabsList className=\"grid w-full grid-cols-2\">\r\n            <TabsTrigger\r\n              value=\"documents\"\r\n              onClick={() => setActiveTab(\"documents\")}\r\n            >\r\n              Documents ({processedDocuments.length})\r\n            </TabsTrigger>\r\n            <TabsTrigger\r\n              value=\"qa\"\r\n              onClick={() => setActiveTab(\"qa\")}\r\n              disabled={\r\n                !activeDocument || activeDocument.ocrStatus !== \"complete\"\r\n              }\r\n            >\r\n              Q&A\r\n            </TabsTrigger>\r\n          </TabsList>\r\n\r\n          <TabsContent value=\"documents\" className=\"mt-2\">\r\n            <Card>\r\n              <CardHeader className=\"pb-2\">\r\n                <CardTitle className=\"text-base\">Processed Documents</CardTitle>\r\n                <CardDescription>\r\n                  Documents processed with Mistral OCR to extract text\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <ScrollArea className=\"h-[300px] pr-4\">\r\n                  <div className=\"space-y-4\">\r\n                    {processedDocuments.map((doc) => (\r\n                      <Card\r\n                        key={doc.id}\r\n                        className={`overflow-hidden ${activeDocument?.id === doc.id ? \"border-primary\" : \"\"}`}\r\n                      >\r\n                        <CardHeader className=\"p-3\">\r\n                          <div className=\"flex items-start justify-between\">\r\n                            <div className=\"flex items-center space-x-2\">\r\n                              <File className=\"h-4 w-4 text-muted-foreground\" />\r\n                              <div>\r\n                                <h4 className=\"text-sm font-medium leading-none\">\r\n                                  {doc.name}\r\n                                </h4>\r\n                                <p className=\"text-xs text-muted-foreground\">\r\n                                  {doc.type}\r\n                                </p>\r\n                              </div>\r\n                            </div>\r\n                            <Badge\r\n                              variant={\r\n                                doc.ocrStatus === \"complete\"\r\n                                  ? \"default\"\r\n                                  : doc.ocrStatus === \"processing\"\r\n                                    ? \"outline\"\r\n                                    : doc.ocrStatus === \"error\"\r\n                                      ? \"destructive\"\r\n                                      : \"secondary\"\r\n                              }\r\n                            >\r\n                              {doc.ocrStatus}\r\n                            </Badge>\r\n                          </div>\r\n                        </CardHeader>\r\n\r\n                        {doc.ocrStatus === \"processing\" && (\r\n                          <div className=\"px-3 pb-3\">\r\n                            <Progress value={doc.progress} className=\"h-1\" />\r\n                            <p className=\"text-xs text-muted-foreground mt-1\">\r\n                              Processing: {doc.progress}%\r\n                            </p>\r\n                          </div>\r\n                        )}\r\n\r\n                        {doc.ocrStatus === \"complete\" && (\r\n                          <CardFooter className=\"p-3 pt-0\">\r\n                            <Button\r\n                              variant=\"outline\"\r\n                              size=\"sm\"\r\n                              className=\"w-full\"\r\n                              onClick={() => setActiveDocument(doc)}\r\n                            >\r\n                              View Content\r\n                            </Button>\r\n                          </CardFooter>\r\n                        )}\r\n\r\n                        {doc.ocrStatus === \"error\" && (\r\n                          <div className=\"px-3 pb-3\">\r\n                            <div className=\"flex items-center text-destructive text-xs\">\r\n                              <AlertCircle className=\"h-3 w-3 mr-1\" />\r\n                              {doc.errorMessage || \"Processing failed\"}\r\n                            </div>\r\n                          </div>\r\n                        )}\r\n                      </Card>\r\n                    ))}\r\n                  </div>\r\n                </ScrollArea>\r\n              </CardContent>\r\n            </Card>\r\n\r\n            {activeDocument && activeDocument.ocrStatus === \"complete\" && (\r\n              <Card className=\"mt-4\">\r\n                <CardHeader className=\"pb-2\">\r\n                  <CardTitle className=\"text-base\">\r\n                    {activeDocument.name}\r\n                  </CardTitle>\r\n                  <CardDescription>\r\n                    Extracted document content with Mistral OCR\r\n                  </CardDescription>\r\n                </CardHeader>\r\n                <CardContent>\r\n                  <ScrollArea className=\"h-[200px] pr-4\">\r\n                    <div className=\"prose-sm dark:prose-invert\">\r\n                      <UnifiedMarkdown\r\n                        content={\r\n                          activeDocument.ocrText || \"No content extracted\"\r\n                        }\r\n                      />\r\n                    </div>\r\n                  </ScrollArea>\r\n                </CardContent>\r\n                <CardFooter>\r\n                  <Button onClick={() => setActiveTab(\"qa\")} className=\"w-full\">\r\n                    Ask Questions About This Document\r\n                  </Button>\r\n                </CardFooter>\r\n              </Card>\r\n            )}\r\n          </TabsContent>\r\n\r\n          <TabsContent value=\"qa\" className=\"mt-2\">\r\n            {activeDocument && (\r\n              <div className=\"space-y-4\">\r\n                <Card>\r\n                  <CardHeader className=\"pb-2\">\r\n                    <CardTitle className=\"text-base\">\r\n                      Ask About {activeDocument.name}\r\n                    </CardTitle>\r\n                    <CardDescription>\r\n                      Ask questions about the document content using Mistral AI\r\n                    </CardDescription>\r\n                  </CardHeader>\r\n                  <CardContent>\r\n                    <form\r\n                      onSubmit={(e) => {\r\n                        e.preventDefault();\r\n                        askQuestion();\r\n                      }}\r\n                      className=\"flex flex-col gap-4\"\r\n                    >\r\n                      <Textarea\r\n                        value={question}\r\n                        onChange={(e) => setQuestion(e.target.value)}\r\n                        placeholder=\"Ask a question about this document...\"\r\n                        className=\"min-h-[80px]\"\r\n                      />\r\n                      <Button\r\n                        type=\"submit\"\r\n                        disabled={!question.trim() || isAsking || isLoading}\r\n                      >\r\n                        {isAsking ? \"Processing...\" : \"Ask Question\"}\r\n                      </Button>\r\n                    </form>\r\n                  </CardContent>\r\n                </Card>\r\n\r\n                {activeDocument.questions &&\r\n                  activeDocument.questions.length > 0 && (\r\n                    <Card>\r\n                      <CardHeader className=\"pb-2\">\r\n                        <CardTitle className=\"text-base\">\r\n                          Document Q&A History\r\n                        </CardTitle>\r\n                      </CardHeader>\r\n                      <CardContent>\r\n                        <ScrollArea className=\"h-[300px] pr-4\">\r\n                          <div className=\"space-y-4\">\r\n                            {[...activeDocument.questions]\r\n                              .reverse()\r\n                              .map((qa, index) => (\r\n                                <div\r\n                                  key={index}\r\n                                  className=\"border-b pb-4 last:border-0 last:pb-0\"\r\n                                >\r\n                                  <p className=\"font-medium text-sm\">\r\n                                    Q: {qa.question}\r\n                                  </p>\r\n                                  <div className=\"text-sm mt-2\">\r\n                                    <p>A: </p>\r\n                                    <UnifiedMarkdown content={qa.answer} />\r\n                                  </div>\r\n                                </div>\r\n                              ))}\r\n                          </div>\r\n                        </ScrollArea>\r\n                      </CardContent>\r\n                    </Card>\r\n                  )}\r\n              </div>\r\n            )}\r\n          </TabsContent>\r\n        </Tabs>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","\"use client\"\r\n\r\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\r\nimport * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nconst Switch = React.forwardRef<\r\n    React.ElementRef<typeof SwitchPrimitives.Root>,\r\n    React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\r\n>(({ className, ...props }, ref) => (\r\n    <SwitchPrimitives.Root\r\n        className={cn(\r\n            \"peer inline-flex h-[24px] w-[44px] shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\r\n            className\r\n        )}\r\n        {...props}\r\n        ref={ref}\r\n    >\r\n        <SwitchPrimitives.Thumb\r\n            className={cn(\r\n                \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\r\n            )}\r\n        />\r\n    </SwitchPrimitives.Root>\r\n))\r\nSwitch.displayName = SwitchPrimitives.Root.displayName\r\n\r\nexport { Switch }\r\n","\"use client\";\r\n\r\nimport { Message } from \"ai\";\r\nimport {\r\n  Search,\r\n  Link as LinkIcon,\r\n  Loader2,\r\n  X,\r\n  AlertCircle,\r\n} from \"lucide-react\";\r\nimport { useState } from \"react\";\r\n\r\nimport { Alert, AlertDescription, AlertTitle } from \"@/components/ui/alert\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n  Card,\r\n  CardHeader,\r\n  CardTitle,\r\n  CardDescription,\r\n  CardContent,\r\n} from \"@/components/ui/card\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport { Label } from \"@/components/ui/label\";\r\nimport { Progress } from \"@/components/ui/progress\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { Switch } from \"@/components/ui/switch\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\n\r\nimport { UnifiedMarkdown } from \"./UnifiedMarkdown\";\r\n\r\ninterface ScrapingResult {\r\n  url: string;\r\n  title: string;\r\n  content: string;\r\n  timestamp: number;\r\n  metadata?: {\r\n    status: number;\r\n    contentType: string;\r\n    immigrationData?: {\r\n      documentType?: string;\r\n      sourceType?: string;\r\n      credibilityScore?: number;\r\n      countries?: string[];\r\n      visaTypes?: string[];\r\n      requirements?: string[];\r\n      keyPoints?: string[];\r\n    };\r\n  };\r\n}\r\n\r\ninterface UnifiedWebScraperProps {\r\n  chatId: string;\r\n  append: (message: Message | Message[]) => Promise<void>;\r\n  isLoading: boolean;\r\n  isVisible: boolean;\r\n  className?: string;\r\n}\r\n\r\nexport function UnifiedWebScraper({\r\n  chatId,\r\n  append,\r\n  isLoading,\r\n  isVisible,\r\n  className,\r\n}: UnifiedWebScraperProps) {\r\n  const [url, setUrl] = useState(\"\");\r\n  const [bulkUrls, setBulkUrls] = useState(\"\");\r\n  const [isScraping, setIsScraping] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [scrapingResults, setScrapingResults] = useState<ScrapingResult[]>([]);\r\n  const [extractImmigrationData, setExtractImmigrationData] = useState(true);\r\n  const [progress, setProgress] = useState(0);\r\n  const [activeView, setActiveView] = useState<\"form\" | \"results\">(\"form\");\r\n\r\n  const handleSingleScrape = async () => {\r\n    if (!url.trim()) {\r\n      setError(\"Please enter a URL to scrape\");\r\n      return;\r\n    }\r\n\r\n    setIsScraping(true);\r\n    setError(null);\r\n    setProgress(0);\r\n\r\n    try {\r\n      // Simulate progress updates\r\n      const progressInterval = setInterval(() => {\r\n        setProgress((prev) => {\r\n          const newProgress = prev + Math.random() * 15;\r\n          return newProgress > 90 ? 90 : newProgress;\r\n        });\r\n      }, 500);\r\n\r\n      // In a real implementation, this would be an API call to your backend\r\n      // For now, we'll simulate the API response\r\n      await new Promise((resolve) => setTimeout(resolve, 3000));\r\n\r\n      clearInterval(progressInterval);\r\n      setProgress(100);\r\n\r\n      // Mock successful scrape\r\n      const newResult: ScrapingResult = {\r\n        url,\r\n        title: `Content from ${url}`,\r\n        content: `This is scraped content from ${url}. In a real implementation, this would contain actual content from the webpage.`,\r\n        timestamp: Date.now(),\r\n        metadata: {\r\n          status: 200,\r\n          contentType: \"text/html\",\r\n          immigrationData: extractImmigrationData\r\n            ? {\r\n                documentType: \"Government Website\",\r\n                sourceType: \"Official\",\r\n                credibilityScore: 95,\r\n                countries: [\"United States\", \"Canada\"],\r\n                visaTypes: [\"H-1B\", \"EB-5\", \"Student Visa\"],\r\n                requirements: [\r\n                  \"Valid passport\",\r\n                  \"Completed application form\",\r\n                  \"Application fee payment\",\r\n                  \"Supporting documents\",\r\n                ],\r\n                keyPoints: [\r\n                  \"Processing time: 3-6 months\",\r\n                  \"Fees vary by visa type\",\r\n                  \"Medical examination may be required\",\r\n                  \"Interviews are scheduled after application review\",\r\n                ],\r\n              }\r\n            : undefined,\r\n        },\r\n      };\r\n\r\n      setScrapingResults((prev) => [newResult, ...prev]);\r\n      setActiveView(\"results\");\r\n\r\n      // Create a message to add to the chat\r\n      const message: Message = {\r\n        id: `scrape-${Date.now()}`,\r\n        role: \"assistant\",\r\n        content: `### Web Scraping Results for ${url}\r\n\r\nI've analyzed the content from this URL and found the following information:\r\n\r\n${\r\n  extractImmigrationData\r\n    ? `\r\n#### Immigration Data\r\n- Document Type: ${newResult.metadata?.immigrationData?.documentType}\r\n- Source Type: ${newResult.metadata?.immigrationData?.sourceType}\r\n- Credibility Score: ${newResult.metadata?.immigrationData?.credibilityScore}/100\r\n- Countries: ${newResult.metadata?.immigrationData?.countries?.join(\", \")}\r\n- Visa Types: ${newResult.metadata?.immigrationData?.visaTypes?.join(\", \")}\r\n\r\n#### Key Requirements\r\n${newResult.metadata?.immigrationData?.requirements?.map((req) => `- ${req}`).join(\"\\n\")}\r\n\r\n#### Key Points\r\n${newResult.metadata?.immigrationData?.keyPoints?.map((point) => `- ${point}`).join(\"\\n\")}\r\n`\r\n    : newResult.content\r\n}\r\n\r\nWould you like me to extract specific information from this content?`,\r\n      };\r\n\r\n      await append(message);\r\n      setUrl(\"\");\r\n    } catch (err: any) {\r\n      setError(err.message || \"Failed to scrape URL\");\r\n    } finally {\r\n      setIsScraping(false);\r\n    }\r\n  };\r\n\r\n  const handleBulkScrape = async () => {\r\n    if (!bulkUrls.trim()) {\r\n      setError(\"Please enter URLs to scrape\");\r\n      return;\r\n    }\r\n\r\n    const urls = bulkUrls\r\n      .split(/[\\n,]/)\r\n      .map((url) => url.trim())\r\n      .filter((url) => url.length > 0);\r\n\r\n    if (urls.length === 0) {\r\n      setError(\"No valid URLs found\");\r\n      return;\r\n    }\r\n\r\n    setIsScraping(true);\r\n    setError(null);\r\n    setProgress(0);\r\n\r\n    try {\r\n      let completedCount = 0;\r\n      const results: ScrapingResult[] = [];\r\n\r\n      for (const url of urls) {\r\n        // Update progress\r\n        setProgress((completedCount / urls.length) * 100);\r\n\r\n        // Simulate API call for each URL\r\n        await new Promise((resolve) => setTimeout(resolve, 1000));\r\n\r\n        // Mock successful scrape\r\n        results.push({\r\n          url,\r\n          title: `Content from ${url}`,\r\n          content: `This is scraped content from ${url}. In a real implementation, this would contain actual content from the webpage.`,\r\n          timestamp: Date.now(),\r\n          metadata: {\r\n            status: 200,\r\n            contentType: \"text/html\",\r\n            immigrationData: extractImmigrationData\r\n              ? {\r\n                  documentType: \"Immigration Resource\",\r\n                  sourceType: \"Information Portal\",\r\n                  credibilityScore: 85,\r\n                  countries: [\"United States\", \"Canada\"],\r\n                  visaTypes: [\"Work Visa\", \"Student Visa\"],\r\n                  requirements: [\r\n                    \"Valid passport\",\r\n                    \"Completed application form\",\r\n                    \"Application fee payment\",\r\n                  ],\r\n                  keyPoints: [\r\n                    \"Processing time varies by visa type\",\r\n                    \"Fees are non-refundable\",\r\n                    \"Online application preferred\",\r\n                  ],\r\n                }\r\n              : undefined,\r\n          },\r\n        });\r\n\r\n        completedCount++;\r\n      }\r\n\r\n      setProgress(100);\r\n      setScrapingResults((prev) => [...results, ...prev]);\r\n      setActiveView(\"results\");\r\n\r\n      // Create a message to add to the chat\r\n      const message: Message = {\r\n        id: `bulk-scrape-${Date.now()}`,\r\n        role: \"assistant\",\r\n        content: `### Bulk Web Scraping Results\r\n\r\nI've analyzed content from ${urls.length} URLs and found the following information:\r\n\r\n${results\r\n  .map(\r\n    (result, index) => `\r\n#### URL ${index + 1}: ${result.url}\r\n${\r\n  extractImmigrationData && result.metadata?.immigrationData\r\n    ? `\r\n- Document Type: ${result.metadata.immigrationData.documentType}\r\n- Source Type: ${result.metadata.immigrationData.sourceType}\r\n- Credibility Score: ${result.metadata.immigrationData.credibilityScore}/100\r\n- Visa Types: ${result.metadata.immigrationData.visaTypes?.join(\", \")}\r\n`\r\n    : `- Content length: ${result.content.length} characters`\r\n}\r\n`\r\n  )\r\n  .join(\"\\n\")}\r\n\r\nWould you like me to analyze this information further?`,\r\n      };\r\n\r\n      await append(message);\r\n      setBulkUrls(\"\");\r\n    } catch (err: any) {\r\n      setError(err.message || \"Failed to scrape URLs\");\r\n    } finally {\r\n      setIsScraping(false);\r\n    }\r\n  };\r\n\r\n  if (!isVisible) {\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <div className={`h-full border-l bg-background overflow-auto ${className}`}>\r\n      <div className=\"flex items-center justify-between p-4 border-b\">\r\n        <div className=\"flex items-center\">\r\n          <Search className=\"h-5 w-5 mr-2\" />\r\n          <h3 className=\"font-semibold\">Web Scraper</h3>\r\n        </div>\r\n        <div className=\"flex gap-2\">\r\n          <Button\r\n            size=\"sm\"\r\n            variant=\"outline\"\r\n            onClick={() =>\r\n              setActiveView(activeView === \"form\" ? \"results\" : \"form\")\r\n            }\r\n          >\r\n            {activeView === \"form\" ? \"View Results\" : \"New Scrape\"}\r\n          </Button>\r\n          <Button\r\n            size=\"sm\"\r\n            variant=\"ghost\"\r\n            className=\"h-8 w-8 p-0\"\r\n            onClick={() =>\r\n              document.dispatchEvent(new CustomEvent(\"toggle-web-scraper\"))\r\n            }\r\n          >\r\n            <X className=\"h-4 w-4\" />\r\n            <span className=\"sr-only\">Close</span>\r\n          </Button>\r\n        </div>\r\n      </div>\r\n\r\n      {activeView === \"form\" ? (\r\n        <Card>\r\n          <CardHeader>\r\n            <CardTitle className=\"text-lg\">Extract Web Content</CardTitle>\r\n            <CardDescription>\r\n              Scrape websites for immigration information\r\n            </CardDescription>\r\n          </CardHeader>\r\n          <CardContent className=\"space-y-4\">\r\n            <div className=\"space-y-4\">\r\n              <div className=\"space-y-2\">\r\n                <Label htmlFor=\"url\">URL to Scrape</Label>\r\n                <div className=\"flex gap-2\">\r\n                  <Input\r\n                    id=\"url\"\r\n                    type=\"url\"\r\n                    placeholder=\"https://example.com/immigration-info\"\r\n                    value={url}\r\n                    onChange={(e) => setUrl(e.target.value)}\r\n                    disabled={isScraping}\r\n                  />\r\n                  <Button\r\n                    onClick={handleSingleScrape}\r\n                    disabled={isScraping || !url.trim()}\r\n                  >\r\n                    {isScraping ? (\r\n                      <Loader2 className=\"h-4 w-4 animate-spin\" />\r\n                    ) : (\r\n                      \"Scrape\"\r\n                    )}\r\n                  </Button>\r\n                </div>\r\n              </div>\r\n\r\n              <div className=\"pt-2 border-t\">\r\n                <Label htmlFor=\"bulk-urls\" className=\"block mb-2\">\r\n                  Bulk URLs (one per line)\r\n                </Label>\r\n                <Textarea\r\n                  id=\"bulk-urls\"\r\n                  placeholder=\"https://example1.com/immigration-info&#10;https://example2.com/visa-info\"\r\n                  value={bulkUrls}\r\n                  onChange={(e) => setBulkUrls(e.target.value)}\r\n                  disabled={isScraping}\r\n                  rows={5}\r\n                  className=\"mb-2\"\r\n                />\r\n                <Button\r\n                  onClick={handleBulkScrape}\r\n                  disabled={isScraping || !bulkUrls.trim()}\r\n                  className=\"w-full\"\r\n                >\r\n                  {isScraping ? (\r\n                    <Loader2 className=\"h-4 w-4 animate-spin mr-2\" />\r\n                  ) : null}\r\n                  {isScraping ? \"Processing...\" : \"Scrape All URLs\"}\r\n                </Button>\r\n              </div>\r\n\r\n              <div className=\"flex items-center space-x-2 pt-2\">\r\n                <Switch\r\n                  id=\"extract-data\"\r\n                  checked={extractImmigrationData}\r\n                  onCheckedChange={setExtractImmigrationData}\r\n                  disabled={isScraping}\r\n                />\r\n                <Label htmlFor=\"extract-data\">Extract immigration data</Label>\r\n              </div>\r\n            </div>\r\n\r\n            {isScraping && (\r\n              <div className=\"space-y-2\">\r\n                <div className=\"flex justify-between text-sm\">\r\n                  <span>Scraping in progress...</span>\r\n                  <span>{Math.round(progress)}%</span>\r\n                </div>\r\n                <Progress value={progress} className=\"h-2\" />\r\n              </div>\r\n            )}\r\n\r\n            {error && (\r\n              <Alert variant=\"destructive\">\r\n                <AlertCircle className=\"h-4 w-4\" />\r\n                <AlertTitle>Error</AlertTitle>\r\n                <AlertDescription>{error}</AlertDescription>\r\n              </Alert>\r\n            )}\r\n          </CardContent>\r\n        </Card>\r\n      ) : (\r\n        <div className=\"space-y-4\">\r\n          <h3 className=\"font-medium\">\r\n            Scraping Results ({scrapingResults.length})\r\n          </h3>\r\n\r\n          {scrapingResults.length === 0 ? (\r\n            <div className=\"text-center p-4 text-muted-foreground\">\r\n              No results yet. Start scraping to see content here.\r\n            </div>\r\n          ) : (\r\n            <ScrollArea className=\"h-[calc(100vh-120px)]\">\r\n              <div className=\"space-y-4 pr-4\">\r\n                {scrapingResults.map((result, index) => (\r\n                  <Card\r\n                    key={`${result.url}-${index}`}\r\n                    className=\"overflow-hidden\"\r\n                  >\r\n                    <CardHeader className=\"pb-2\">\r\n                      <CardTitle className=\"text-base flex items-center gap-2\">\r\n                        <LinkIcon className=\"h-4 w-4\" />\r\n                        <a\r\n                          href={result.url}\r\n                          target=\"_blank\"\r\n                          rel=\"noopener noreferrer\"\r\n                          className=\"text-primary hover:underline overflow-hidden text-ellipsis\"\r\n                        >\r\n                          {result.url}\r\n                        </a>\r\n                      </CardTitle>\r\n                      <div className=\"flex flex-wrap gap-1 mt-1\">\r\n                        <Badge variant=\"outline\" className=\"text-xs\">\r\n                          {new Date(result.timestamp).toLocaleString()}\r\n                        </Badge>\r\n                        {result.metadata?.immigrationData && (\r\n                          <Badge variant=\"secondary\" className=\"text-xs\">\r\n                            Score:{\" \"}\r\n                            {result.metadata.immigrationData.credibilityScore}%\r\n                          </Badge>\r\n                        )}\r\n                      </div>\r\n                    </CardHeader>\r\n                    <CardContent className=\"text-sm\">\r\n                      {result.metadata?.immigrationData ? (\r\n                        <div className=\"space-y-2\">\r\n                          <div>\r\n                            <span className=\"font-medium\">Type:</span>{\" \"}\r\n                            {result.metadata.immigrationData.documentType} (\r\n                            {result.metadata.immigrationData.sourceType})\r\n                          </div>\r\n                          {result.metadata.immigrationData.countries && (\r\n                            <div>\r\n                              <span className=\"font-medium\">Countries:</span>{\" \"}\r\n                              {result.metadata.immigrationData.countries.join(\r\n                                \", \"\r\n                              )}\r\n                            </div>\r\n                          )}\r\n                          {result.metadata.immigrationData.visaTypes && (\r\n                            <div>\r\n                              <span className=\"font-medium\">Visa Types:</span>{\" \"}\r\n                              {result.metadata.immigrationData.visaTypes.join(\r\n                                \", \"\r\n                              )}\r\n                            </div>\r\n                          )}\r\n                          {result.metadata.immigrationData.requirements && (\r\n                            <div>\r\n                              <span className=\"font-medium\">Requirements:</span>\r\n                              <ul className=\"list-disc pl-5\">\r\n                                {result.metadata.immigrationData.requirements.map(\r\n                                  (req, i) => (\r\n                                    <li key={i}>{req}</li>\r\n                                  )\r\n                                )}\r\n                              </ul>\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n                      ) : (\r\n                        <UnifiedMarkdown\r\n                          content={result.content.substring(0, 200) + \"...\"}\r\n                        />\r\n                      )}\r\n                      <Button\r\n                        variant=\"link\"\r\n                        className=\"p-0 h-auto text-xs mt-2\"\r\n                        onClick={() => {\r\n                          // Add this result to the chat\r\n                          const message: Message = {\r\n                            id: `result-${Date.now()}`,\r\n                            role: \"assistant\",\r\n                            content: `I've added the content from ${result.url} to our conversation. Would you like me to summarize the key points?`,\r\n                          };\r\n                          append(message);\r\n                        }}\r\n                      >\r\n                        Add to chat\r\n                      </Button>\r\n                    </CardContent>\r\n                  </Card>\r\n                ))}\r\n              </div>\r\n            </ScrollArea>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","\"use client\"\r\n\r\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\r\nimport * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Label({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\r\n  return (\r\n    <LabelPrimitive.Root\r\n      data-slot=\"label\"\r\n      className={cn(\r\n        \"flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Label }\r\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name BarChartHorizontal\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMyAzdjE4aDE4IiAvPgogIDxwYXRoIGQ9Ik03IDE2aDgiIC8+CiAgPHBhdGggZD0iTTcgMTFoMTIiIC8+CiAgPHBhdGggZD0iTTcgNmgzIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/bar-chart-horizontal\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst BarChartHorizontal = createLucideIcon('BarChartHorizontal', [\n  ['path', { d: 'M3 3v18h18', key: '1s2lah' }],\n  ['path', { d: 'M7 16h8', key: 'srdodz' }],\n  ['path', { d: 'M7 11h12', key: '127s9w' }],\n  ['path', { d: 'M7 6h3', key: 'w9rmul' }],\n]);\n\nexport default BarChartHorizontal;\n","\"use client\";\r\n\r\nimport { useState, useEffect, useRef, useCallback } from \"react\";\r\n\r\nimport { Locale, defaultLocale } from \"@/i18n/i18n\";\r\n\r\n// --- Interfaces for Speech Recognition API results --- START\r\ninterface SpeechRecognitionEvent {\r\n  results: SpeechRecognitionResultList;\r\n  resultIndex: number;\r\n}\r\n\r\ninterface SpeechRecognitionResultList {\r\n  [index: number]: SpeechRecognitionResult;\r\n  length: number;\r\n}\r\n\r\ninterface SpeechRecognitionResult {\r\n  isFinal: boolean;\r\n  [index: number]: SpeechRecognitionAlternative;\r\n  length: number;\r\n}\r\n\r\ninterface SpeechRecognitionAlternative {\r\n  transcript: string;\r\n  confidence: number;\r\n}\r\n// --- Interfaces for Speech Recognition API results --- END\r\n\r\n// Define the expected type for the SpeechRecognition constructor\r\ninterface SpeechRecognitionStatic {\r\n  new (): SpeechRecognition;\r\n}\r\n\r\n// Define the expected type for a SpeechRecognition instance\r\ninterface SpeechRecognition {\r\n  continuous: boolean;\r\n  interimResults: boolean;\r\n  lang: string;\r\n  onresult: ((event: any) => void) | null;\r\n  onerror: ((event: any) => void) | null;\r\n  onend: (() => void) | null;\r\n  start: () => void;\r\n  stop: () => void;\r\n}\r\n\r\ninterface UseSpeechRecognitionOptions {\r\n  onResult: (transcript: string) => void;\r\n  onError?: (error: any) => void;\r\n  onEnd?: () => void;\r\n  locale?: string; // Accept locale to determine recognition language\r\n}\r\n\r\n// Map locale to SpeechRecognition language code\r\nconst getLanguageCodeForLocale = (locale: string = defaultLocale): string => {\r\n  const localeMap: Record<string, string> = {\r\n    en: \"en-US\",\r\n    ar: \"ar-SA\",\r\n    es: \"es-ES\",\r\n    fr: \"fr-FR\",\r\n    // Add more mappings as needed\r\n  };\r\n\r\n  return localeMap[locale] || \"en-US\"; // Default to en-US if no mapping found\r\n};\r\n\r\nexport const useSpeechRecognition = ({\r\n  onResult,\r\n  onError,\r\n  onEnd,\r\n  locale = defaultLocale,\r\n}: UseSpeechRecognitionOptions) => {\r\n  const [isRecording, setIsRecording] = useState(false);\r\n  const [isAvailable, setIsAvailable] = useState(false);\r\n  const recognitionRef = useRef<SpeechRecognition | null>(null);\r\n\r\n  // Get the proper language code for the current locale\r\n  const langCode = getLanguageCodeForLocale(locale);\r\n\r\n  useEffect(() => {\r\n    // Check for vendor-prefixed and standard API\r\n    const SpeechRecognitionAPI =\r\n      (window as any).SpeechRecognition ||\r\n      (window as any).webkitSpeechRecognition;\r\n\r\n    if (typeof SpeechRecognitionAPI !== \"undefined\") {\r\n      setIsAvailable(true);\r\n      try {\r\n        // Explicitly cast to the constructor type\r\n        recognitionRef.current =\r\n          new (SpeechRecognitionAPI as SpeechRecognitionStatic)();\r\n      } catch (error) {\r\n        console.error(\"Failed to initialize SpeechRecognition:\", error);\r\n        setIsAvailable(false);\r\n        return;\r\n      }\r\n\r\n      // Configure the instance\r\n      if (recognitionRef.current) {\r\n        recognitionRef.current.continuous = true;\r\n        recognitionRef.current.interimResults = true;\r\n        recognitionRef.current.lang = langCode;\r\n\r\n        recognitionRef.current.onresult = (event: any) => {\r\n          let finalTranscript = \"\";\r\n          let interimTranscript = \"\";\r\n          const results = (event as SpeechRecognitionEvent).results;\r\n\r\n          for (\r\n            let i = (event as SpeechRecognitionEvent).resultIndex;\r\n            i < results.length;\r\n            ++i\r\n          ) {\r\n            if (results[i].isFinal) {\r\n              finalTranscript += results[i][0].transcript + \" \";\r\n            } else {\r\n              interimTranscript += results[i][0].transcript;\r\n            }\r\n          }\r\n          const transcript = finalTranscript.trim() || interimTranscript.trim();\r\n          if (transcript) {\r\n            onResult(transcript);\r\n          }\r\n        };\r\n\r\n        recognitionRef.current.onerror = (event: any) => {\r\n          const error = event.error || \"unknown_error\";\r\n          console.error(\"Speech recognition error:\", error);\r\n          if (onError) {\r\n            onError(error);\r\n          }\r\n          // Wrap stopRecording in useCallback if it depends on state/props\r\n          // that might change, though here it likely doesn't need it.\r\n          const stop = () => {\r\n            if (recognitionRef.current && isRecording) {\r\n              try {\r\n                recognitionRef.current.stop();\r\n              } catch (e) {\r\n                console.error(\"Stop error\", e);\r\n                setIsRecording(false);\r\n              }\r\n            }\r\n          };\r\n\r\n          if (error === \"no-speech\" || error === \"network\") {\r\n            stop();\r\n          } else if (\r\n            error === \"not-allowed\" ||\r\n            error === \"service-not-allowed\"\r\n          ) {\r\n            setIsAvailable(false);\r\n            stop();\r\n          }\r\n        };\r\n\r\n        recognitionRef.current.onend = () => {\r\n          if (onEnd) {\r\n            onEnd();\r\n          }\r\n          setIsRecording(false);\r\n        };\r\n      }\r\n    } else {\r\n      console.warn(\"Speech Recognition API not available in this browser.\");\r\n      setIsAvailable(false);\r\n    }\r\n\r\n    // Cleanup function\r\n    return () => {\r\n      if (recognitionRef.current) {\r\n        recognitionRef.current.onresult = null;\r\n        recognitionRef.current.onerror = null;\r\n        recognitionRef.current.onend = null;\r\n        try {\r\n          recognitionRef.current.stop();\r\n        } catch (e) {\r\n          /* Ignore error if already stopped */\r\n        }\r\n      }\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [langCode]); // Include langCode as a dependency to recreate recognition when language changes\r\n\r\n  const startRecording = useCallback(() => {\r\n    if (recognitionRef.current && isAvailable && !isRecording) {\r\n      try {\r\n        recognitionRef.current.start();\r\n        setIsRecording(true);\r\n      } catch (error) {\r\n        console.error(\"Error starting speech recognition:\", error);\r\n        if (onError) onError(error);\r\n        setIsRecording(false);\r\n      }\r\n    } else if (!isAvailable) {\r\n      console.warn(\"Speech recognition not available or not permitted.\");\r\n      if (onError) onError(\"not-available\");\r\n    }\r\n  }, [isRecording, isAvailable, onError]);\r\n\r\n  const stopRecording = useCallback(() => {\r\n    if (recognitionRef.current && isRecording) {\r\n      try {\r\n        recognitionRef.current.stop();\r\n      } catch (error) {\r\n        console.error(\"Error stopping speech recognition:\", error);\r\n        // Manually update state if stop fails unexpectedly\r\n        setIsRecording(false);\r\n      }\r\n      // Let the onend handler set isRecording = false reliably\r\n    }\r\n  }, [isRecording]);\r\n\r\n  return { isRecording, startRecording, stopRecording, isAvailable };\r\n};\r\n","\"use client\";\r\n\r\nimport { X } from \"lucide-react\";\r\nimport React from \"react\";\r\n\r\nimport { artifactDefinitions } from \"@/artifacts\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { useArtifact, useResetArtifact } from \"@/hooks/use-artifact\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nexport function UnifiedArtifact() {\r\n  const { artifact: artifactData } = useArtifact();\r\n  const resetArtifact = useResetArtifact();\r\n\r\n  const handleClose = () => {\r\n    resetArtifact();\r\n  };\r\n\r\n  const definition = artifactDefinitions.find(\r\n    (def) => def.kind === artifactData.kind\r\n  );\r\n\r\n  const ArtifactComponent = definition?.component;\r\n\r\n  return (\r\n    <div\r\n      className={cn(\r\n        \"absolute right-0 top-0 bottom-0 z-10 w-full md:w-[30vw] bg-background border-l shadow-lg\",\r\n        \"h-[calc(100vh-4rem)]\",\r\n        \"mt-16\"\r\n      )}\r\n    >\r\n      <div className=\"flex flex-col h-full\">\r\n        <div className=\"flex items-center justify-between p-4 border-b flex-shrink-0\">\r\n          <div className=\"text-lg font-semibold\">\r\n            {artifactData.title || definition?.kind || \"Artifact\"}\r\n            {artifactData.status === \"streaming\" && (\r\n              <span className=\"text-sm text-muted-foreground ml-2\">\r\n                (Streaming...)\r\n              </span>\r\n            )}\r\n          </div>\r\n          <Button\r\n            variant=\"ghost\"\r\n            size=\"icon\"\r\n            onClick={handleClose}\r\n            className=\"h-8 w-8\"\r\n          >\r\n            <X className=\"h-4 w-4\" />\r\n          </Button>\r\n        </div>\r\n\r\n        <div className=\"flex-1 overflow-hidden\">\r\n          <ScrollArea className=\"h-full\">\r\n            <div className=\"p-4\">\r\n              {ArtifactComponent ? (\r\n                <ArtifactComponent artifact={artifactData} />\r\n              ) : (\r\n                <div className=\"flex items-center justify-center h-full\">\r\n                  <p className=\"text-muted-foreground\">\r\n                    {artifactData.kind\r\n                      ? `No renderer for ${artifactData.kind} artifact.`\r\n                      : \"No artifact selected.\"}\r\n                  </p>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </ScrollArea>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name MoreVertical\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxIiAvPgogIDxjaXJjbGUgY3g9IjEyIiBjeT0iNSIgcj0iMSIgLz4KICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjE5IiByPSIxIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/more-vertical\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst MoreVertical = createLucideIcon('MoreVertical', [\n  ['circle', { cx: '12', cy: '12', r: '1', key: '41hilf' }],\n  ['circle', { cx: '12', cy: '5', r: '1', key: 'gxeob9' }],\n  ['circle', { cx: '12', cy: '19', r: '1', key: 'lyex9k' }],\n]);\n\nexport default MoreVertical;\n","'use client'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\ninterface UnifiedTypingIndicatorProps {\r\n    className?: string\r\n}\r\n\r\nexport function UnifiedTypingIndicator({ className }: UnifiedTypingIndicatorProps) {\r\n    return (\r\n        <div className={cn('flex items-center gap-3', className)}>\r\n            <div className=\"flex h-8 w-8 shrink-0 select-none items-center justify-center rounded-md border bg-background shadow\">\r\n                <span className=\"text-xs\">AI</span>\r\n            </div>\r\n            <div className=\"flex gap-1 items-center rounded-lg bg-muted px-4 py-2.5 text-sm\">\r\n                <div className=\"flex space-x-1\">\r\n                    <div className=\"h-2 w-2 rounded-full bg-foreground/50 animate-bounce [animation-delay:-0.3s]\" />\r\n                    <div className=\"h-2 w-2 rounded-full bg-foreground/50 animate-bounce [animation-delay:-0.15s]\" />\r\n                    <div className=\"h-2 w-2 rounded-full bg-foreground/50 animate-bounce\" />\r\n                </div>\r\n                <span className=\"ml-2 text-muted-foreground text-xs\">Thinking...</span>\r\n            </div>\r\n        </div>\r\n    )\r\n} ","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Earth\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEuNTQgMTVIMTdhMiAyIDAgMCAwLTIgMnY0LjU0IiAvPgogIDxwYXRoIGQ9Ik03IDMuMzRWNWEzIDMgMCAwIDAgMyAzdjBhMiAyIDAgMCAxIDIgMnYwYzAgMS4xLjkgMiAyIDJ2MGEyIDIgMCAwIDAgMi0ydjBjMC0xLjEuOS0yIDItMmgzLjE3IiAvPgogIDxwYXRoIGQ9Ik0xMSAyMS45NVYxOGEyIDIgMCAwIDAtMi0ydjBhMiAyIDAgMCAxLTItMnYtMWEyIDIgMCAwIDAtMi0ySDIuMDUiIC8+CiAgPGNpcmNsZSBjeD0iMTIiIGN5PSIxMiIgcj0iMTAiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/earth\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Earth = createLucideIcon('Earth', [\n  ['path', { d: 'M21.54 15H17a2 2 0 0 0-2 2v4.54', key: '1djwo0' }],\n  [\n    'path',\n    {\n      d: 'M7 3.34V5a3 3 0 0 0 3 3v0a2 2 0 0 1 2 2v0c0 1.1.9 2 2 2v0a2 2 0 0 0 2-2v0c0-1.1.9-2 2-2h3.17',\n      key: '1fi5u6',\n    },\n  ],\n  [\n    'path',\n    { d: 'M11 21.95V18a2 2 0 0 0-2-2v0a2 2 0 0 1-2-2v-1a2 2 0 0 0-2-2H2.05', key: 'xsiumc' },\n  ],\n  ['circle', { cx: '12', cy: '12', r: '10', key: '1mglay' }],\n]);\n\nexport default Earth;\n","import { FileText, Code, Table } from \"lucide-react\"; // Import icons and Table icon\r\nimport React from \"react\"; // Import React\r\n\r\nimport { DataStreamDelta, StreamDataPoint } from \"@/types\"; // Import data point type\r\n\r\nimport { CodeArtifact } from \"./code/CodeArtifact\";\r\nimport { SheetArtifact } from \"./sheet/SheetArtifact\"; // Import SheetArtifact\r\nimport { TextArtifact } from \"./text/TextArtifact\";\r\n\r\n// Define Artifact Kinds (add more as needed)\r\nexport enum ArtifactKind {\r\n  Text = \"text\",\r\n  Code = \"code\",\r\n  Sheet = \"sheet\",\r\n  Image = \"image\",\r\n}\r\n\r\n// Placeholder for Artifact Data Structure (adapt based on specific needs)\r\nexport interface BaseArtifactData {\r\n  kind: ArtifactKind | null;\r\n  status: \"idle\" | \"streaming\" | \"error\";\r\n  title: string;\r\n  content: any; // Type based on kind (string, object, etc.)\r\n  documentId?: string;\r\n  metadata?: Record<string, any>; // For additional info\r\n}\r\n\r\n// Placeholder initial data\r\nexport const initialArtifactData: BaseArtifactData = {\r\n  kind: null,\r\n  status: \"idle\",\r\n  title: \"\",\r\n  content: null, // Initialize content as null or specific empty state\r\n};\r\n\r\n// Define the structure for an artifact definition\r\nexport interface ArtifactDefinition {\r\n  kind: ArtifactKind;\r\n  icon: React.ComponentType<{ className?: string }>; // Example: Lucide icon\r\n  component: React.ComponentType<{ artifact: BaseArtifactData }>; // Component to render the artifact\r\n  onStreamPart?: (params: {\r\n    streamPart: DataStreamDelta; // Updated to use centralized type\r\n    setArtifact: (\r\n      updater: (prev: BaseArtifactData) => BaseArtifactData\r\n    ) => void; // Updated type\r\n    setMetadata?: (\r\n      updater: (prev: Record<string, any>) => Record<string, any>\r\n    ) => void; // Updated type\r\n  }) => void; // Handler for specific stream deltas\r\n}\r\n\r\n// Placeholder definitions array (Populate with actual definitions)\r\n// TODO: Import icons and components\r\n// import { FileText, Code, Sheet, Image } from 'lucide-react';\r\n// import { TextArtifact } from './text/TextArtifact';\r\n// ... import other artifact components\r\n\r\nexport const artifactDefinitions: ArtifactDefinition[] = [\r\n  {\r\n    kind: ArtifactKind.Text,\r\n    icon: FileText,\r\n    component: TextArtifact,\r\n    onStreamPart: ({ streamPart, setArtifact }) => {\r\n      // Handle text-specific deltas\r\n      if (streamPart.type === \"text-delta\") {\r\n        setArtifact((draft) => ({\r\n          ...draft,\r\n          // Ensure content is initialized as string\r\n          content:\r\n            (typeof draft.content === \"string\" ? draft.content : \"\") +\r\n            streamPart.content,\r\n          status: \"streaming\",\r\n        }));\r\n      }\r\n      // TODO: Add handlers for common deltas like title, finish if needed here\r\n      // Or handle them centrally in UnifiedChatContainer effect\r\n    },\r\n  },\r\n  {\r\n    kind: ArtifactKind.Code,\r\n    icon: Code,\r\n    component: CodeArtifact,\r\n    onStreamPart: ({ streamPart, setArtifact }) => {\r\n      // Handle code-specific deltas\r\n      if (streamPart.type === \"code-delta\") {\r\n        setArtifact((draft) => ({\r\n          ...draft,\r\n          // Ensure content is initialized as string before appending\r\n          content:\r\n            (typeof draft.content === \"string\" ? draft.content : \"\") +\r\n            streamPart.content,\r\n          status: \"streaming\",\r\n        }));\r\n      }\r\n      // Handle metadata through custom handlers or from separate metadata object\r\n      // since 'code-metadata' is not in the allowed DataStreamDelta types\r\n    },\r\n  },\r\n  {\r\n    kind: ArtifactKind.Sheet,\r\n    icon: Table, // Use Table icon\r\n    component: SheetArtifact,\r\n    onStreamPart: ({ streamPart, setArtifact }) => {\r\n      setArtifact((draft) => {\r\n        // Initialize content for sheet if it's the first relevant delta\r\n        let currentContent = draft.content;\r\n        if (\r\n          draft.kind === ArtifactKind.Sheet &&\r\n          (currentContent === null ||\r\n            typeof currentContent !== \"object\" ||\r\n            !currentContent.rows ||\r\n            !currentContent.columns)\r\n        ) {\r\n          currentContent = { columns: [], rows: [] };\r\n        }\r\n\r\n        if (streamPart.type === \"sheet-delta\") {\r\n          // Handle the sheet delta content appropriately\r\n          // For example, if it's column data:\r\n          if (\r\n            typeof streamPart.content === \"object\" &&\r\n            Array.isArray(streamPart.content)\r\n          ) {\r\n            return {\r\n              ...draft,\r\n              content: {\r\n                ...currentContent,\r\n                rows: [...(currentContent.rows || []), ...streamPart.content],\r\n              },\r\n              status: \"streaming\",\r\n            };\r\n          }\r\n          return draft;\r\n        }\r\n        return draft; // Return unchanged draft if delta type doesn't match\r\n      });\r\n    },\r\n  },\r\n  // TODO: Add definitions for Image...\r\n];\r\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Archive\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cmVjdCB3aWR0aD0iMjAiIGhlaWdodD0iNSIgeD0iMiIgeT0iMyIgcng9IjEiIC8+CiAgPHBhdGggZD0iTTQgOHYxMWEyIDIgMCAwIDAgMiAyaDEyYTIgMiAwIDAgMCAyLTJWOCIgLz4KICA8cGF0aCBkPSJNMTAgMTJoNCIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/archive\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Archive = createLucideIcon('Archive', [\n  ['rect', { width: '20', height: '5', x: '2', y: '3', rx: '1', key: '1wp1u1' }],\n  ['path', { d: 'M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8', key: '1s80jp' }],\n  ['path', { d: 'M10 12h4', key: 'a56b0p' }],\n]);\n\nexport default Archive;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Clock\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIgLz4KICA8cG9seWxpbmUgcG9pbnRzPSIxMiA2IDEyIDEyIDE2IDE0IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/clock\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Clock = createLucideIcon('Clock', [\n  ['circle', { cx: '12', cy: '12', r: '10', key: '1mglay' }],\n  ['polyline', { points: '12 6 12 12 16 14', key: '68esgv' }],\n]);\n\nexport default Clock;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Paperclip\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMjEuNDQgMTEuMDUtOS4xOSA5LjE5YTYgNiAwIDAgMS04LjQ5LTguNDlsOC41Ny04LjU3QTQgNCAwIDEgMSAxOCA4Ljg0bC04LjU5IDguNTdhMiAyIDAgMCAxLTIuODMtMi44M2w4LjQ5LTguNDgiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/paperclip\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Paperclip = createLucideIcon('Paperclip', [\n  [\n    'path',\n    {\n      d: 'm21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48',\n      key: '1u3ebp',\n    },\n  ],\n]);\n\nexport default Paperclip;\n","/**\r\n * @deprecated This file is maintained for backward compatibility.\r\n * Please import from '@/ui/atoms/textarea' instead.\r\n */\r\n\r\n\"use client\"\r\n\r\nimport * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nexport interface TextareaProps\r\n    extends React.TextareaHTMLAttributes<HTMLTextAreaElement> { }\r\n\r\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(\r\n    ({ className, ...props }, ref) => {\r\n        return (\r\n            <textarea\r\n                className={cn(\r\n                    \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\r\n                    className\r\n                )}\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        )\r\n    }\r\n)\r\nTextarea.displayName = \"Textarea\"\r\n\r\nexport { Textarea }\r\n","\"use client\";\r\n\r\nimport {\r\n  useChat,\r\n  type Message as SDKMessage,\r\n  type CreateMessage,\r\n} from \"@ai-sdk/react\";\r\nimport { v4 as uuidv4 } from \"uuid\";\r\nimport {\r\n  useState,\r\n  useEffect,\r\n  FormEvent,\r\n  useCallback,\r\n  useRef,\r\n  ChangeEvent,\r\n} from \"react\";\r\n\r\nimport {\r\n  artifactDefinitions,\r\n  ArtifactKind,\r\n  initialArtifactData,\r\n} from \"@/artifacts\";\r\nimport { Card } from \"@/components/ui/card\";\r\nimport { useToast } from \"@/components/ui/use-toast\";\r\nimport {\r\n  useArtifactStore,\r\n  useSetArtifact,\r\n  useResetArtifact,\r\n} from \"@/hooks/use-artifact\";\r\nimport { useAuth } from \"@/lib/auth/hooks\";\r\nimport { useSupabaseBrowser } from \"@/lib/supabase/client\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport { DataStreamDelta, ExtendedAttachment, StreamDataPoint } from \"@/types\";\r\n\r\nimport { ChatAnalytics } from \"./chat-analytics\";\r\nimport { UnifiedArtifact } from \"./UnifiedArtifact\";\r\nimport { UnifiedChatHeader } from \"./UnifiedChatHeader\";\r\nimport { UnifiedDocumentProcessor } from \"./UnifiedDocumentProcessor\";\r\nimport { UnifiedMessageInput } from \"./UnifiedMessageInput\";\r\nimport { UnifiedMessageList } from \"./UnifiedMessageList\";\r\nimport { UnifiedResearchContainer } from \"./UnifiedResearchContainer\";\r\nimport { UnifiedSuggestions } from \"./UnifiedSuggestions\";\r\nimport { UnifiedWebScraper } from \"./UnifiedWebScraper\";\r\n\r\ntype Message = SDKMessage;\r\n\r\n// Adapter function to convert StreamDataPoint to DataStreamDelta\r\n/**\r\n * Converts UI-specific StreamDataPoint format to the standardized DataStreamDelta format.\r\n *\r\n * The UnifiedChatContainer uses UI-specific event types (e.g., 'artifact_*'),\r\n * while the artifact system expects the standardized types (e.g., 'kind') from DataStreamDelta.\r\n * This adapter ensures compatibility between these two systems.\r\n *\r\n * @param point The StreamDataPoint from the chat system\r\n * @returns A properly formatted DataStreamDelta object\r\n */\r\nfunction adaptStreamPointToDelta(point: StreamDataPoint): DataStreamDelta {\r\n  // Map from UnifiedChat's \"artifact_*\" format to DataStreamDelta's format\r\n  const typeMap: Record<string, DataStreamDelta[\"type\"] | undefined> = {\r\n    artifact_kind: \"kind\",\r\n    artifact_id: \"id\",\r\n    artifact_title: \"title\",\r\n    artifact_clear: \"clear\",\r\n    artifact_finish: \"finish\",\r\n    text_delta: \"text-delta\",\r\n    code_delta: \"code-delta\",\r\n    sheet_delta: \"sheet-delta\",\r\n    image_delta: \"image-delta\",\r\n  };\r\n\r\n  // Get the mapped type or use a safe fallback if no direct mapping exists\r\n  const mappedType = typeMap[point.type] || \"text-delta\";\r\n\r\n  return {\r\n    type: mappedType,\r\n    content: point.content,\r\n  };\r\n}\r\n\r\nexport interface UnifiedChatContainerProps {\r\n  id?: string;\r\n  className?: string;\r\n  isReadonly?: boolean;\r\n}\r\n\r\nexport function UnifiedChatContainer({\r\n  id,\r\n  className,\r\n  isReadonly = false,\r\n}: UnifiedChatContainerProps) {\r\n  const { user, session } = useAuth();\r\n  const { toast } = useToast();\r\n  const supabase = useSupabaseBrowser();\r\n\r\n  // === Enhanced Logging for Auth Session ===\r\n  console.log(\r\n    \"[UnifiedChatContainer] Initial auth state - User:\",\r\n    user,\r\n    \"Session:\",\r\n    session\r\n  );\r\n  useEffect(() => {\r\n    console.log(\r\n      \"[UnifiedChatContainer] Auth state update - User:\",\r\n      user,\r\n      \"Session:\",\r\n      session\r\n    );\r\n  }, [user, session]);\r\n\r\n  // === State Management ===\r\n  const [currentChatId, setCurrentChatId] = useState<string>(id || uuidv4());\r\n  const [currentModel, setCurrentModel] = useState(\"gpt-4o\");\r\n  const [currentVisibility, setCurrentVisibility] = useState(\"private\");\r\n  const [attachments, setAttachments] = useState<ExtendedAttachment[]>([]);\r\n  const [currentTitle, setCurrentTitle] = useState(\"New Conversation\");\r\n\r\n  // Get artifact state/setters from Zustand store\r\n  const artifactState = useArtifactStore((state) => state.artifact);\r\n  const setArtifact = useSetArtifact();\r\n  const resetArtifact = useResetArtifact();\r\n\r\n  // Panel Visibility State (Artifact visibility might be linked to artifactState.kind)\r\n  const isArtifactVisible = artifactState.kind !== null;\r\n  const [isResearchVisible, setIsResearchVisible] = useState(false);\r\n  const [isDocumentProcessorVisible, setIsDocumentProcessorVisible] =\r\n    useState(false);\r\n  const [isWebScraperVisible, setIsWebScraperVisible] = useState(false);\r\n  const [isAnalyticsVisible, setIsAnalyticsVisible] = useState(false);\r\n\r\n  // === Fetch Session Info ===\r\n  const fetchSessionInfo = useCallback(\r\n    async (chatId: string) => {\r\n      if (!supabase) {\r\n        console.error(\r\n          \"[UnifiedChatContainer] Supabase client not available in fetchSessionInfo.\"\r\n        );\r\n        setCurrentTitle(\"New Conversation\"); // Fallback\r\n        return;\r\n      }\r\n      if (!chatId) {\r\n        console.warn(\r\n          \"[UnifiedChatContainer] fetchSessionInfo called with no chatId.\"\r\n        );\r\n        // Don't try to fetch if no chatId, could be a new chat not yet saved.\r\n        setCurrentTitle(\"New Conversation\"); // Set to default for new/unsaved chat\r\n        return;\r\n      }\r\n      console.log(\r\n        `[UnifiedChatContainer] Attempting to fetch info for chat ID: '${chatId}'`\r\n      );\r\n      try {\r\n        // Log current Supabase auth session state again just before the critical fetch\r\n        const { data: currentAuthSession, error: currentAuthError } =\r\n          await supabase.auth.getSession();\r\n        console.log(\r\n          \"[UnifiedChatContainer] Supabase Auth Session right before fetching chat_sessions:\",\r\n          currentAuthSession,\r\n          \"Auth Error (if any):\",\r\n          currentAuthError\r\n        );\r\n        if (currentAuthError) {\r\n          console.error(\r\n            \"[UnifiedChatContainer] Supabase auth error before fetching chat_sessions:\",\r\n            currentAuthError\r\n          );\r\n          // Potentially stop here if auth is the issue\r\n        }\r\n        if (!currentAuthSession?.session) {\r\n          console.warn(\r\n            \"[UnifiedChatContainer] No active Supabase session before fetching chat_sessions. This might lead to RLS issues.\"\r\n          );\r\n        }\r\n\r\n        const { data, error } = await supabase\r\n          .from(\"chat_sessions\")\r\n          .select(\"*\")\r\n          .eq(\"id\", chatId)\r\n          .single();\r\n\r\n        if (error || !data) {\r\n          // Handle initial empty result or explicit error (e.g. replication lag)\r\n          for (let attempt = 1; attempt <= 3; attempt++) {\r\n            await new Promise((res) => setTimeout(res, attempt * 500));\r\n            const { data: retryData, error: retryErr } = await supabase\r\n              .from(\"chat_sessions\")\r\n              .select(\"*\")\r\n              .eq(\"id\", chatId)\r\n              .single();\r\n            if (!retryErr && retryData?.title) {\r\n              setCurrentTitle(retryData.title);\r\n              return;\r\n            }\r\n          }\r\n          console.error(\r\n            \"[UnifiedChatContainer] Error fetching session info from 'chat_sessions' table. Chat ID:\",\r\n            chatId,\r\n            \"Supabase Error:\",\r\n            error || \"No data returned\"\r\n          );\r\n          setCurrentTitle(\"New Conversation\");\r\n          return;\r\n        }\r\n\r\n        if (data.title) {\r\n          console.log(\r\n            `[UnifiedChatContainer] Successfully fetched and set title: ${data.title} for chat ID: ${chatId}`\r\n          );\r\n          setCurrentTitle(data.title);\r\n        } else {\r\n          console.log(\r\n            `[UnifiedChatContainer] No session title found for chat ID: ${chatId}, using default. Data received:`,\r\n            data\r\n          );\r\n          setCurrentTitle(\"New Conversation\");\r\n        }\r\n      } catch (err: any) {\r\n        console.error(\r\n          \"[UnifiedChatContainer] Catch block: Failed to fetch session info for chat ID:\",\r\n          chatId,\r\n          \"Error details:\",\r\n          err,\r\n          \"Error message:\",\r\n          err?.message,\r\n          \"Error stack:\",\r\n          err?.stack\r\n        );\r\n        setCurrentTitle(\"New Conversation\");\r\n      }\r\n    },\r\n    [supabase] // supabase client is the key dependency here\r\n  );\r\n\r\n  // === useChat Hook ===\r\n  const apiEndpointForChat = \"/api/chat\";\r\n  console.log(\r\n    `[UnifiedChatContainer] useChat API endpoint: ${apiEndpointForChat}`\r\n  );\r\n  const {\r\n    messages,\r\n    input,\r\n    setInput,\r\n    handleInputChange,\r\n    handleSubmit,\r\n    stop,\r\n    isLoading,\r\n    error: chatHookError, // Renamed to avoid conflict with other 'error' variables\r\n    data,\r\n    setMessages,\r\n    append,\r\n    reload,\r\n  } = useChat({\r\n    api: apiEndpointForChat,\r\n    id: currentChatId,\r\n    initialMessages: [],\r\n    body: {\r\n      selectedChatModel: currentModel,\r\n      visibility: currentVisibility,\r\n    },\r\n    headers: {\r\n      // Ensure Authorization header is only added if access_token exists\r\n      ...(session?.access_token && {\r\n        Authorization: `Bearer ${session.access_token}`,\r\n      }),\r\n    },\r\n    generateId: () => uuidv4(),\r\n    onFinish: async (message) => {\r\n      console.log(\"[UnifiedChatContainer] Chat finished, message:\", message);\r\n      // Fetch session info again to update title if it was a new chat that just got created/named by the backend\r\n      if (currentChatId) {\r\n        // Ensure currentChatId is valid before fetching\r\n        await fetchSessionInfo(currentChatId);\r\n      }\r\n    },\r\n    onError: (err) => {\r\n      console.error(\r\n        \"[UnifiedChatContainer] useChat hook error:\",\r\n        err,\r\n        \"Stringified:\",\r\n        JSON.stringify(err)\r\n      );\r\n      const errorMessage =\r\n        (err as any)?.message || \"An error occurred in chat. Please try again.\";\r\n      toast({\r\n        title: \"Chat Error\",\r\n        description: errorMessage,\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n  });\r\n\r\n  // === Effects ===\r\n\r\n  // Effect to add event listeners for toggling panels\r\n  useEffect(() => {\r\n    const handleToggleDocumentProcessor = () => {\r\n      setIsDocumentProcessorVisible((v) => !v);\r\n    };\r\n\r\n    const handleToggleResearch = () => {\r\n      setIsResearchVisible((v) => !v);\r\n    };\r\n\r\n    const handleToggleWebScraper = () => {\r\n      setIsWebScraperVisible((v) => !v);\r\n    };\r\n\r\n    const handleToggleAnalytics = () => {\r\n      setIsAnalyticsVisible((v) => !v);\r\n    };\r\n\r\n    document.addEventListener(\r\n      \"toggle-document-processor\",\r\n      handleToggleDocumentProcessor\r\n    );\r\n    document.addEventListener(\"toggle-research\", handleToggleResearch);\r\n    document.addEventListener(\"toggle-web-scraper\", handleToggleWebScraper);\r\n    document.addEventListener(\"toggle-analytics\", handleToggleAnalytics);\r\n\r\n    return () => {\r\n      document.removeEventListener(\r\n        \"toggle-document-processor\",\r\n        handleToggleDocumentProcessor\r\n      );\r\n      document.removeEventListener(\"toggle-research\", handleToggleResearch);\r\n      document.removeEventListener(\r\n        \"toggle-web-scraper\",\r\n        handleToggleWebScraper\r\n      );\r\n      document.removeEventListener(\"toggle-analytics\", handleToggleAnalytics);\r\n    };\r\n  }, []);\r\n\r\n  // Effect to update currentChatId when the id prop changes\r\n  useEffect(() => {\r\n    if (id && id !== currentChatId) {\r\n      console.log(\r\n        `[UnifiedChatContainer] ID prop changed. Updating currentChatId from ${currentChatId} to ${id}`\r\n      );\r\n      setCurrentChatId(id);\r\n      // Reset artifact and potentially other state when chat ID changes\r\n      resetArtifact();\r\n      // The useChat hook will automatically reload messages based on the new id\r\n    } else if (!id) {\r\n      // If no ID is provided (e.g., new chat page), ensure we have a local ID\r\n      // but don't necessarily fetch history yet.\r\n      if (!currentChatId) {\r\n        const newId = uuidv4();\r\n        console.log(\r\n          `[UnifiedChatContainer] No ID prop found, generating new local ID: ${newId}`\r\n        );\r\n        setCurrentChatId(newId);\r\n      }\r\n    }\r\n  }, [id, currentChatId, resetArtifact]);\r\n\r\n  // Effect to fetch session info when currentChatId changes\r\n  useEffect(() => {\r\n    // Only fetch if currentChatId is a valid, non-empty string\r\n    if (currentChatId && currentChatId.trim() !== \"\") {\r\n      fetchSessionInfo(currentChatId);\r\n    } else {\r\n      console.log(\r\n        \"[UnifiedChatContainer] Skipping fetchSessionInfo in useEffect because currentChatId is invalid or empty:\",\r\n        currentChatId\r\n      );\r\n      // Reset title if chat ID becomes invalid (e.g. navigating from existing chat to new chat directly)\r\n      setCurrentTitle(\"New Conversation\");\r\n    }\r\n  }, [currentChatId, fetchSessionInfo]);\r\n\r\n  const lastProcessedDataIndex = useRef(-1);\r\n  useEffect(() => {\r\n    if (!data?.length || data.length === lastProcessedDataIndex.current + 1)\r\n      return;\r\n    const newDataPoints = data.slice(\r\n      lastProcessedDataIndex.current + 1\r\n    ) as StreamDataPoint[];\r\n    lastProcessedDataIndex.current = data.length - 1;\r\n    console.log(\"Processing data stream points:\", newDataPoints);\r\n    newDataPoints.forEach((delta: StreamDataPoint) => {\r\n      const definition = artifactDefinitions.find(\r\n        (def: any) => def.kind === artifactState.kind\r\n      );\r\n      if (definition?.onStreamPart) {\r\n        definition.onStreamPart({\r\n          streamPart: adaptStreamPointToDelta(delta),\r\n          setArtifact,\r\n        });\r\n      }\r\n      setArtifact((currentArtifact) => {\r\n        const draftArtifact = currentArtifact ?? {\r\n          ...initialArtifactData,\r\n          status: \"streaming\",\r\n        };\r\n        if (!draftArtifact) return draftArtifact;\r\n        switch (delta.type) {\r\n          case \"artifact_kind\":\r\n            return {\r\n              ...initialArtifactData,\r\n              kind: delta.content as ArtifactKind,\r\n              status: \"streaming\",\r\n            };\r\n          case \"artifact_id\":\r\n            return {\r\n              ...draftArtifact,\r\n              documentId: delta.content as string,\r\n              status: \"streaming\",\r\n            };\r\n          case \"artifact_title\":\r\n            return {\r\n              ...draftArtifact,\r\n              title: delta.content as string,\r\n              status: \"streaming\",\r\n            };\r\n          case \"artifact_clear\":\r\n            return { ...draftArtifact, content: \"\", status: \"streaming\" };\r\n          case \"artifact_finish\":\r\n            return { ...draftArtifact, status: \"idle\" };\r\n          default:\r\n            return draftArtifact;\r\n        }\r\n      });\r\n    });\r\n  }, [data, artifactState.kind, setArtifact]);\r\n\r\n  // === Event Handlers ===\r\n  const handleFormSubmit = useCallback(\r\n    async (e: FormEvent<HTMLFormElement>) => {\r\n      e.preventDefault();\r\n      if (!input.trim() && attachments.length === 0) return Promise.resolve();\r\n      const validAttachments = attachments\r\n        .filter((a) => a.url !== undefined)\r\n        .map((a) => ({\r\n          id: a.id,\r\n          name: a.name,\r\n          url: a.url as string,\r\n          type: a.type,\r\n          size: a.size ?? 0,\r\n        }));\r\n      const attachmentsPayload =\r\n        validAttachments.length > 0 ? validAttachments : undefined;\r\n      const dataToSend = attachmentsPayload\r\n        ? { attachments: attachmentsPayload }\r\n        : undefined;\r\n      console.log(\"Submitting message with data:\", dataToSend);\r\n      handleSubmit(e, { data: dataToSend });\r\n      setInput(\"\");\r\n      setAttachments([]);\r\n      return Promise.resolve();\r\n    },\r\n    [input, attachments, handleSubmit, setInput]\r\n  );\r\n\r\n  const handleAppend = useCallback(\r\n    async (messageOrMessages: Message | Message[]) => {\r\n      if (!messageOrMessages) {\r\n        console.warn(\"handleAppend called with empty message(s).\");\r\n        return Promise.resolve();\r\n      }\r\n      console.log(\"Appending message(s):\", messageOrMessages);\r\n      if (Array.isArray(messageOrMessages)) {\r\n        for (const msg of messageOrMessages) {\r\n          if (msg.content) {\r\n            await append(msg);\r\n          }\r\n        }\r\n      } else if (messageOrMessages.content) {\r\n        await append(messageOrMessages as CreateMessage);\r\n      }\r\n      return Promise.resolve();\r\n    },\r\n    [append]\r\n  );\r\n\r\n  const handleNewSession = useCallback(async () => {\r\n    const newId = uuidv4();\r\n    console.log(`Starting new session: ${newId}`);\r\n    setCurrentChatId(newId);\r\n    setMessages([]);\r\n    setAttachments([]);\r\n    setInput(\"\");\r\n    resetArtifact();\r\n    setCurrentTitle(\"New Conversation\");\r\n    toast({\r\n      title: \"New chat started\",\r\n      description: `Session ID: ${newId.substring(0, 6)}...`,\r\n    });\r\n    return Promise.resolve();\r\n  }, [setInput, toast, setMessages, resetArtifact]);\r\n\r\n  const handleSessionChange = useCallback(\r\n    (sessionId: string) => {\r\n      if (sessionId === currentChatId) return;\r\n      console.log(`Changing session to: ${sessionId}`);\r\n      setCurrentChatId(sessionId);\r\n      setAttachments([]);\r\n      setInput(\"\");\r\n    },\r\n    [currentChatId, setInput]\r\n  );\r\n\r\n  const toggleArtifact = useCallback(() => {\r\n    /* Visibility now derived from artifactState.kind */\r\n  }, []);\r\n  const toggleResearch = useCallback(() => setIsResearchVisible((v) => !v), []);\r\n  const toggleDocumentProcessor = useCallback(\r\n    () => setIsDocumentProcessorVisible((v) => !v),\r\n    []\r\n  );\r\n  const toggleWebScraper = useCallback(\r\n    () => setIsWebScraperVisible((v) => !v),\r\n    []\r\n  );\r\n  const toggleAnalytics = useCallback(\r\n    () => setIsAnalyticsVisible((v) => !v),\r\n    []\r\n  );\r\n\r\n  const handleModelChange = useCallback(\r\n    (model: string) => setCurrentModel(model),\r\n    []\r\n  );\r\n  const handleVisibilityChange = useCallback(\r\n    (vis: string) => setCurrentVisibility(vis),\r\n    []\r\n  );\r\n\r\n  const handleTitleChangeFromHeader = useCallback((newTitle: string) => {\r\n    setCurrentTitle(newTitle);\r\n  }, []);\r\n\r\n  if (!user && !isReadonly) {\r\n    return (\r\n      <Card className=\"flex h-full items-center justify-center p-6\">\r\n        <p className=\"text-muted-foreground\">\r\n          Please sign in to start chatting\r\n        </p>\r\n      </Card>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={cn(\"flex flex-col h-full\", className)}>\r\n      <UnifiedChatHeader\r\n        chatId={currentChatId}\r\n        initialTitle={currentTitle}\r\n        selectedModel={currentModel}\r\n        selectedVisibility={currentVisibility}\r\n        onModelChange={handleModelChange}\r\n        onVisibilityChange={handleVisibilityChange}\r\n        onTitleChange={handleTitleChangeFromHeader}\r\n        isReadonly={isReadonly}\r\n        onNewSession={handleNewSession}\r\n        onSessionChange={handleSessionChange}\r\n        toggleArtifact={toggleArtifact}\r\n        toggleResearch={toggleResearch}\r\n        toggleDocumentProcessor={toggleDocumentProcessor}\r\n        toggleWebScraper={toggleWebScraper}\r\n        toggleAnalytics={toggleAnalytics}\r\n        isArtifactVisible={isArtifactVisible}\r\n        isResearchVisible={isResearchVisible}\r\n        isDocumentProcessorVisible={isDocumentProcessorVisible}\r\n        isWebScraperVisible={isWebScraperVisible}\r\n        isAnalyticsVisible={isAnalyticsVisible}\r\n      />\r\n      <div className=\"flex-1 overflow-hidden flex relative\">\r\n        <div\r\n          className={cn(\r\n            \"flex-1 overflow-y-auto p-4\",\r\n            isWebScraperVisible ||\r\n              isResearchVisible ||\r\n              isDocumentProcessorVisible ||\r\n              isAnalyticsVisible\r\n              ? \"max-w-[calc(100%-350px)]\"\r\n              : \"\"\r\n          )}\r\n        >\r\n          <UnifiedMessageList\r\n            messages={messages}\r\n            isLoading={isLoading}\r\n            chatId={currentChatId}\r\n          />\r\n        </div>\r\n        {isArtifactVisible && <UnifiedArtifact />}\r\n        {isResearchVisible && (\r\n          <UnifiedResearchContainer\r\n            chatId={currentChatId}\r\n            append={handleAppend}\r\n            messages={messages}\r\n            isLoading={isLoading}\r\n            isVisible={isResearchVisible}\r\n            className=\"w-[350px] flex-shrink-0\"\r\n          />\r\n        )}\r\n        {isDocumentProcessorVisible && (\r\n          <UnifiedDocumentProcessor\r\n            chatId={currentChatId}\r\n            append={handleAppend}\r\n            attachments={attachments}\r\n            isLoading={isLoading}\r\n            isVisible={isDocumentProcessorVisible}\r\n            className=\"w-[350px] flex-shrink-0\"\r\n          />\r\n        )}\r\n        {isWebScraperVisible && (\r\n          <UnifiedWebScraper\r\n            chatId={currentChatId}\r\n            append={handleAppend}\r\n            isLoading={isLoading}\r\n            isVisible={isWebScraperVisible}\r\n            className=\"w-[350px] flex-shrink-0\"\r\n          />\r\n        )}\r\n        {isAnalyticsVisible && (\r\n          <ChatAnalytics\r\n            chatId={currentChatId}\r\n            className=\"w-[350px] flex-shrink-0\"\r\n          />\r\n        )}\r\n      </div>\r\n      <div className=\"border-t p-4\">\r\n        <UnifiedSuggestions append={handleAppend} messages={messages} />\r\n        <UnifiedMessageInput\r\n          input={input}\r\n          setInput={setInput}\r\n          handleSubmit={handleFormSubmit}\r\n          isLoading={isLoading}\r\n          stop={stop}\r\n          attachments={attachments}\r\n          setAttachments={setAttachments}\r\n          chatId={currentChatId}\r\n          chatError={\r\n            chatHookError && !isLoading ? (chatHookError.message ?? null) : null\r\n          }\r\n        />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport { useCallback, useMemo } from \"react\";\r\nimport useSWR from \"swr\";\r\nimport { create } from \"zustand\";\r\n\r\nimport {\r\n  ArtifactKind,\r\n  BaseArtifactData,\r\n  initialArtifactData,\r\n} from \"@/artifacts\";\r\n\r\ninterface ArtifactStore {\r\n  artifact: BaseArtifactData;\r\n  metadata: Record<string, any>;\r\n  setArtifact: (updater: (prev: BaseArtifactData) => BaseArtifactData) => void;\r\n  setMetadata: (\r\n    updater: (prev: Record<string, any>) => Record<string, any>\r\n  ) => void;\r\n  resetArtifact: () => void;\r\n}\r\n\r\nexport const useArtifactStore = create<ArtifactStore>((set) => ({\r\n  artifact: initialArtifactData,\r\n  metadata: {},\r\n  setArtifact: (updater) =>\r\n    set((state) => ({ artifact: updater(state.artifact) })),\r\n  setMetadata: (updater) =>\r\n    set((state) => ({ metadata: updater(state.metadata) })),\r\n  resetArtifact: () => set({ artifact: initialArtifactData, metadata: {} }),\r\n}));\r\n\r\n// Convenience hook selector\r\nexport const useSetArtifact = () =>\r\n  useArtifactStore((state) => state.setArtifact);\r\nexport const useResetArtifact = () =>\r\n  useArtifactStore((state) => state.resetArtifact);\r\nexport const useArtifactMetadata = () =>\r\n  useArtifactStore((state) => state.metadata);\r\nexport const useSetArtifactMetadata = () =>\r\n  useArtifactStore((state) => state.setMetadata);\r\n\r\n// Define the Selector type\r\ntype Selector<Selected> = (artifact: BaseArtifactData) => Selected;\r\n\r\nexport function useArtifactSelector<Selected>(selector: Selector<Selected>) {\r\n  const { data: localArtifact } = useSWR<BaseArtifactData>(\"artifact\", null, {\r\n    fallbackData: initialArtifactData,\r\n  });\r\n\r\n  const selectedValue = useMemo(() => {\r\n    if (!localArtifact) return selector(initialArtifactData);\r\n    return selector(localArtifact);\r\n  }, [localArtifact, selector]);\r\n\r\n  return selectedValue;\r\n}\r\n\r\nexport function useArtifact() {\r\n  const { data: localArtifact, mutate: setLocalArtifact } =\r\n    useSWR<BaseArtifactData>(\"artifact\", null, {\r\n      fallbackData: initialArtifactData,\r\n    });\r\n\r\n  const artifact = useMemo(() => {\r\n    if (!localArtifact) return initialArtifactData;\r\n    return localArtifact;\r\n  }, [localArtifact]);\r\n\r\n  const setArtifact = useCallback(\r\n    (\r\n      updaterFn:\r\n        | BaseArtifactData\r\n        | ((currentArtifact: BaseArtifactData) => BaseArtifactData)\r\n    ) => {\r\n      setLocalArtifact((currentArtifact: BaseArtifactData | undefined) => {\r\n        const artifactToUpdate = currentArtifact || initialArtifactData;\r\n\r\n        if (typeof updaterFn === \"function\") {\r\n          return updaterFn(artifactToUpdate);\r\n        }\r\n\r\n        return updaterFn;\r\n      });\r\n    },\r\n    [setLocalArtifact]\r\n  );\r\n\r\n  const { data: localArtifactMetadata, mutate: setLocalArtifactMetadata } =\r\n    useSWR<any>(\r\n      () =>\r\n        artifact.documentId ? `artifact-metadata-${artifact.documentId}` : null,\r\n      null,\r\n      {\r\n        fallbackData: null,\r\n      }\r\n    );\r\n\r\n  return useMemo(\r\n    () => ({\r\n      artifact,\r\n      setArtifact,\r\n      metadata: localArtifactMetadata,\r\n      setMetadata: setLocalArtifactMetadata,\r\n    }),\r\n    [artifact, setArtifact, localArtifactMetadata, setLocalArtifactMetadata]\r\n  );\r\n}\r\n","import React from 'react';\r\n\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { UnifiedMarkdown } from '@/components/ui/unified-chat/UnifiedMarkdown'; // Adjust path as needed\r\n\r\nimport { BaseArtifactData } from '../index'; // Assuming index.ts is one level up\r\n\r\ninterface TextArtifactProps {\r\n    artifact: BaseArtifactData;\r\n}\r\n\r\nexport const TextArtifact: React.FC<TextArtifactProps> = ({ artifact }) => {\r\n    return (\r\n        <Card className=\"h-full flex flex-col\">\r\n            <CardHeader>\r\n                <CardTitle>{artifact.title || 'Text Artifact'}</CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"flex-1 overflow-auto\">\r\n                {typeof artifact.content === 'string' ? (\r\n                    <UnifiedMarkdown content={artifact.content} />\r\n                ) : (\r\n                    <pre className=\"text-xs text-muted-foreground\">Invalid content format</pre>\r\n                )}\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n}; ","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name PlusCircle\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIgLz4KICA8cGF0aCBkPSJNOCAxMmg4IiAvPgogIDxwYXRoIGQ9Ik0xMiA4djgiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/plus-circle\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst PlusCircle = createLucideIcon('PlusCircle', [\n  ['circle', { cx: '12', cy: '12', r: '10', key: '1mglay' }],\n  ['path', { d: 'M8 12h8', key: '1wcyev' }],\n  ['path', { d: 'M12 8v8', key: 'napkw2' }],\n]);\n\nexport default PlusCircle;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Pencil\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTcgM2EyLjg1IDIuODMgMCAxIDEgNCA0TDcuNSAyMC41IDIgMjJsMS41LTUuNVoiIC8+CiAgPHBhdGggZD0ibTE1IDUgNCA0IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/pencil\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Pencil = createLucideIcon('Pencil', [\n  ['path', { d: 'M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z', key: '5qss01' }],\n  ['path', { d: 'm15 5 4 4', key: '1mk7zo' }],\n]);\n\nexport default Pencil;\n","\"use client\";\r\n\r\nimport {\r\n  Paperclip,\r\n  SendHorizonal,\r\n  StopCircle,\r\n  X,\r\n  Mic,\r\n  MicOff,\r\n} from \"lucide-react\";\r\nimport { useSession } from \"@/lib/auth/hooks\";\r\nimport {\r\n  useState,\r\n  useRef,\r\n  FormEvent,\r\n  KeyboardEvent,\r\n  ChangeEvent,\r\n  useEffect,\r\n} from \"react\";\r\nimport { useDropzone } from \"react-dropzone\";\r\n\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Textarea } from \"@/components/ui/textarea\";\r\nimport { useToast } from \"@/components/ui/use-toast\";\r\nimport { useSpeechRecognition } from \"@/hooks/useSpeechRecognition\";\r\nimport { useI18n } from \"@/i18n/hooks\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nimport { ExtendedAttachment } from \"./types\";\r\n\r\ninterface UnifiedMessageInputProps {\r\n  input: string;\r\n  setInput: (value: string) => void;\r\n  handleSubmit: (e: FormEvent<HTMLFormElement>) => Promise<void>;\r\n  isLoading: boolean;\r\n  stop: () => void;\r\n  attachments: ExtendedAttachment[];\r\n  setAttachments: (attachments: ExtendedAttachment[]) => void;\r\n  chatId: string;\r\n  chatError: string | null;\r\n}\r\n\r\nexport function UnifiedMessageInput({\r\n  input,\r\n  setInput,\r\n  handleSubmit,\r\n  isLoading,\r\n  stop,\r\n  attachments,\r\n  setAttachments,\r\n  chatId,\r\n  chatError,\r\n}: UnifiedMessageInputProps) {\r\n  const { toast } = useToast();\r\n  const { locale, t } = useI18n();\r\n  const formRef = useRef<HTMLFormElement>(null);\r\n  const inputRef = useRef<HTMLTextAreaElement>(null);\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n  const [isDraggingOver, setIsDraggingOver] = useState(false);\r\n  const [speechError, setSpeechError] = useState<string | null>(null);\r\n  const { session, user, isLoading: isSessionLoading } = useSession();\r\n\r\n  // --- Integrate Speech Recognition Hook with locale support ---\r\n  const {\r\n    isRecording,\r\n    startRecording,\r\n    stopRecording,\r\n    isAvailable: isSpeechAvailable,\r\n  } = useSpeechRecognition({\r\n    locale,\r\n    onResult: (transcript) => {\r\n      setInput(transcript); // Directly set input, assuming continuous results update\r\n      setSpeechError(null);\r\n    },\r\n    onError: (error) => {\r\n      console.error(\"Speech recognition error in component:\", error);\r\n      let message = t(\"chat.speechRecognition.errors.general\");\r\n      if (error === \"not-allowed\" || error === \"service-not-allowed\") {\r\n        message = t(\"chat.speechRecognition.errors.notAllowed\");\r\n      } else if (error === \"no-speech\") {\r\n        message = t(\"chat.speechRecognition.errors.noSpeech\");\r\n      } else if (error === \"network\") {\r\n        message = t(\"chat.speechRecognition.errors.network\");\r\n      } else if (error === \"not-available\") {\r\n        message = t(\"chat.speechRecognition.errors.notAvailable\");\r\n      }\r\n      setSpeechError(message);\r\n      // Optionally show a toast as well\r\n      toast({\r\n        title: t(\"error\"),\r\n        description: message,\r\n        variant: \"destructive\",\r\n      });\r\n    },\r\n    onEnd: () => {\r\n      // Recording ended (manually or automatically)\r\n      inputRef.current?.focus(); // Focus input when recording stops\r\n    },\r\n  });\r\n  // -----------------------------------------\r\n\r\n  const { getRootProps, getInputProps: getDropzoneInputProps } = useDropzone({\r\n    noClick: true,\r\n    noKeyboard: true,\r\n    maxFiles: 10,\r\n    maxSize: 10 * 1024 * 1024, // 10MB max file size\r\n    accept: {\r\n      \"image/*\": [\".png\", \".jpg\", \".jpeg\", \".gif\", \".webp\"],\r\n      \"application/pdf\": [\".pdf\"],\r\n      \"text/plain\": [\".txt\"],\r\n      \"text/csv\": [\".csv\"],\r\n      \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\": [\r\n        \".xlsx\",\r\n      ],\r\n      \"application/vnd.openxmlformats-officedocument.wordprocessingml.document\":\r\n        [\".docx\"],\r\n    },\r\n    onDragEnter: () => setIsDraggingOver(true),\r\n    onDragLeave: () => setIsDraggingOver(false),\r\n    onDrop: async (acceptedFiles, rejectedFiles) => {\r\n      setIsDraggingOver(false);\r\n\r\n      // Handle rejected files (too large or wrong type)\r\n      if (rejectedFiles.length > 0) {\r\n        toast({\r\n          title: \"File upload failed\",\r\n          description:\r\n            \"Some files were rejected due to size or type restrictions\",\r\n          variant: \"destructive\",\r\n        });\r\n      }\r\n\r\n      if (acceptedFiles.length === 0) return;\r\n\r\n      try {\r\n        // Process each file\r\n        const newAttachments = await Promise.all(\r\n          acceptedFiles.map(async (file) => {\r\n            const formData = new FormData();\r\n            formData.append(\"file\", file);\r\n            formData.append(\"chatId\", chatId);\r\n\r\n            const response = await fetch(\"/api/files/upload\", {\r\n              method: \"POST\",\r\n              body: formData,\r\n            });\r\n\r\n            if (!response.ok) {\r\n              throw new Error(`Failed to upload file: ${file.name}`);\r\n            }\r\n\r\n            const data = await response.json();\r\n\r\n            return {\r\n              id: data.id,\r\n              name: file.name,\r\n              type: file.type,\r\n              size: file.size,\r\n              url: data.url,\r\n            } as ExtendedAttachment;\r\n          })\r\n        );\r\n\r\n        setAttachments([...attachments, ...newAttachments]);\r\n        toast({\r\n          title: \"Files uploaded\",\r\n          description: `Successfully uploaded ${acceptedFiles.length} file(s)`,\r\n        });\r\n      } catch (error) {\r\n        console.error(\"Error uploading files:\", error);\r\n        toast({\r\n          title: \"Upload failed\",\r\n          description: \"Failed to upload files. Please try again.\",\r\n          variant: \"destructive\",\r\n        });\r\n      }\r\n    },\r\n  });\r\n\r\n  // Auto-resize textarea (Added from AIMessageInput logic)\r\n  useEffect(() => {\r\n    if (inputRef.current) {\r\n      inputRef.current.style.height = \"auto\";\r\n      const scrollHeight = inputRef.current.scrollHeight;\r\n      // Set a max height (e.g., 144px corresponding to max-h-36)\r\n      const maxHeight = 144;\r\n      inputRef.current.style.height = `${Math.min(scrollHeight, maxHeight)}px`;\r\n    }\r\n  }, [input]);\r\n\r\n  const handleKeyDown = (e: KeyboardEvent<HTMLTextAreaElement>) => {\r\n    if (e.key === \"Enter\" && !e.shiftKey) {\r\n      e.preventDefault();\r\n      if (!isRecording) {\r\n        // Prevent submission while recording\r\n        formRef.current?.requestSubmit();\r\n      }\r\n    }\r\n  };\r\n\r\n  // File handling via button click\r\n  const handleFileButtonClick = () => {\r\n    fileInputRef.current?.click();\r\n  };\r\n\r\n  const handleFileChange = async (e: ChangeEvent<HTMLInputElement>) => {\r\n    const files = e.target.files;\r\n    if (!files || files.length === 0) return;\r\n\r\n    // Reuse the dropzone's upload logic for consistency\r\n    // NOTE: This assumes the onDrop logic handles the actual upload\r\n    // We need to adapt the `onDrop` logic slightly or duplicate parts of it.\r\n    // For simplicity here, we'll call a simulated upload function.\r\n    await handleFileUpload(Array.from(files));\r\n\r\n    // Reset file input\r\n    if (fileInputRef.current) {\r\n      fileInputRef.current.value = \"\";\r\n    }\r\n  };\r\n\r\n  // Extracted file upload logic (adapt from onDrop)\r\n  const handleFileUpload = async (filesToUpload: File[]) => {\r\n    try {\r\n      // Log session status before making the request\r\n      console.log(\"Session status before upload:\", isSessionLoading);\r\n      console.log(\"Session data before upload:\", session);\r\n\r\n      const newAttachments = await Promise.all(\r\n        filesToUpload.map(async (file) => {\r\n          const formData = new FormData();\r\n          formData.append(\"file\", file);\r\n          formData.append(\"chatId\", chatId);\r\n          const response = await fetch(\"/api/files/upload\", {\r\n            method: \"POST\",\r\n            body: formData,\r\n          });\r\n          if (!response.ok) {\r\n            throw new Error(`Failed to upload file: ${file.name}`);\r\n          }\r\n          const data = await response.json();\r\n          return {\r\n            id: data.id,\r\n            name: file.name,\r\n            type: file.type,\r\n            size: file.size,\r\n            url: data.url,\r\n          } as ExtendedAttachment;\r\n        })\r\n      );\r\n      setAttachments([...attachments, ...newAttachments]);\r\n      toast({\r\n        title: \"Files uploaded\",\r\n        description: `Uploaded ${filesToUpload.length} file(s)`,\r\n      });\r\n    } catch (error) {\r\n      console.error(\"Error uploading files:\", error);\r\n      toast({ title: \"Upload failed\", variant: \"destructive\" });\r\n    }\r\n  };\r\n\r\n  const removeAttachment = (id: string) => {\r\n    setAttachments(attachments.filter((file) => file.id !== id));\r\n  };\r\n\r\n  // Clear speech error when user types\r\n  useEffect(() => {\r\n    if (input && speechError) {\r\n      setSpeechError(null);\r\n    }\r\n  }, [input, speechError]);\r\n\r\n  return (\r\n    <div\r\n      {...getRootProps()}\r\n      className={cn(\r\n        \"relative border-t bg-background\", // Added bg-background\r\n        isDraggingOver &&\r\n          \"after:absolute after:inset-0 after:bg-primary/10 after:border-2 after:border-dashed after:border-primary after:rounded-md after:z-10\"\r\n      )}\r\n    >\r\n      <form\r\n        ref={formRef}\r\n        onSubmit={(e) => {\r\n          if (!isRecording) {\r\n            handleSubmit(e);\r\n          } else {\r\n            e.preventDefault(); // Prevent form submission if recording\r\n          }\r\n        }}\r\n        className=\"relative flex flex-col p-2\" // Add padding\r\n      >\r\n        {/* Hidden inputs */}\r\n        <input {...getDropzoneInputProps()} />\r\n        <input\r\n          type=\"file\"\r\n          ref={fileInputRef}\r\n          className=\"hidden\"\r\n          multiple\r\n          accept=\"image/*,.pdf,.txt,.csv,.xlsx,.docx\"\r\n          onChange={handleFileChange}\r\n        />\r\n\r\n        {/* Combined Error Display Area */}\r\n        {(chatError || speechError) && (\r\n          <div className=\"mb-2 p-2 text-sm text-destructive bg-destructive/10 border border-destructive/30 rounded-md\">\r\n            {chatError && <div>{chatError}</div>}\r\n            {speechError && <div>{speechError}</div>}\r\n          </div>\r\n        )}\r\n\r\n        {/* Attachments display */}\r\n        {attachments.length > 0 && (\r\n          <div className=\"flex flex-wrap gap-2 mb-2\">\r\n            {attachments.map((file) => (\r\n              <div\r\n                key={file.id}\r\n                className=\"flex items-center gap-1.5 text-xs bg-muted rounded-md px-2 py-1\"\r\n              >\r\n                <span className=\"max-w-[150px] truncate\">{file.name}</span>\r\n                <Button\r\n                  type=\"button\"\r\n                  variant=\"ghost\"\r\n                  size=\"icon\"\r\n                  className=\"h-4 w-4\"\r\n                  onClick={() => removeAttachment(file.id)}\r\n                >\r\n                  <X className=\"h-3 w-3\" />\r\n                </Button>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n\r\n        {/* Input Area */}\r\n        <div className=\"relative flex items-end gap-2\">\r\n          {/* Attach Button */}\r\n          <Button\r\n            type=\"button\"\r\n            variant=\"ghost\"\r\n            size=\"icon\"\r\n            disabled={isLoading || isRecording}\r\n            className=\"text-muted-foreground flex-shrink-0\"\r\n            onClick={handleFileButtonClick}\r\n            aria-label={t(\"chat.input.attachFile\")}\r\n          >\r\n            <Paperclip className=\"h-5 w-5\" />\r\n          </Button>\r\n\r\n          {/* Textarea */}\r\n          <Textarea\r\n            ref={inputRef}\r\n            tabIndex={0}\r\n            placeholder={\r\n              isRecording\r\n                ? t(\"chat.input.recordingPlaceholder\")\r\n                : t(\"chat.input.placeholder\")\r\n            }\r\n            value={input}\r\n            onChange={(e: ChangeEvent<HTMLTextAreaElement>) => {\r\n              setInput(e.target.value);\r\n            }}\r\n            onKeyDown={handleKeyDown}\r\n            className=\"flex-grow resize-none self-end max-h-36 min-h-[2.5rem] pr-20 py-2 leading-tight\"\r\n            rows={1}\r\n            disabled={isLoading || isRecording}\r\n          />\r\n          {/* Absolute positioned buttons inside the relative container */}\r\n          <div className=\"absolute right-2 bottom-1 flex items-center gap-1\">\r\n            {/* Mic Button - Conditionally Render based on availability */}\r\n            {isSpeechAvailable ? (\r\n              <Button\r\n                type=\"button\"\r\n                variant=\"ghost\"\r\n                size=\"icon\"\r\n                disabled={isLoading} // Disable mic if AI is responding\r\n                className={cn(\r\n                  \"text-muted-foreground\",\r\n                  isRecording && \"text-red-500 animate-pulse\"\r\n                )}\r\n                onClick={isRecording ? stopRecording : startRecording}\r\n                aria-label={\r\n                  isRecording\r\n                    ? t(\"chat.input.stopRecording\")\r\n                    : t(\"chat.input.startRecording\")\r\n                }\r\n              >\r\n                {isRecording ? (\r\n                  <MicOff className=\"h-5 w-5\" />\r\n                ) : (\r\n                  <Mic className=\"h-5 w-5\" />\r\n                )}\r\n              </Button>\r\n            ) : (\r\n              <Button\r\n                type=\"button\"\r\n                variant=\"ghost\"\r\n                size=\"icon\"\r\n                disabled\r\n                title={t(\"chat.input.speechUnavailable\")}\r\n              >\r\n                <MicOff className=\"h-5 w-5 text-muted-foreground/50\" />\r\n              </Button>\r\n            )}\r\n\r\n            {/* Send/Stop Button */}\r\n            {isLoading ? (\r\n              <Button\r\n                type=\"button\"\r\n                variant=\"ghost\"\r\n                size=\"icon\"\r\n                onClick={stop}\r\n                aria-label={t(\"chat.input.stop\")}\r\n              >\r\n                <StopCircle className=\"h-5 w-5\" />\r\n              </Button>\r\n            ) : (\r\n              <Button\r\n                type=\"submit\"\r\n                variant=\"ghost\"\r\n                size=\"icon\"\r\n                disabled={\r\n                  (!input.trim() && attachments.length === 0) || isRecording\r\n                }\r\n                aria-label={t(\"chat.input.send\")}\r\n              >\r\n                <SendHorizonal className=\"h-5 w-5\" />\r\n              </Button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name ThumbsDown\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTcgMTRWMiIgLz4KICA8cGF0aCBkPSJNOSAxOC4xMiAxMCAxNEg0LjE3YTIgMiAwIDAgMS0xLjkyLTIuNTZsMi4zMy04QTIgMiAwIDAgMSA2LjUgMkgyMGEyIDIgMCAwIDEgMiAydjhhMiAyIDAgMCAxLTIgMmgtMi43NmEyIDIgMCAwIDAtMS43OSAxLjExTDEyIDIyaDBhMy4xMyAzLjEzIDAgMCAxLTMtMy44OFoiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/thumbs-down\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ThumbsDown = createLucideIcon('ThumbsDown', [\n  ['path', { d: 'M17 14V2', key: '8ymqnk' }],\n  [\n    'path',\n    {\n      d: 'M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22h0a3.13 3.13 0 0 1-3-3.88Z',\n      key: 's6e0r',\n    },\n  ],\n]);\n\nexport default ThumbsDown;\n","'use client'\r\n\r\nimport { Message } from 'ai'\r\nimport { useEffect, useRef } from 'react'\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nimport { UnifiedMessage } from './UnifiedMessage'\r\nimport { UnifiedTypingIndicator } from './UnifiedTypingIndicator'\r\n\r\ninterface UnifiedMessageListProps {\r\n    messages: Message[]\r\n    isLoading?: boolean\r\n    className?: string\r\n    isArtifactVisible?: boolean\r\n    chatId: string\r\n}\r\n\r\nexport function UnifiedMessageList({\r\n    messages,\r\n    isLoading = false,\r\n    className,\r\n    isArtifactVisible = false,\r\n    chatId\r\n}: UnifiedMessageListProps) {\r\n    const messagesEndRef = useRef<HTMLDivElement>(null)\r\n\r\n    // Log messages for debugging\r\n    useEffect(() => {\r\n        console.log('Messages in MessageList:', messages)\r\n    }, [messages])\r\n\r\n    // Scroll to bottom when new messages arrive or when loading state changes\r\n    useEffect(() => {\r\n        if (messagesEndRef.current) {\r\n            messagesEndRef.current.scrollIntoView({ behavior: 'smooth' })\r\n        }\r\n    }, [messages, isLoading])\r\n\r\n    // When artifact panel visibility changes, we need to scroll to see the latest message\r\n    useEffect(() => {\r\n        if (messagesEndRef.current) {\r\n            setTimeout(() => {\r\n                messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' })\r\n            }, 100)\r\n        }\r\n    }, [isArtifactVisible])\r\n\r\n    return (\r\n        <div\r\n            className={cn(\r\n                'flex flex-col gap-4 overflow-y-auto p-4',\r\n                isArtifactVisible ? 'md:pr-[calc(30vw+1rem)]' : '',\r\n                className\r\n            )}\r\n        >\r\n            {messages.length === 0 ? (\r\n                <div className=\"flex flex-1 flex-col items-center justify-center gap-2 p-8 text-center\">\r\n                    <h3 className=\"text-lg font-semibold\">Welcome to AI Chat</h3>\r\n                    <p className=\"text-sm text-muted-foreground\">\r\n                        Ask anything, from complex topics to creative ideas\r\n                    </p>\r\n                </div>\r\n            ) : (\r\n                messages.map((message, index) => (\r\n                    <div key={message.id || index} className=\"message-wrapper\">\r\n                        <UnifiedMessage\r\n                            message={message}\r\n                            isLastMessage={index === messages.length - 1}\r\n                            chatId={chatId}\r\n                        />\r\n                    </div>\r\n                ))\r\n            )}\r\n\r\n            {isLoading && <UnifiedTypingIndicator />}\r\n\r\n            {/* Anchor for scrolling to the latest message */}\r\n            <div ref={messagesEndRef} />\r\n        </div>\r\n    )\r\n} ","\"use client\";\r\n\r\nimport { memo } from \"react\";\r\nimport ReactMarkdown from \"react-markdown\";\r\nimport remarkGfm from \"remark-gfm\";\r\n\r\nimport { cn } from \"@/lib/utils\";\r\n\r\nimport { UnifiedCodeBlock } from \"./UnifiedCodeBlock\";\r\n\r\ninterface UnifiedMarkdownProps {\r\n  content: string;\r\n  className?: string;\r\n}\r\n\r\nexport const UnifiedMarkdown = memo(function UnifiedMarkdown({\r\n  content,\r\n  className,\r\n}: UnifiedMarkdownProps) {\r\n  console.log(\r\n    \"Rendering markdown content:\",\r\n    content ? content.substring(0, 50) + \"...\" : \"undefined or empty\"\r\n  );\r\n\r\n  if (!content) {\r\n    console.warn(\"Empty content in UnifiedMarkdown\");\r\n    return null;\r\n  }\r\n\r\n  return (\r\n    <ReactMarkdown\r\n      className={cn(\"prose dark:prose-invert\", className)}\r\n      remarkPlugins={[remarkGfm]}\r\n      components={{\r\n        pre({ children }) {\r\n          return <>{children}</>;\r\n        },\r\n        code({ node, className, children, ...props }) {\r\n          const match = /language-(\\w+)/.exec(className || \"\");\r\n          const code = String(children).replace(/\\n$/, \"\");\r\n\r\n          if (!match) {\r\n            return (\r\n              <code\r\n                className={cn(\r\n                  \"rounded-md bg-muted px-1 py-0.5 font-mono text-sm\",\r\n                  className\r\n                )}\r\n                {...props}\r\n              >\r\n                {code}\r\n              </code>\r\n            );\r\n          }\r\n\r\n          return (\r\n            <UnifiedCodeBlock\r\n              language={match[1]}\r\n              code={code}\r\n              className={className}\r\n              {...props}\r\n            />\r\n          );\r\n        },\r\n      }}\r\n    >\r\n      {content}\r\n    </ReactMarkdown>\r\n  );\r\n});\r\n","import * as React from \"react\"\r\n\r\nimport { cn } from '@/lib/utils'\r\n\r\nconst Table = React.forwardRef<\r\n    HTMLTableElement,\r\n    React.HTMLAttributes<HTMLTableElement>\r\n>(({ className, ...props }, ref) => (\r\n    <div className=\"relative w-full overflow-auto\">\r\n        <table\r\n            ref={ref}\r\n            className={cn(\"w-full caption-bottom text-sm\", className)}\r\n            {...props}\r\n        />\r\n    </div>\r\n))\r\nTable.displayName = \"Table\"\r\n\r\nconst TableHeader = React.forwardRef<\r\n    HTMLTableSectionElement,\r\n    React.HTMLAttributes<HTMLTableSectionElement>\r\n>(({ className, ...props }, ref) => (\r\n    <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\r\n))\r\nTableHeader.displayName = \"TableHeader\"\r\n\r\nconst TableBody = React.forwardRef<\r\n    HTMLTableSectionElement,\r\n    React.HTMLAttributes<HTMLTableSectionElement>\r\n>(({ className, ...props }, ref) => (\r\n    <tbody\r\n        ref={ref}\r\n        className={cn(\"[&_tr:last-child]:border-0\", className)}\r\n        {...props}\r\n    />\r\n))\r\nTableBody.displayName = \"TableBody\"\r\n\r\nconst TableFooter = React.forwardRef<\r\n    HTMLTableSectionElement,\r\n    React.HTMLAttributes<HTMLTableSectionElement>\r\n>(({ className, ...props }, ref) => (\r\n    <tfoot\r\n        ref={ref}\r\n        className={cn(\r\n            \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\r\n            className\r\n        )}\r\n        {...props}\r\n    />\r\n))\r\nTableFooter.displayName = \"TableFooter\"\r\n\r\nconst TableRow = React.forwardRef<\r\n    HTMLTableRowElement,\r\n    React.HTMLAttributes<HTMLTableRowElement>\r\n>(({ className, ...props }, ref) => (\r\n    <tr\r\n        ref={ref}\r\n        className={cn(\r\n            \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\r\n            className\r\n        )}\r\n        {...props}\r\n    />\r\n))\r\nTableRow.displayName = \"TableRow\"\r\n\r\nconst TableHead = React.forwardRef<\r\n    HTMLTableCellElement,\r\n    React.ThHTMLAttributes<HTMLTableCellElement>\r\n>(({ className, ...props }, ref) => (\r\n    <th\r\n        ref={ref}\r\n        className={cn(\r\n            \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\r\n            className\r\n        )}\r\n        {...props}\r\n    />\r\n))\r\nTableHead.displayName = \"TableHead\"\r\n\r\nconst TableCell = React.forwardRef<\r\n    HTMLTableCellElement,\r\n    React.TdHTMLAttributes<HTMLTableCellElement>\r\n>(({ className, ...props }, ref) => (\r\n    <td\r\n        ref={ref}\r\n        className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\r\n        {...props}\r\n    />\r\n))\r\nTableCell.displayName = \"TableCell\"\r\n\r\nconst TableCaption = React.forwardRef<\r\n    HTMLTableCaptionElement,\r\n    React.HTMLAttributes<HTMLTableCaptionElement>\r\n>(({ className, ...props }, ref) => (\r\n    <caption\r\n        ref={ref}\r\n        className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\r\n        {...props}\r\n    />\r\n))\r\nTableCaption.displayName = \"TableCaption\"\r\n\r\nexport {\r\n    Table,\r\n    TableHeader,\r\n    TableBody,\r\n    TableFooter,\r\n    TableHead,\r\n    TableRow,\r\n    TableCell,\r\n    TableCaption,\r\n} ","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name StopCircle\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIgLz4KICA8cmVjdCB3aWR0aD0iNiIgaGVpZ2h0PSI2IiB4PSI5IiB5PSI5IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/stop-circle\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst StopCircle = createLucideIcon('StopCircle', [\n  ['circle', { cx: '12', cy: '12', r: '10', key: '1mglay' }],\n  ['rect', { width: '6', height: '6', x: '9', y: '9', key: '1wrtvo' }],\n]);\n\nexport default StopCircle;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Settings2\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjAgN2gtOSIgLz4KICA8cGF0aCBkPSJNMTQgMTdINSIgLz4KICA8Y2lyY2xlIGN4PSIxNyIgY3k9IjE3IiByPSIzIiAvPgogIDxjaXJjbGUgY3g9IjciIGN5PSI3IiByPSIzIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/settings-2\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Settings2 = createLucideIcon('Settings2', [\n  ['path', { d: 'M20 7h-9', key: '3s1dr2' }],\n  ['path', { d: 'M14 17H5', key: 'gfn3mx' }],\n  ['circle', { cx: '17', cy: '17', r: '3', key: '18b49y' }],\n  ['circle', { cx: '7', cy: '7', r: '3', key: 'dfmy0x' }],\n]);\n\nexport default Settings2;\n","import React from 'react';\r\n\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport {\r\n    Table,\r\n    TableBody,\r\n    TableCaption,\r\n    TableCell,\r\n    TableHead,\r\n    TableHeader,\r\n    TableRow,\r\n} from \"@/components/ui/table\"; // Assuming Shadcn table path\r\n\r\nimport { BaseArtifactData } from '../index';\r\n\r\ninterface SheetArtifactProps {\r\n    artifact: BaseArtifactData;\r\n}\r\n\r\ninterface SheetContent {\r\n    columns: string[];\r\n    rows: Record<string, any>[];\r\n}\r\n\r\nexport const SheetArtifact: React.FC<SheetArtifactProps> = ({ artifact }) => {\r\n    // Ensure content is in the expected format\r\n    const content = (artifact.content || { columns: [], rows: [] }) as SheetContent;\r\n    const columns = content.columns || [];\r\n    const rows = content.rows || [];\r\n\r\n    return (\r\n        <Card className=\"h-full flex flex-col\">\r\n            <CardHeader>\r\n                <CardTitle>{artifact.title || 'Data Sheet'}</CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"flex-1 overflow-auto\">\r\n                {columns.length > 0 ? (\r\n                    <Table>\r\n                        <TableHeader>\r\n                            <TableRow>\r\n                                {columns.map((col, index) => (\r\n                                    <TableHead key={`header-${index}`}>{col}</TableHead>\r\n                                ))}\r\n                            </TableRow>\r\n                        </TableHeader>\r\n                        <TableBody>\r\n                            {rows.map((row, rowIndex) => (\r\n                                <TableRow key={`row-${rowIndex}`}>\r\n                                    {columns.map((col, colIndex) => (\r\n                                        <TableCell key={`cell-${rowIndex}-${colIndex}`}>\r\n                                            {/* Handle potential non-string values */}\r\n                                            {String(row[col] ?? '')}\r\n                                        </TableCell>\r\n                                    ))}\r\n                                </TableRow>\r\n                            ))}\r\n                        </TableBody>\r\n                        {rows.length === 0 && artifact.status !== 'streaming' && (\r\n                            <TableCaption>No data rows available.</TableCaption>\r\n                        )}\r\n                        {artifact.status === 'streaming' && (\r\n                            <TableCaption>Streaming data...</TableCaption>\r\n                        )}\r\n                    </Table>\r\n                ) : (\r\n                    <p className=\"text-sm text-muted-foreground p-4\">\r\n                        {artifact.status === 'streaming' ? 'Waiting for sheet data...' : 'No sheet data available.'}\r\n                    </p>\r\n                )}\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n}; ","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name ThumbsUp\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNNyAxMHYxMiIgLz4KICA8cGF0aCBkPSJNMTUgNS44OCAxNCAxMGg1LjgzYTIgMiAwIDAgMSAxLjkyIDIuNTZsLTIuMzMgOEEyIDIgMCAwIDEgMTcuNSAyMkg0YTIgMiAwIDAgMS0yLTJ2LThhMiAyIDAgMCAxIDItMmgyLjc2YTIgMiAwIDAgMCAxLjc5LTEuMTFMMTIgMmgwYTMuMTMgMy4xMyAwIDAgMSAzIDMuODhaIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/thumbs-up\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ThumbsUp = createLucideIcon('ThumbsUp', [\n  ['path', { d: 'M7 10v12', key: '1qc93n' }],\n  [\n    'path',\n    {\n      d: 'M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z',\n      key: 'y3tblf',\n    },\n  ],\n]);\n\nexport default ThumbsUp;\n","\"use client\";\r\n\r\nimport { CheckIcon, CopyIcon } from \"lucide-react\";\r\nimport { useState } from \"react\";\r\nimport { Prism as SyntaxHighlighter } from \"react-syntax-highlighter\";\r\n// Using default styling for syntax highlighting\r\n\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\ninterface UnifiedCodeBlockProps {\r\n  language: string;\r\n  code: string;\r\n  className?: string;\r\n}\r\n\r\nexport function UnifiedCodeBlock({\r\n  language,\r\n  code,\r\n  className,\r\n}: UnifiedCodeBlockProps) {\r\n  const [isCopied, setIsCopied] = useState(false);\r\n\r\n  const copyToClipboard = async () => {\r\n    await navigator.clipboard.writeText(code);\r\n    setIsCopied(true);\r\n    setTimeout(() => setIsCopied(false), 2000);\r\n  };\r\n\r\n  return (\r\n    <div className={cn(\"relative my-4 rounded-md bg-muted\", className)}>\r\n      <div className=\"flex items-center justify-between rounded-t-md bg-muted px-4 py-2 font-mono text-xs\">\r\n        <div className=\"text-muted-foreground\">{language}</div>\r\n        <Button\r\n          variant=\"ghost\"\r\n          size=\"icon\"\r\n          className=\"h-7 w-7\"\r\n          onClick={copyToClipboard}\r\n        >\r\n          {isCopied ? (\r\n            <CheckIcon className=\"h-3.5 w-3.5 text-primary\" />\r\n          ) : (\r\n            <CopyIcon className=\"h-3.5 w-3.5\" />\r\n          )}\r\n          <span className=\"sr-only\">Copy code</span>\r\n        </Button>\r\n      </div>\r\n      <SyntaxHighlighter\r\n        language={language}\r\n        customStyle={{ margin: 0, borderRadius: \"0 0 0.375rem 0.375rem\" }}\r\n      >\r\n        {code}\r\n      </SyntaxHighlighter>\r\n    </div>\r\n  );\r\n}\r\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name MicOff\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8bGluZSB4MT0iMiIgeDI9IjIyIiB5MT0iMiIgeTI9IjIyIiAvPgogIDxwYXRoIGQ9Ik0xOC44OSAxMy4yM0E3LjEyIDcuMTIgMCAwIDAgMTkgMTJ2LTIiIC8+CiAgPHBhdGggZD0iTTUgMTB2MmE3IDcgMCAwIDAgMTIgNSIgLz4KICA8cGF0aCBkPSJNMTUgOS4zNFY1YTMgMyAwIDAgMC01LjY4LTEuMzMiIC8+CiAgPHBhdGggZD0iTTkgOXYzYTMgMyAwIDAgMCA1LjEyIDIuMTIiIC8+CiAgPGxpbmUgeDE9IjEyIiB4Mj0iMTIiIHkxPSIxOSIgeTI9IjIyIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/mic-off\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst MicOff = createLucideIcon('MicOff', [\n  ['line', { x1: '2', x2: '22', y1: '2', y2: '22', key: 'a6p6uj' }],\n  ['path', { d: 'M18.89 13.23A7.12 7.12 0 0 0 19 12v-2', key: '80xlxr' }],\n  ['path', { d: 'M5 10v2a7 7 0 0 0 12 5', key: 'p2k8kg' }],\n  ['path', { d: 'M15 9.34V5a3 3 0 0 0-5.68-1.33', key: '1gzdoj' }],\n  ['path', { d: 'M9 9v3a3 3 0 0 0 5.12 2.12', key: 'r2i35w' }],\n  ['line', { x1: '12', x2: '12', y1: '19', y2: '22', key: 'x3vr5v' }],\n]);\n\nexport default MicOff;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name SendHorizontal\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMyAzIDMgOS0zIDkgMTktOVoiIC8+CiAgPHBhdGggZD0iTTYgMTJoMTYiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/send-horizontal\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst SendHorizontal = createLucideIcon('SendHorizontal', [\n  ['path', { d: 'm3 3 3 9-3 9 19-9Z', key: '1aobqy' }],\n  ['path', { d: 'M6 12h16', key: 's4cdu5' }],\n]);\n\nexport default SendHorizontal;\n","\"use client\"\r\n\r\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\r\nimport * as React from \"react\"\r\n\r\nimport { cn } from \"@/lib/utils\"\r\n\r\nfunction Tabs({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof TabsPrimitive.Root>) {\r\n  return (\r\n    <TabsPrimitive.Root\r\n      data-slot=\"tabs\"\r\n      className={cn(\"flex flex-col gap-2\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction TabsList({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof TabsPrimitive.List>) {\r\n  return (\r\n    <TabsPrimitive.List\r\n      data-slot=\"tabs-list\"\r\n      className={cn(\r\n        \"bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction TabsTrigger({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof TabsPrimitive.Trigger>) {\r\n  return (\r\n    <TabsPrimitive.Trigger\r\n      data-slot=\"tabs-trigger\"\r\n      className={cn(\r\n        \"data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\r\n        className\r\n      )}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nfunction TabsContent({\r\n  className,\r\n  ...props\r\n}: React.ComponentProps<typeof TabsPrimitive.Content>) {\r\n  return (\r\n    <TabsPrimitive.Content\r\n      data-slot=\"tabs-content\"\r\n      className={cn(\"flex-1 outline-none\", className)}\r\n      {...props}\r\n    />\r\n  )\r\n}\r\n\r\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\r\n","\"use client\";\r\n\r\nimport { BarChart, Clock, MessageSquare, Users, X } from \"lucide-react\";\r\nimport * as React from \"react\";\r\n\r\nimport { Button } from \"@/components/ui/button\";\r\nimport { Card } from \"@/components/ui/card\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\ninterface ChatAnalyticsProps {\r\n  chatId?: string;\r\n  className?: string;\r\n}\r\n\r\ninterface AnalyticItem {\r\n  label: string;\r\n  value: string | number;\r\n  icon: React.ReactNode;\r\n  description?: string;\r\n}\r\n\r\nexport function ChatAnalytics({ chatId, className }: ChatAnalyticsProps) {\r\n  const [analytics, setAnalytics] = React.useState<AnalyticItem[]>([\r\n    {\r\n      label: \"Total Messages\",\r\n      value: 0,\r\n      icon: <MessageSquare className=\"h-4 w-4\" />,\r\n      description: \"Messages in this session\",\r\n    },\r\n    {\r\n      label: \"Active Users\",\r\n      value: 0,\r\n      icon: <Users className=\"h-4 w-4\" />,\r\n      description: \"Currently active users\",\r\n    },\r\n    {\r\n      label: \"Session Duration\",\r\n      value: \"0m\",\r\n      icon: <Clock className=\"h-4 w-4\" />,\r\n      description: \"Time since session start\",\r\n    },\r\n    {\r\n      label: \"Response Rate\",\r\n      value: \"0%\",\r\n      icon: <BarChart className=\"h-4 w-4\" />,\r\n      description: \"Average response time\",\r\n    },\r\n  ]);\r\n\r\n  // TODO: Implement analytics data fetching\r\n  React.useEffect(() => {\r\n    if (!chatId) return;\r\n\r\n    const fetchAnalytics = async () => {\r\n      try {\r\n        // Fetch analytics data using chatId\r\n        // console.log(`Fetching analytics for chatId: ${chatId}`);\r\n      } catch (error) {\r\n        console.error(\"Error fetching analytics:\", error);\r\n      }\r\n    };\r\n\r\n    fetchAnalytics();\r\n    const interval = setInterval(fetchAnalytics, 30000); // Update every 30s\r\n\r\n    return () => clearInterval(interval);\r\n  }, [chatId]);\r\n\r\n  return (\r\n    <div\r\n      className={cn(\"h-full border-l bg-background overflow-auto\", className)}\r\n    >\r\n      <div className=\"flex items-center justify-between p-4 border-b\">\r\n        <div className=\"flex items-center\">\r\n          <BarChart className=\"h-5 w-5 mr-2\" />\r\n          <h3 className=\"font-semibold\">Analytics</h3>\r\n        </div>\r\n        <Button\r\n          size=\"sm\"\r\n          variant=\"ghost\"\r\n          className=\"h-8 w-8 p-0\"\r\n          onClick={() =>\r\n            document.dispatchEvent(new CustomEvent(\"toggle-analytics\"))\r\n          }\r\n        >\r\n          <X className=\"h-4 w-4\" />\r\n          <span className=\"sr-only\">Close</span>\r\n        </Button>\r\n      </div>\r\n\r\n      <div className=\"p-4\">\r\n        <ScrollArea className=\"h-[calc(100vh-120px)]\">\r\n          <div className=\"grid gap-4\">\r\n            {analytics.map((item, index) => (\r\n              <Card key={index} className=\"p-4\">\r\n                <div className=\"flex items-center gap-4\">\r\n                  <div className=\"rounded-lg bg-muted p-2\">{item.icon}</div>\r\n                  <div className=\"flex-1 space-y-1\">\r\n                    <p className=\"text-sm font-medium leading-none\">\r\n                      {item.label}\r\n                    </p>\r\n                    <p className=\"text-2xl font-bold\">{item.value}</p>\r\n                    {item.description && (\r\n                      <p className=\"text-xs text-muted-foreground\">\r\n                        {item.description}\r\n                      </p>\r\n                    )}\r\n                  </div>\r\n                </div>\r\n              </Card>\r\n            ))}\r\n          </div>\r\n        </ScrollArea>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name ExternalLink\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTUgM2g2djYiIC8+CiAgPHBhdGggZD0iTTEwIDE0IDIxIDMiIC8+CiAgPHBhdGggZD0iTTE4IDEzdjZhMiAyIDAgMCAxLTIgMkg1YTIgMiAwIDAgMS0yLTJWOGEyIDIgMCAwIDEgMi0yaDYiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/external-link\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ExternalLink = createLucideIcon('ExternalLink', [\n  ['path', { d: 'M15 3h6v6', key: '1q9fwt' }],\n  ['path', { d: 'M10 14 21 3', key: 'gplh6r' }],\n  ['path', { d: 'M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6', key: 'a6xqqp' }],\n]);\n\nexport default ExternalLink;\n","'use client'\r\n\r\nimport { type Message } from 'ai'\r\nimport { Copy, MoreVertical, ThumbsDown, ThumbsUp, Check } from 'lucide-react'\r\nimport { useState, useEffect } from 'react'\r\nimport remarkGfm from 'remark-gfm'\r\n\r\nimport { Avatar, AvatarFallback, AvatarImage } from '@/components/ui/avatar'\r\nimport { Button } from '@/components/ui/button'\r\nimport {\r\n    DropdownMenu,\r\n    DropdownMenuContent,\r\n    DropdownMenuItem,\r\n    DropdownMenuTrigger,\r\n} from '@/components/ui/dropdown-menu'\r\nimport { useToast } from '@/components/ui/use-toast'\r\nimport { cn } from '@/lib/utils'\r\n\r\nimport { UnifiedMarkdown } from './UnifiedMarkdown'\r\n\r\n\r\n\r\n\r\ninterface UnifiedMessageProps {\r\n    message: Message\r\n    isLastMessage?: boolean\r\n    chatId: string\r\n}\r\n\r\nexport function UnifiedMessage({ message, isLastMessage, chatId }: UnifiedMessageProps) {\r\n    const { toast } = useToast()\r\n    const [feedback, setFeedback] = useState<'liked' | 'disliked' | null>(null)\r\n    const [isCopied, setIsCopied] = useState(false)\r\n    const isUser = message.role === 'user'\r\n\r\n    // Debug message rendering\r\n    useEffect(() => {\r\n        console.log('Rendering message:', message.id, message.content.substring(0, 50))\r\n    }, [message.id, message.content])\r\n\r\n    const copyToClipboard = async () => {\r\n        try {\r\n            await navigator.clipboard.writeText(message.content)\r\n            setIsCopied(true)\r\n            setTimeout(() => setIsCopied(false), 2000)\r\n            toast({\r\n                title: 'Copied to clipboard',\r\n                description: 'Message content copied to clipboard',\r\n            })\r\n        } catch (error) {\r\n            toast({\r\n                title: 'Failed to copy',\r\n                description: 'Could not copy message to clipboard',\r\n                variant: 'destructive',\r\n            })\r\n        }\r\n    }\r\n\r\n    const submitFeedback = async (type: 'like' | 'dislike') => {\r\n        try {\r\n            // Only allow feedback on assistant messages\r\n            if (message.role !== 'assistant') return\r\n\r\n            const newFeedback = type === 'like' ? 'liked' : 'disliked'\r\n\r\n            // Toggle feedback if already selected\r\n            if (feedback === newFeedback) {\r\n                setFeedback(null)\r\n            } else {\r\n                setFeedback(newFeedback)\r\n            }\r\n\r\n            const response = await fetch('/api/chat/feedback', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({\r\n                    messageId: message.id,\r\n                    chatId,\r\n                    type,\r\n                }),\r\n            })\r\n\r\n            if (!response.ok) {\r\n                throw new Error('Failed to submit feedback')\r\n            }\r\n        } catch (error) {\r\n            toast({\r\n                title: 'Error',\r\n                description: 'Failed to submit feedback',\r\n                variant: 'destructive',\r\n            })\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div\r\n            className={cn(\r\n                'flex w-full gap-3 group relative',\r\n                isUser ? 'flex-row-reverse' : 'flex-row'\r\n            )}\r\n            id={message.id}\r\n        >\r\n            {/* Avatar */}\r\n            <div className=\"flex h-8 w-8 shrink-0 select-none items-center justify-center rounded-md border bg-background shadow\">\r\n                {isUser ? (\r\n                    <Avatar>\r\n                        <AvatarFallback>U</AvatarFallback>\r\n                    </Avatar>\r\n                ) : (\r\n                    <Avatar>\r\n                        <AvatarImage src=\"/bot-avatar.png\" alt=\"AI\" />\r\n                        <AvatarFallback>AI</AvatarFallback>\r\n                    </Avatar>\r\n                )}\r\n            </div>\r\n\r\n            {/* Message Content */}\r\n            <div className={cn(\r\n                'flex flex-col gap-1 min-w-0 max-w-[calc(100%-4rem)]',\r\n                isUser ? 'items-end' : 'items-start'\r\n            )}>\r\n                <div className={cn(\r\n                    'flex flex-col gap-2 rounded-lg px-4 py-2.5 text-sm',\r\n                    isUser ? 'bg-primary text-primary-foreground' : 'bg-muted'\r\n                )}>\r\n                    <UnifiedMarkdown\r\n                        content={message.content}\r\n                        className={isUser ? 'prose-invert' : ''}\r\n                    />\r\n                </div>\r\n\r\n                {/* Show action buttons for assistant messages */}\r\n                {!isUser && (\r\n                    <div className=\"flex items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                        <Button\r\n                            variant=\"ghost\"\r\n                            size=\"icon\"\r\n                            className={cn(\r\n                                'h-7 w-7',\r\n                                feedback === 'liked' ? 'text-green-500' : 'text-muted-foreground'\r\n                            )}\r\n                            onClick={() => submitFeedback('like')}\r\n                        >\r\n                            <ThumbsUp className=\"h-4 w-4\" />\r\n                        </Button>\r\n                        <Button\r\n                            variant=\"ghost\"\r\n                            size=\"icon\"\r\n                            className={cn(\r\n                                'h-7 w-7',\r\n                                feedback === 'disliked' ? 'text-red-500' : 'text-muted-foreground'\r\n                            )}\r\n                            onClick={() => submitFeedback('dislike')}\r\n                        >\r\n                            <ThumbsDown className=\"h-4 w-4\" />\r\n                        </Button>\r\n                        <DropdownMenu>\r\n                            <DropdownMenuTrigger asChild>\r\n                                <Button variant=\"ghost\" size=\"icon\" className=\"h-7 w-7 text-muted-foreground\">\r\n                                    <MoreVertical className=\"h-4 w-4\" />\r\n                                </Button>\r\n                            </DropdownMenuTrigger>\r\n                            <DropdownMenuContent align=\"end\">\r\n                                <DropdownMenuItem onClick={copyToClipboard}>\r\n                                    {isCopied ? (\r\n                                        <Check className=\"mr-2 h-4 w-4 text-green-500\" />\r\n                                    ) : (\r\n                                        <Copy className=\"mr-2 h-4 w-4\" />\r\n                                    )}\r\n                                    Copy Message\r\n                                </DropdownMenuItem>\r\n                            </DropdownMenuContent>\r\n                        </DropdownMenu>\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    )\r\n} ","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Mic\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTIgMmEzIDMgMCAwIDAtMyAzdjdhMyAzIDAgMCAwIDYgMFY1YTMgMyAwIDAgMC0zLTNaIiAvPgogIDxwYXRoIGQ9Ik0xOSAxMHYyYTcgNyAwIDAgMS0xNCAwdi0yIiAvPgogIDxsaW5lIHgxPSIxMiIgeDI9IjEyIiB5MT0iMTkiIHkyPSIyMiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/mic\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Mic = createLucideIcon('Mic', [\n  ['path', { d: 'M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z', key: '131961' }],\n  ['path', { d: 'M19 10v2a7 7 0 0 1-14 0v-2', key: '1vc78b' }],\n  ['line', { x1: '12', x2: '12', y1: '19', y2: '22', key: 'x3vr5v' }],\n]);\n\nexport default Mic;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Trash\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMyA2aDE4IiAvPgogIDxwYXRoIGQ9Ik0xOSA2djE0YzAgMS0xIDItMiAySDdjLTEgMC0yLTEtMi0yVjYiIC8+CiAgPHBhdGggZD0iTTggNlY0YzAtMSAxLTIgMi0yaDRjMSAwIDIgMSAyIDJ2MiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/trash\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Trash = createLucideIcon('Trash', [\n  ['path', { d: 'M3 6h18', key: 'd0wm0j' }],\n  ['path', { d: 'M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6', key: '4alrt4' }],\n  ['path', { d: 'M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2', key: 'v07s0e' }],\n]);\n\nexport default Trash;\n","\"use client\";\r\n\r\nimport { Message } from \"ai\";\r\nimport {\r\n  InfoIcon,\r\n  ExternalLink,\r\n  FileText,\r\n  BookOpen,\r\n  Search,\r\n  X,\r\n} from \"lucide-react\";\r\nimport { useState, useEffect } from \"react\";\r\n\r\nimport { Alert, AlertTitle, AlertDescription } from \"@/components/ui/alert\";\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n  Card,\r\n  CardHeader,\r\n  CardTitle,\r\n  CardDescription,\r\n  CardContent,\r\n} from \"@/components/ui/card\";\r\nimport { Progress } from \"@/components/ui/progress\";\r\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\r\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\r\n\r\nimport { UnifiedMarkdown } from \"./UnifiedMarkdown\";\r\n\r\n// Types for research data\r\ninterface SourceData {\r\n  url: string;\r\n  title: string;\r\n  description: string;\r\n  type: \"web\" | \"pdf\" | \"document\" | \"database\";\r\n  relevance: number;\r\n}\r\n\r\ninterface ActivityData {\r\n  type:\r\n    | \"search\"\r\n    | \"extract\"\r\n    | \"analyze\"\r\n    | \"reasoning\"\r\n    | \"synthesis\"\r\n    | \"thought\";\r\n  message: string;\r\n  status: \"pending\" | \"complete\" | \"error\";\r\n  depth: number;\r\n  timestamp: number;\r\n}\r\n\r\ninterface ResearchDepth {\r\n  current: number;\r\n  max: number;\r\n}\r\n\r\ninterface ResearchProgress {\r\n  completedSteps: number;\r\n  totalSteps: number;\r\n}\r\n\r\ninterface FindingData {\r\n  content: string;\r\n  confidence: number;\r\n  sources: string[];\r\n  timestamp: number;\r\n}\r\n\r\ninterface UnifiedResearchContainerProps {\r\n  chatId: string;\r\n  messages: Message[];\r\n  append: (message: Message | Message[]) => Promise<void>;\r\n  isLoading: boolean;\r\n  isVisible: boolean;\r\n  className?: string;\r\n}\r\n\r\nexport function UnifiedResearchContainer({\r\n  chatId,\r\n  messages,\r\n  append,\r\n  isLoading,\r\n  isVisible,\r\n  className,\r\n}: UnifiedResearchContainerProps) {\r\n  const [sources, setSources] = useState<SourceData[]>([]);\r\n  const [activities, setActivities] = useState<ActivityData[]>([]);\r\n  const [findings, setFindings] = useState<FindingData[]>([]);\r\n  const [depth, setDepth] = useState<ResearchDepth>({ current: 0, max: 3 });\r\n  const [progress, setProgress] = useState<ResearchProgress>({\r\n    completedSteps: 0,\r\n    totalSteps: 0,\r\n  });\r\n  const [activeTab, setActiveTab] = useState(\"sources\");\r\n  const [isResearching, setIsResearching] = useState(false);\r\n\r\n  // Load data from sessionStorage on initial render\r\n  useEffect(() => {\r\n    if (!chatId) return;\r\n\r\n    const storedSources = sessionStorage.getItem(`sources-${chatId}`);\r\n    const storedActivities = sessionStorage.getItem(`activities-${chatId}`);\r\n    const storedDepth = sessionStorage.getItem(`depth-${chatId}`);\r\n    const storedProgress = sessionStorage.getItem(`progress-${chatId}`);\r\n    const storedFindings = sessionStorage.getItem(`findings-${chatId}`);\r\n\r\n    if (storedSources) setSources(JSON.parse(storedSources));\r\n    if (storedActivities) setActivities(JSON.parse(storedActivities));\r\n    if (storedDepth) setDepth(JSON.parse(storedDepth));\r\n    if (storedProgress) setProgress(JSON.parse(storedProgress));\r\n    if (storedFindings) setFindings(JSON.parse(storedFindings));\r\n  }, [chatId]);\r\n\r\n  // Save data to sessionStorage when it changes\r\n  useEffect(() => {\r\n    if (!chatId) return;\r\n\r\n    sessionStorage.setItem(`sources-${chatId}`, JSON.stringify(sources));\r\n    sessionStorage.setItem(`activities-${chatId}`, JSON.stringify(activities));\r\n    sessionStorage.setItem(`depth-${chatId}`, JSON.stringify(depth));\r\n    sessionStorage.setItem(`progress-${chatId}`, JSON.stringify(progress));\r\n    sessionStorage.setItem(`findings-${chatId}`, JSON.stringify(findings));\r\n  }, [chatId, sources, activities, depth, progress, findings]);\r\n\r\n  // Calculate progress percentage\r\n  const progressPercentage =\r\n    progress.totalSteps > 0\r\n      ? Math.round((progress.completedSteps / progress.totalSteps) * 100)\r\n      : 0;\r\n\r\n  // Start research based on the current chat messages\r\n  const startResearch = async () => {\r\n    if (isResearching || isLoading) return;\r\n\r\n    setIsResearching(true);\r\n\r\n    // Reset research state\r\n    const newActivities: ActivityData[] = [\r\n      {\r\n        type: \"search\",\r\n        message: \"Starting research based on chat conversation\",\r\n        status: \"pending\",\r\n        depth: 1,\r\n        timestamp: Date.now(),\r\n      },\r\n    ];\r\n\r\n    setActivities(newActivities);\r\n    setProgress({ completedSteps: 0, totalSteps: 5 });\r\n    setDepth({ current: 1, max: 3 });\r\n\r\n    // Extract research query from messages\r\n    const lastUserMessage = [...messages]\r\n      .reverse()\r\n      .find((m) => m.role === \"user\");\r\n    const researchQuery = lastUserMessage?.content || \"Research this topic\";\r\n\r\n    // Create a system message to instruct AI to perform research\r\n    const systemMessage = {\r\n      id: Date.now().toString(),\r\n      role: \"system\" as const,\r\n      content: `Perform deep research on: ${researchQuery}. \r\n      Format your response as a JSON object with the following keys:\r\n      - sources: array of source objects {url, title, description, type, relevance}\r\n      - activities: array of research activity objects {type, message, status, depth}\r\n      - findings: array of finding objects {content, confidence, sources}`,\r\n    };\r\n\r\n    // Append system message requesting research\r\n    await append(systemMessage);\r\n\r\n    // After AI response, update research data\r\n    // This would be handled by a real API in production\r\n    // For demo, we'll add some mock data with timeouts\r\n    simulateResearchProgress();\r\n  };\r\n\r\n  // Simulate research progress with timeouts\r\n  const simulateResearchProgress = () => {\r\n    // Mark first activity as complete\r\n    setTimeout(() => {\r\n      setActivities((prev) => [\r\n        { ...prev[0], status: \"complete\" },\r\n        {\r\n          type: \"search\",\r\n          message: \"Searching for relevant immigration resources\",\r\n          status: \"pending\",\r\n          depth: 1,\r\n          timestamp: Date.now(),\r\n        },\r\n      ]);\r\n      setProgress((prev) => ({ ...prev, completedSteps: 1 }));\r\n\r\n      // Add a mock source\r\n      setSources([\r\n        {\r\n          url: \"https://travel.state.gov/content/travel/en/us-visas.html\",\r\n          title: \"U.S. Visas - United States Department of State\",\r\n          description:\r\n            \"Official U.S. visa information from the Department of State\",\r\n          type: \"web\",\r\n          relevance: 0.95,\r\n        },\r\n      ]);\r\n    }, 2000);\r\n\r\n    // Continue adding activities and sources\r\n    setTimeout(() => {\r\n      setActivities((prev) => [\r\n        ...prev.slice(0, 1),\r\n        { ...prev[1], status: \"complete\" },\r\n        {\r\n          type: \"extract\",\r\n          message: \"Extracting key information from visa resources\",\r\n          status: \"pending\",\r\n          depth: 1,\r\n          timestamp: Date.now(),\r\n        },\r\n      ]);\r\n      setProgress((prev) => ({ ...prev, completedSteps: 2 }));\r\n\r\n      // Add more sources\r\n      setSources((prev) => [\r\n        ...prev,\r\n        {\r\n          url: \"https://www.uscis.gov/green-card\",\r\n          title: \"Green Card Eligibility Categories\",\r\n          description: \"Information about permanent residence eligibility\",\r\n          type: \"web\",\r\n          relevance: 0.9,\r\n        },\r\n      ]);\r\n    }, 4000);\r\n\r\n    // Add synthesis and findings\r\n    setTimeout(() => {\r\n      setActivities((prev) => [\r\n        ...prev.slice(0, 2),\r\n        { ...prev[2], status: \"complete\" },\r\n        {\r\n          type: \"synthesis\",\r\n          message: \"Synthesizing immigration pathway information\",\r\n          status: \"pending\",\r\n          depth: 2,\r\n          timestamp: Date.now(),\r\n        },\r\n      ]);\r\n      setProgress((prev) => ({ ...prev, completedSteps: 3 }));\r\n      setDepth((prev) => ({ ...prev, current: 2 }));\r\n\r\n      // Add a finding\r\n      setFindings([\r\n        {\r\n          content:\r\n            \"There are multiple pathways to immigrate to the United States, including family-sponsored, employment-based, and humanitarian programs.\",\r\n          confidence: 0.9,\r\n          sources: [\"U.S. Visas - United States Department of State\"],\r\n          timestamp: Date.now(),\r\n        },\r\n      ]);\r\n    }, 6000);\r\n\r\n    // Complete research\r\n    setTimeout(() => {\r\n      setActivities((prev) => [\r\n        ...prev.slice(0, 3),\r\n        { ...prev[3], status: \"complete\" },\r\n      ]);\r\n      setProgress((prev) => ({ ...prev, completedSteps: 4 }));\r\n\r\n      // Add more findings\r\n      setFindings((prev) => [\r\n        ...prev,\r\n        {\r\n          content:\r\n            \"Employment-based immigration typically requires employer sponsorship and may involve labor certification.\",\r\n          confidence: 0.85,\r\n          sources: [\"Green Card Eligibility Categories\"],\r\n          timestamp: Date.now(),\r\n        },\r\n      ]);\r\n\r\n      setIsResearching(false);\r\n    }, 8000);\r\n  };\r\n\r\n  if (!isVisible) return null;\r\n\r\n  // If no data is available yet, show a start screen\r\n  if (sources.length === 0 && activities.length === 0) {\r\n    return (\r\n      <div\r\n        className={`h-full border-l bg-background overflow-auto ${className}`}\r\n      >\r\n        <div className=\"flex items-center justify-between p-4 border-b\">\r\n          <div className=\"flex items-center\">\r\n            <BookOpen className=\"h-5 w-5 mr-2\" />\r\n            <h3 className=\"font-semibold\">Research Assistant</h3>\r\n          </div>\r\n          <Button\r\n            size=\"sm\"\r\n            variant=\"ghost\"\r\n            className=\"h-8 w-8 p-0\"\r\n            onClick={() =>\r\n              document.dispatchEvent(new CustomEvent(\"toggle-research\"))\r\n            }\r\n          >\r\n            <X className=\"h-4 w-4\" />\r\n            <span className=\"sr-only\">Close</span>\r\n          </Button>\r\n        </div>\r\n        <div className=\"p-4\">\r\n          <Alert>\r\n            <InfoIcon className=\"h-4 w-4\" />\r\n            <AlertTitle>Research Assistant</AlertTitle>\r\n            <AlertDescription>\r\n              Start a deep research session based on your chat conversation.\r\n            </AlertDescription>\r\n          </Alert>\r\n\r\n          <Button\r\n            onClick={startResearch}\r\n            disabled={isResearching || isLoading}\r\n            className=\"w-full mt-4\"\r\n          >\r\n            {isResearching ? \"Researching...\" : \"Start Research\"}\r\n          </Button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className={`h-full border-l bg-background overflow-auto ${className}`}>\r\n      <div className=\"flex items-center justify-between p-4 border-b\">\r\n        <div className=\"flex items-center\">\r\n          <BookOpen className=\"h-5 w-5 mr-2\" />\r\n          <h3 className=\"font-semibold\">Research Assistant</h3>\r\n        </div>\r\n        <Button\r\n          size=\"sm\"\r\n          variant=\"ghost\"\r\n          className=\"h-8 w-8 p-0\"\r\n          onClick={() =>\r\n            document.dispatchEvent(new CustomEvent(\"toggle-research\"))\r\n          }\r\n        >\r\n          <X className=\"h-4 w-4\" />\r\n          <span className=\"sr-only\">Close</span>\r\n        </Button>\r\n      </div>\r\n      <div className=\"p-4 space-y-4\">\r\n        <div className=\"flex items-center gap-4\">\r\n          <div className=\"flex-1\">\r\n            <Progress value={progressPercentage} className=\"h-2\" />\r\n          </div>\r\n          <div className=\"text-sm text-muted-foreground whitespace-nowrap\">\r\n            {progress.completedSteps} / {progress.totalSteps} steps\r\n          </div>\r\n        </div>\r\n\r\n        {depth.max > 0 && (\r\n          <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\r\n            <span>Research depth:</span>\r\n            <div className=\"flex-1\">\r\n              <Progress\r\n                value={(depth.current / depth.max) * 100}\r\n                className=\"h-1\"\r\n              />\r\n            </div>\r\n            <span>\r\n              {depth.current} / {depth.max}\r\n            </span>\r\n          </div>\r\n        )}\r\n\r\n        <Tabs defaultValue=\"sources\" className=\"w-full\">\r\n          <TabsList className=\"grid w-full grid-cols-3\">\r\n            <TabsTrigger value=\"sources\">\r\n              Sources ({sources.length})\r\n            </TabsTrigger>\r\n            <TabsTrigger value=\"activities\">\r\n              Activities ({activities.length})\r\n            </TabsTrigger>\r\n            <TabsTrigger value=\"findings\">\r\n              Findings ({findings.length})\r\n            </TabsTrigger>\r\n          </TabsList>\r\n\r\n          <TabsContent value=\"sources\" className=\"mt-2\">\r\n            <Card>\r\n              <CardHeader className=\"pb-2\">\r\n                <CardTitle className=\"text-base\">Research Sources</CardTitle>\r\n                <CardDescription>\r\n                  Web pages and documents used in this research\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <ScrollArea className=\"h-[300px] pr-4\">\r\n                  <div className=\"space-y-4\">\r\n                    {sources.map((source, index) => (\r\n                      <div key={index} className=\"flex flex-col space-y-1\">\r\n                        <div className=\"flex items-start\">\r\n                          <div className=\"mr-2 mt-0.5\">\r\n                            <FileText className=\"h-4 w-4 text-muted-foreground\" />\r\n                          </div>\r\n                          <div className=\"flex-1\">\r\n                            <div className=\"font-medium text-blue-600 dark:text-blue-400 hover:underline flex items-center\">\r\n                              {source.title}\r\n                              <ExternalLink className=\"ml-1 h-3 w-3\" />\r\n                            </div>\r\n                            <p className=\"text-sm text-muted-foreground\">\r\n                              {source.description}\r\n                            </p>\r\n                          </div>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </ScrollArea>\r\n              </CardContent>\r\n            </Card>\r\n          </TabsContent>\r\n\r\n          <TabsContent value=\"activities\" className=\"mt-2\">\r\n            <Card>\r\n              <CardHeader className=\"pb-2\">\r\n                <CardTitle className=\"text-base\">Research Activities</CardTitle>\r\n                <CardDescription>\r\n                  Steps taken during the research process\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <ScrollArea className=\"h-[300px] pr-4\">\r\n                  <div className=\"space-y-4\">\r\n                    {activities.map((activity, index) => (\r\n                      <div\r\n                        key={index}\r\n                        className=\"flex items-start pb-2 border-b border-muted last:border-0\"\r\n                      >\r\n                        <div className=\"mr-2 mt-1\">\r\n                          {activity.type === \"search\" && (\r\n                            <Search className=\"h-4 w-4 text-blue-500\" />\r\n                          )}\r\n                          {activity.type === \"extract\" && (\r\n                            <FileText className=\"h-4 w-4 text-green-500\" />\r\n                          )}\r\n                          {activity.type === \"analyze\" && (\r\n                            <BookOpen className=\"h-4 w-4 text-amber-500\" />\r\n                          )}\r\n                          {activity.type === \"reasoning\" && (\r\n                            <InfoIcon className=\"h-4 w-4 text-indigo-500\" />\r\n                          )}\r\n                          {(activity.type === \"synthesis\" ||\r\n                            activity.type === \"thought\") && (\r\n                            <BookOpen className=\"h-4 w-4 text-purple-500\" />\r\n                          )}\r\n                        </div>\r\n                        <div className=\"flex-1\">\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <Badge\r\n                              variant={\r\n                                activity.status === \"complete\"\r\n                                  ? \"default\"\r\n                                  : activity.status === \"pending\"\r\n                                    ? \"outline\"\r\n                                    : \"destructive\"\r\n                              }\r\n                              className=\"text-xs font-normal\"\r\n                            >\r\n                              {activity.status}\r\n                            </Badge>\r\n                            <span className=\"text-xs text-muted-foreground\">\r\n                              Depth: {activity.depth}\r\n                            </span>\r\n                          </div>\r\n                          <p className=\"mt-1 text-sm\">{activity.message}</p>\r\n                        </div>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </ScrollArea>\r\n              </CardContent>\r\n            </Card>\r\n          </TabsContent>\r\n\r\n          <TabsContent value=\"findings\" className=\"mt-2\">\r\n            <Card>\r\n              <CardHeader className=\"pb-2\">\r\n                <CardTitle className=\"text-base\">Research Findings</CardTitle>\r\n                <CardDescription>\r\n                  Key insights discovered during research\r\n                </CardDescription>\r\n              </CardHeader>\r\n              <CardContent>\r\n                <ScrollArea className=\"h-[300px] pr-4\">\r\n                  {findings.length > 0 ? (\r\n                    <div className=\"space-y-4\">\r\n                      {findings.map((finding, index) => (\r\n                        <div\r\n                          key={index}\r\n                          className=\"border-b pb-4 last:border-0 last:pb-0\"\r\n                        >\r\n                          <p className=\"text-sm mb-2\">{finding.content}</p>\r\n                          <div className=\"flex text-xs text-muted-foreground gap-2\">\r\n                            <span>\r\n                              Confidence:{\" \"}\r\n                              {(finding.confidence * 100).toFixed(0)}%\r\n                            </span>\r\n                            <span>Sources: {finding.sources.join(\", \")}</span>\r\n                          </div>\r\n                        </div>\r\n                      ))}\r\n                    </div>\r\n                  ) : (\r\n                    <div className=\"text-center py-8 text-muted-foreground\">\r\n                      Research findings will appear here when completed.\r\n                    </div>\r\n                  )}\r\n                </ScrollArea>\r\n              </CardContent>\r\n            </Card>\r\n          </TabsContent>\r\n        </Tabs>\r\n\r\n        {isResearching && (\r\n          <div className=\"text-center text-sm text-muted-foreground\">\r\n            AI is performing deep research...\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n","\"use client\";\r\n\r\nimport {\r\n  Copy,\r\n  Share2,\r\n  Lock,\r\n  Globe,\r\n  Users,\r\n  ChevronDown,\r\n  Archive,\r\n  Trash,\r\n  File,\r\n  FileText,\r\n  BookOpen,\r\n  Search,\r\n  Database as DatabaseIcon,\r\n  ScanSearch,\r\n  Globe2,\r\n  PlusCircle,\r\n  MessageSquare,\r\n  Settings2,\r\n  BarChartHorizontal,\r\n  Pencil,\r\n  Download,\r\n} from \"lucide-react\";\r\nimport React, { useState, useEffect, useCallback } from \"react\";\r\n\r\nimport { Badge } from \"@/components/ui/badge\";\r\nimport { Button } from \"@/components/ui/button\";\r\nimport {\r\n  DropdownMenu,\r\n  DropdownMenuContent,\r\n  DropdownMenuItem,\r\n  DropdownMenuLabel,\r\n  DropdownMenuSeparator,\r\n  DropdownMenuTrigger,\r\n  DropdownMenuRadioGroup,\r\n  DropdownMenuRadioItem,\r\n} from \"@/components/ui/dropdown-menu\";\r\nimport { Input } from \"@/components/ui/input\";\r\nimport {\r\n  Tooltip,\r\n  TooltipContent,\r\n  TooltipProvider,\r\n  TooltipTrigger,\r\n} from \"@/components/ui/tooltip\";\r\nimport { useToast } from \"@/components/ui/use-toast\";\r\nimport { useAuth } from \"@/lib/auth/hooks\";\r\nimport {\r\n  useSupabaseBrowser,\r\n  type TypedSSRSupabaseClient,\r\n} from \"@/lib/supabase/client\";\r\nimport { cn } from \"@/lib/utils\";\r\nimport type { Database } from \"@/types/supabase\";\r\n// import { ChatHistory } from \"@/components/ui/chat-history\"; // Commented out - Component not found\r\n\r\nexport const chatVisibilityOptions = [\r\n  {\r\n    value: \"private\",\r\n    label: \"Private\",\r\n    icon: Lock,\r\n    description: \"Only you can view this chat\",\r\n  },\r\n  {\r\n    value: \"public\",\r\n    label: \"Public\",\r\n    icon: Globe,\r\n    description: \"Anyone with the link can view this chat\",\r\n  },\r\n  {\r\n    value: \"team\",\r\n    label: \"Team\",\r\n    icon: Users,\r\n    description: \"Your team members can view this chat\",\r\n  },\r\n];\r\n\r\nconst availableModels = [\r\n  { value: \"gpt-4o\", label: \"GPT-4o\" },\r\n  { value: \"gpt-3.5-turbo\", label: \"GPT-3.5 Turbo\" },\r\n];\r\n\r\ninterface ChatSession {\r\n  id: string;\r\n  title: string;\r\n  created_at: string;\r\n  is_archived?: boolean;\r\n  // Add other fields as needed to match API response\r\n  user_id?: string;\r\n  model?: string;\r\n  visibility?: string;\r\n  updated_at?: string;\r\n}\r\n\r\ninterface UnifiedChatHeaderProps {\r\n  chatId: string;\r\n  initialTitle: string;\r\n  selectedModel: string;\r\n  selectedVisibility: string;\r\n  onModelChange: (model: string) => void;\r\n  onVisibilityChange: (visibility: string) => void;\r\n  /**\r\n   * Callback fired when the chat title is successfully updated in the database.\r\n   * Used by the parent container to keep local state in sync without an extra fetch.\r\n   */\r\n  onTitleChange?: (newTitle: string) => void;\r\n  onNewSession: () => void;\r\n  onSessionChange: (sessionId: string) => void;\r\n  isReadonly?: boolean;\r\n  toggleArtifact?: () => void;\r\n  isArtifactVisible?: boolean;\r\n  toggleResearch?: () => void;\r\n  isResearchVisible?: boolean;\r\n  toggleDocumentProcessor?: () => void;\r\n  isDocumentProcessorVisible?: boolean;\r\n  toggleWebScraper?: () => void;\r\n  isWebScraperVisible?: boolean;\r\n  toggleAnalytics?: () => void;\r\n  isAnalyticsVisible?: boolean;\r\n}\r\n\r\nexport function UnifiedChatHeader({\r\n  chatId,\r\n  initialTitle,\r\n  selectedModel,\r\n  selectedVisibility,\r\n  onModelChange,\r\n  onVisibilityChange,\r\n  onTitleChange,\r\n  onNewSession,\r\n  onSessionChange,\r\n  isReadonly = false,\r\n  toggleArtifact,\r\n  isArtifactVisible = false,\r\n  toggleResearch,\r\n  isResearchVisible = false,\r\n  toggleDocumentProcessor,\r\n  isDocumentProcessorVisible = false,\r\n  toggleWebScraper,\r\n  isWebScraperVisible = false,\r\n  toggleAnalytics,\r\n  isAnalyticsVisible = false,\r\n}: UnifiedChatHeaderProps) {\r\n  const { user } = useAuth();\r\n  const { toast } = useToast();\r\n  const supabase = useSupabaseBrowser();\r\n  const [sessions, setSessions] = useState<ChatSession[]>([]);\r\n  const [isLoadingSessions, setIsLoadingSessions] = useState(false);\r\n  const [isCopying, setIsCopying] = useState(false);\r\n  const [isSharing, setIsSharing] = useState(false);\r\n  const [isArchiving, setIsArchiving] = useState(false);\r\n  const [isUnarchiving, setIsUnarchiving] = useState(false);\r\n  const [isDeleting, setIsDeleting] = useState(false);\r\n  const [isEditingTitle, setIsEditingTitle] = useState(false);\r\n  const [currentTitle, setCurrentTitle] = useState(initialTitle);\r\n  const [isSavingTitle, setIsSavingTitle] = useState(false);\r\n  const [currentChatIsArchived, setCurrentChatIsArchived] = useState(false);\r\n\r\n  useEffect(() => {\r\n    setCurrentTitle(initialTitle);\r\n  }, [initialTitle]);\r\n\r\n  useEffect(() => {\r\n    const fetchSessions = async () => {\r\n      setIsLoadingSessions(true);\r\n      console.log(\r\n        \"[UnifiedChatHeader] Fetching sessions via API for chatId:\",\r\n        chatId\r\n      );\r\n      try {\r\n        const sessionApiUrl = \"/api/chat?limit=50\";\r\n        console.log(\r\n          `[UnifiedChatHeader] Fetching sessions from: ${sessionApiUrl}`\r\n        );\r\n\r\n        // Get the current session token for auth\r\n        const supabaseAuth = await supabase?.auth.getSession();\r\n        const accessToken = supabaseAuth?.data?.session?.access_token;\r\n\r\n        const headers: Record<string, string> = {};\r\n        if (accessToken) {\r\n          headers[\"Authorization\"] = `Bearer ${accessToken}`;\r\n          console.log(\"[UnifiedChatHeader] Using auth token for request\");\r\n        } else {\r\n          console.warn(\r\n            \"[UnifiedChatHeader] No auth token available for request!\"\r\n          );\r\n          if (supabase) {\r\n            // Try to refresh the session to get a new token\r\n            console.log(\r\n              \"[UnifiedChatHeader] Attempting to refresh auth session\"\r\n            );\r\n            const { error } = await supabase.auth.refreshSession();\r\n            if (error) {\r\n              throw new Error(`Auth session refresh failed: ${error.message}`);\r\n            }\r\n            // Get the refreshed session\r\n            const refreshed = await supabase.auth.getSession();\r\n            const newToken = refreshed?.data?.session?.access_token;\r\n            if (newToken) {\r\n              headers[\"Authorization\"] = `Bearer ${newToken}`;\r\n              console.log(\"[UnifiedChatHeader] Using refreshed auth token\");\r\n            } else {\r\n              throw new Error(\r\n                \"Failed to obtain a valid auth token after refresh\"\r\n              );\r\n            }\r\n          } else {\r\n            throw new Error(\"Supabase client not available\");\r\n          }\r\n        }\r\n\r\n        const response = await fetch(sessionApiUrl, {\r\n          headers,\r\n        });\r\n\r\n        if (!response.ok) {\r\n          if (response.status === 401) {\r\n            throw new Error(\"Authentication failed. Please log in again.\");\r\n          }\r\n          throw new Error(\r\n            `API Error: ${response.status} ${response.statusText}`\r\n          );\r\n        }\r\n\r\n        const result = await response.json();\r\n\r\n        const fetchedSessions = result.chats || [];\r\n\r\n        console.log(\r\n          \"[UnifiedChatHeader] Data from /api/chat:\",\r\n          fetchedSessions\r\n        );\r\n\r\n        if (!Array.isArray(fetchedSessions)) {\r\n          console.error(\r\n            \"[UnifiedChatHeader] API response 'chats' is not an array:\",\r\n            fetchedSessions\r\n          );\r\n          throw new Error(\"Invalid data format received from API.\");\r\n        }\r\n\r\n        setSessions(fetchedSessions as ChatSession[]);\r\n\r\n        console.log(\r\n          \"[UnifiedChatHeader] Attempting to find session with ID:\",\r\n          chatId\r\n        );\r\n        const currentChat = fetchedSessions.find(\r\n          (session: ChatSession) => session.id === chatId\r\n        );\r\n        console.log(\r\n          \"[UnifiedChatHeader] Found currentChat from API data:\",\r\n          currentChat\r\n        );\r\n\r\n        if (currentChat) {\r\n          console.log(\r\n            \"[UnifiedChatHeader] Current chat is_archived from API data:\",\r\n            currentChat.is_archived\r\n          );\r\n          setCurrentChatIsArchived(!!currentChat.is_archived);\r\n        } else {\r\n          console.log(\r\n            \"[UnifiedChatHeader] Current chat not found in fetched API data.\"\r\n          );\r\n          setCurrentChatIsArchived(false);\r\n        }\r\n      } catch (err: any) {\r\n        console.error(\"Failed to fetch chat sessions via API:\", err);\r\n\r\n        // Handle auth-specific error messages\r\n        const errorMessage =\r\n          err.message || \"An unknown error occurred while fetching sessions.\";\r\n        const isAuthError =\r\n          errorMessage.includes(\"auth\") ||\r\n          errorMessage.includes(\"log in\") ||\r\n          errorMessage.includes(\"token\") ||\r\n          errorMessage.includes(\"401\");\r\n\r\n        toast({\r\n          title: isAuthError\r\n            ? \"Authentication Error\"\r\n            : \"Failed to load chat sessions\",\r\n          description: errorMessage,\r\n          variant: \"destructive\",\r\n          action: isAuthError ? (\r\n            <div className=\"flex\">\r\n              <button\r\n                className=\"bg-primary text-primary-foreground px-2 py-1 rounded\"\r\n                onClick={() => (window.location.href = \"/auth/login\")}\r\n              >\r\n                Log in\r\n              </button>\r\n            </div>\r\n          ) : undefined,\r\n        });\r\n\r\n        setSessions([]);\r\n        setCurrentChatIsArchived(false);\r\n      } finally {\r\n        setIsLoadingSessions(false);\r\n      }\r\n    };\r\n\r\n    fetchSessions();\r\n  }, [chatId, toast, supabase]);\r\n\r\n  const visibilityOption = chatVisibilityOptions.find(\r\n    (option) => option.value === selectedVisibility\r\n  );\r\n  const VisibilityIcon = visibilityOption?.icon || Lock;\r\n\r\n  const handleCopyLink = async () => {\r\n    setIsCopying(true);\r\n    try {\r\n      const chatUrl = `${window.location.origin}/chat/${chatId}`;\r\n      await navigator.clipboard.writeText(chatUrl);\r\n      toast({\r\n        title: \"Link copied\",\r\n        description: \"Chat link copied to clipboard\",\r\n      });\r\n    } catch (error) {\r\n      console.error(\"Failed to copy link:\", error);\r\n      toast({\r\n        title: \"Failed to copy link\",\r\n        description: \"An error occurred while copying the link\",\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setIsCopying(false);\r\n    }\r\n  };\r\n\r\n  const handleShareChat = async (newVisibility: string) => {\r\n    if (\r\n      newVisibility === selectedVisibility ||\r\n      isSharing ||\r\n      !supabase ||\r\n      !user?.id\r\n    )\r\n      return;\r\n    setIsSharing(true);\r\n    try {\r\n      const { error: updateError } = await supabase\r\n        .from(\"chat_sessions\")\r\n        .update({\r\n          visibility: newVisibility,\r\n          updated_at: new Date().toISOString(),\r\n        })\r\n        .eq(\"id\", chatId)\r\n        .eq(\"user_id\", user.id);\r\n      if (updateError) throw updateError;\r\n      onVisibilityChange(newVisibility);\r\n      toast({\r\n        title: \"Chat visibility updated\",\r\n        description: `Chat is now ${newVisibility}`,\r\n      });\r\n    } catch (error: any) {\r\n      console.error(\"Failed to update visibility:\", error);\r\n      toast({\r\n        title: \"Failed to update visibility\",\r\n        description: error.message,\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setIsSharing(false);\r\n    }\r\n  };\r\n\r\n  const handleArchiveChat = async () => {\r\n    if (isArchiving) return;\r\n    setIsArchiving(true);\r\n    try {\r\n      const response = await fetch(`/api/chat/${chatId}/archive`, {\r\n        method: \"PUT\",\r\n      });\r\n      if (!response.ok) throw new Error(\"Failed to archive chat\");\r\n      toast({ title: \"Chat archived\" });\r\n      setCurrentChatIsArchived(true);\r\n    } catch (error: any) {\r\n      console.error(\"Failed to archive chat:\", error);\r\n      toast({\r\n        title: \"Failed to archive chat\",\r\n        description: error.message,\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setIsArchiving(false);\r\n    }\r\n  };\r\n\r\n  const handleUnarchiveChat = async () => {\r\n    if (isUnarchiving) return;\r\n    setIsUnarchiving(true);\r\n    try {\r\n      const response = await fetch(`/api/chat/${chatId}/unarchive`, {\r\n        method: \"PUT\",\r\n      });\r\n      if (!response.ok) throw new Error(\"Failed to unarchive chat\");\r\n      toast({ title: \"Chat unarchived\" });\r\n      setCurrentChatIsArchived(false);\r\n    } catch (error: any) {\r\n      console.error(\"Failed to unarchive chat:\", error);\r\n      toast({\r\n        title: \"Failed to unarchive chat\",\r\n        description: error.message,\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setIsUnarchiving(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteChat = async () => {\r\n    if (isDeleting) return;\r\n    setIsDeleting(true);\r\n    try {\r\n      const response = await fetch(`/api/chat/${chatId}`, { method: \"DELETE\" });\r\n      if (!response.ok) throw new Error(\"Failed to delete chat\");\r\n      toast({ title: \"Chat deleted\" });\r\n      onNewSession();\r\n    } catch (error: any) {\r\n      console.error(\"Failed to delete chat:\", error);\r\n      toast({\r\n        title: \"Failed to delete chat\",\r\n        description: error.message,\r\n        variant: \"destructive\",\r\n      });\r\n    } finally {\r\n      setIsDeleting(false);\r\n    }\r\n  };\r\n\r\n  const handleTitleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    setCurrentTitle(e.target.value);\r\n  };\r\n\r\n  const handleTitleSave = useCallback(async () => {\r\n    const trimmedTitle = currentTitle.trim();\r\n    if (\r\n      !supabase ||\r\n      !user?.id ||\r\n      !trimmedTitle ||\r\n      trimmedTitle === initialTitle ||\r\n      isSavingTitle\r\n    ) {\r\n      setIsEditingTitle(false);\r\n      if (trimmedTitle !== initialTitle) setCurrentTitle(initialTitle);\r\n      return;\r\n    }\r\n    setIsSavingTitle(true);\r\n    try {\r\n      const { error } = await supabase\r\n        .from(\"chat_sessions\")\r\n        .update({ title: trimmedTitle, updated_at: new Date().toISOString() })\r\n        .eq(\"id\", chatId);\r\n      if (error) throw error;\r\n      toast({ title: \"Title updated\" });\r\n      setIsEditingTitle(false);\r\n      setSessions((prev) =>\r\n        prev.map((s) => (s.id === chatId ? { ...s, title: trimmedTitle } : s))\r\n      );\r\n      if (onTitleChange) {\r\n        onTitleChange(trimmedTitle);\r\n      }\r\n    } catch (err: any) {\r\n      console.error(\"Failed to update title:\", err);\r\n      toast({ title: \"Failed to save title\", variant: \"destructive\" });\r\n      setCurrentTitle(initialTitle);\r\n    } finally {\r\n      setIsSavingTitle(false);\r\n      setIsEditingTitle(false);\r\n    }\r\n  }, [\r\n    supabase,\r\n    user?.id,\r\n    chatId,\r\n    currentTitle,\r\n    initialTitle,\r\n    toast,\r\n    isSavingTitle,\r\n    onTitleChange,\r\n  ]);\r\n\r\n  const handleTitleEditKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\r\n    if (e.key === \"Enter\") {\r\n      e.preventDefault();\r\n      handleTitleSave();\r\n    } else if (e.key === \"Escape\") {\r\n      setCurrentTitle(initialTitle);\r\n      setIsEditingTitle(false);\r\n    }\r\n  };\r\n\r\n  const handleExportChat = async () => {\r\n    try {\r\n      const response = await fetch(`/api/chat/${chatId}/messages`, {\r\n        method: \"GET\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(\"Failed to fetch chat messages\");\r\n      }\r\n\r\n      const messages = await response.json();\r\n\r\n      if (!messages || messages.length === 0) {\r\n        toast({\r\n          title: \"No messages to export\",\r\n          description: \"This chat has no messages to export.\",\r\n        });\r\n        return;\r\n      }\r\n\r\n      // Format messages into a text string\r\n      const chatTitle = currentTitle || `Chat_${chatId}`;\r\n      const formattedDate = new Date().toISOString().split(\"T\")[0];\r\n      let exportContent = `# ${chatTitle}\\n`;\r\n      exportContent += `# Exported on: ${formattedDate}\\n\\n`;\r\n\r\n      messages.forEach((message: any) => {\r\n        const timestamp = new Date(message.created_at).toLocaleString();\r\n        const role =\r\n          message.role.charAt(0).toUpperCase() + message.role.slice(1);\r\n        exportContent += `## ${role} (${timestamp})\\n${message.content}\\n\\n`;\r\n      });\r\n\r\n      // Create and download a text file\r\n      const blob = new Blob([exportContent], { type: \"text/plain\" });\r\n      const url = URL.createObjectURL(blob);\r\n      const a = document.createElement(\"a\");\r\n      a.href = url;\r\n      a.download = `${chatTitle.replace(/\\s+/g, \"_\")}_${formattedDate}.txt`;\r\n      document.body.appendChild(a);\r\n      a.click();\r\n      document.body.removeChild(a);\r\n      URL.revokeObjectURL(url);\r\n\r\n      toast({\r\n        title: \"Chat exported successfully\",\r\n        description: `Saved as ${a.download}`,\r\n      });\r\n    } catch (error: any) {\r\n      console.error(\"Failed to export chat:\", error);\r\n      toast({\r\n        title: \"Failed to export chat\",\r\n        description: error.message || \"An unexpected error occurred\",\r\n        variant: \"destructive\",\r\n      });\r\n    }\r\n  };\r\n\r\n  const currentSessionTitle =\r\n    sessions.find((s) => s.id === chatId)?.title ||\r\n    `Chat (${chatId?.substring(0, 6)}...)`;\r\n\r\n  return (\r\n    <TooltipProvider delayDuration={0}>\r\n      <div className=\"relative z-20 flex h-14 items-center justify-between border-b bg-background px-4\">\r\n        <div className=\"flex items-center gap-2\">\r\n          <div className=\"flex items-center gap-1\">\r\n            {isEditingTitle ? (\r\n              <>\r\n                <Input\r\n                  value={currentTitle}\r\n                  onChange={handleTitleChange}\r\n                  onBlur={handleTitleSave}\r\n                  onKeyDown={handleTitleEditKeyDown}\r\n                  className=\"h-8 flex-grow min-w-0\"\r\n                  autoFocus\r\n                  disabled={isSavingTitle}\r\n                  placeholder=\"Chat title\"\r\n                />\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  onClick={handleTitleSave}\r\n                  disabled={\r\n                    isSavingTitle ||\r\n                    currentTitle.trim() === initialTitle ||\r\n                    !currentTitle.trim()\r\n                  }\r\n                >\r\n                  {isSavingTitle ? \"Saving...\" : \"Save\"}\r\n                </Button>\r\n                <Button\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  onClick={() => {\r\n                    setCurrentTitle(initialTitle);\r\n                    setIsEditingTitle(false);\r\n                  }}\r\n                  disabled={isSavingTitle}\r\n                >\r\n                  Cancel\r\n                </Button>\r\n              </>\r\n            ) : (\r\n              <Tooltip>\r\n                <TooltipTrigger asChild>\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    className=\"flex items-center gap-1.5 px-2 max-w-full text-left h-auto py-1\"\r\n                    onClick={() => !isReadonly && setIsEditingTitle(true)}\r\n                    disabled={isReadonly}\r\n                  >\r\n                    <MessageSquare className=\"h-4 w-4 text-muted-foreground flex-shrink-0\" />\r\n                    <span\r\n                      className=\"truncate text-base font-semibold flex-grow min-w-0\"\r\n                      title={currentTitle}\r\n                    >\r\n                      {currentTitle || \"New Chat\"}\r\n                    </span>\r\n                    {!isReadonly && (\r\n                      <Pencil className=\"h-3.5 w-3.5 text-muted-foreground ml-1 flex-shrink-0 opacity-0 group-hover:opacity-100 transition-opacity\" />\r\n                    )}\r\n                  </Button>\r\n                </TooltipTrigger>\r\n                <TooltipContent>\r\n                  {isReadonly ? currentTitle : \"Edit Title\"}\r\n                </TooltipContent>\r\n              </Tooltip>\r\n            )}\r\n          </div>\r\n\r\n          <DropdownMenu>\r\n            <Tooltip>\r\n              <TooltipTrigger asChild>\r\n                <DropdownMenuTrigger asChild>\r\n                  <Button\r\n                    variant=\"ghost\"\r\n                    size=\"icon\"\r\n                    className=\"h-8 w-8 flex-shrink-0\"\r\n                    disabled={isLoadingSessions}\r\n                  >\r\n                    <ChevronDown className=\"h-4 w-4\" />\r\n                    <span className=\"sr-only\">Switch Chat</span>\r\n                  </Button>\r\n                </DropdownMenuTrigger>\r\n              </TooltipTrigger>\r\n              <TooltipContent>Switch Chat</TooltipContent>\r\n            </Tooltip>\r\n            <DropdownMenuContent align=\"start\" className=\"w-64\">\r\n              <DropdownMenuLabel>Recent Chats</DropdownMenuLabel>\r\n              <DropdownMenuSeparator />\r\n              {isLoadingSessions ? (\r\n                <DropdownMenuItem disabled>Loading...</DropdownMenuItem>\r\n              ) : sessions.length > 0 ? (\r\n                sessions.map((session) => (\r\n                  <DropdownMenuItem\r\n                    key={session.id}\r\n                    onClick={() => onSessionChange(session.id)}\r\n                    disabled={session.id === chatId}\r\n                    className={cn(session.id === chatId && \"bg-accent\")}\r\n                  >\r\n                    <span className=\"truncate\">\r\n                      {session.title ||\r\n                        `Chat (${session.id.substring(0, 6)}...)`}\r\n                    </span>\r\n                  </DropdownMenuItem>\r\n                ))\r\n              ) : (\r\n                <DropdownMenuItem disabled>No recent chats</DropdownMenuItem>\r\n              )}\r\n            </DropdownMenuContent>\r\n          </DropdownMenu>\r\n\r\n          <Tooltip>\r\n            <TooltipTrigger asChild>\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"icon\"\r\n                onClick={onNewSession}\r\n                className=\"h-8 w-8 flex-shrink-0\"\r\n              >\r\n                <PlusCircle className=\"h-4 w-4\" />\r\n                <span className=\"sr-only\">New Chat</span>\r\n              </Button>\r\n            </TooltipTrigger>\r\n            <TooltipContent>New Chat</TooltipContent>\r\n          </Tooltip>\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-1 flex-shrink-0\">\r\n          {toggleResearch && (\r\n            <Tooltip>\r\n              <TooltipTrigger asChild>\r\n                <Button\r\n                  variant={isResearchVisible ? \"secondary\" : \"ghost\"}\r\n                  size=\"icon\"\r\n                  onClick={toggleResearch}\r\n                  className=\"h-8 w-8\"\r\n                >\r\n                  <Search className=\"h-4 w-4\" />\r\n                </Button>\r\n              </TooltipTrigger>\r\n              <TooltipContent>Research Panel</TooltipContent>\r\n            </Tooltip>\r\n          )}\r\n          {toggleDocumentProcessor && (\r\n            <Tooltip>\r\n              <TooltipTrigger asChild>\r\n                <Button\r\n                  variant={isDocumentProcessorVisible ? \"secondary\" : \"ghost\"}\r\n                  size=\"icon\"\r\n                  onClick={toggleDocumentProcessor}\r\n                  className=\"h-8 w-8\"\r\n                >\r\n                  <FileText className=\"h-4 w-4\" />\r\n                </Button>\r\n              </TooltipTrigger>\r\n              <TooltipContent>Document Processor</TooltipContent>\r\n            </Tooltip>\r\n          )}\r\n          {toggleWebScraper && (\r\n            <Tooltip>\r\n              <TooltipTrigger asChild>\r\n                <Button\r\n                  variant={isWebScraperVisible ? \"secondary\" : \"ghost\"}\r\n                  size=\"icon\"\r\n                  onClick={toggleWebScraper}\r\n                  className=\"h-8 w-8\"\r\n                >\r\n                  <Globe2 className=\"h-4 w-4\" />\r\n                </Button>\r\n              </TooltipTrigger>\r\n              <TooltipContent>Web Scraper</TooltipContent>\r\n            </Tooltip>\r\n          )}\r\n          {toggleArtifact && (\r\n            <Tooltip>\r\n              <TooltipTrigger asChild>\r\n                <Button\r\n                  variant={isArtifactVisible ? \"secondary\" : \"ghost\"}\r\n                  size=\"icon\"\r\n                  onClick={toggleArtifact}\r\n                  className=\"h-8 w-8\"\r\n                >\r\n                  <DatabaseIcon className=\"h-4 w-4\" />\r\n                </Button>\r\n              </TooltipTrigger>\r\n              <TooltipContent>Artifacts Panel</TooltipContent>\r\n            </Tooltip>\r\n          )}\r\n          {toggleAnalytics && (\r\n            <Tooltip>\r\n              <TooltipTrigger asChild>\r\n                <Button\r\n                  variant={isAnalyticsVisible ? \"secondary\" : \"ghost\"}\r\n                  size=\"icon\"\r\n                  onClick={toggleAnalytics}\r\n                  className=\"h-8 w-8\"\r\n                >\r\n                  <BarChartHorizontal className=\"h-4 w-4\" />\r\n                </Button>\r\n              </TooltipTrigger>\r\n              <TooltipContent>Chat Analytics</TooltipContent>\r\n            </Tooltip>\r\n          )}\r\n          {(toggleResearch ||\r\n            toggleDocumentProcessor ||\r\n            toggleWebScraper ||\r\n            toggleArtifact ||\r\n            toggleAnalytics) && <div className=\"h-6 w-px bg-border mx-1\"></div>}\r\n\r\n          <DropdownMenu>\r\n            <Tooltip>\r\n              <TooltipTrigger asChild>\r\n                <DropdownMenuTrigger asChild>\r\n                  <Button\r\n                    variant=\"outline\"\r\n                    className=\"flex items-center gap-1.5 px-2 h-8\"\r\n                  >\r\n                    <Settings2 className=\"h-4 w-4 text-muted-foreground\" />\r\n                    <span className=\"text-sm max-w-[100px] truncate\">\r\n                      {availableModels.find((m) => m.value === selectedModel)\r\n                        ?.label || selectedModel}\r\n                    </span>\r\n                    <ChevronDown className=\"h-4 w-4 text-muted-foreground\" />\r\n                  </Button>\r\n                </DropdownMenuTrigger>\r\n              </TooltipTrigger>\r\n              <TooltipContent>Select Model</TooltipContent>\r\n            </Tooltip>\r\n            <DropdownMenuContent align=\"end\">\r\n              <DropdownMenuLabel>Select Model</DropdownMenuLabel>\r\n              <DropdownMenuSeparator />\r\n              <DropdownMenuRadioGroup\r\n                value={selectedModel}\r\n                onValueChange={onModelChange}\r\n              >\r\n                {availableModels.map((model) => (\r\n                  <DropdownMenuRadioItem key={model.value} value={model.value}>\r\n                    {model.label}\r\n                  </DropdownMenuRadioItem>\r\n                ))}\r\n              </DropdownMenuRadioGroup>\r\n            </DropdownMenuContent>\r\n          </DropdownMenu>\r\n\r\n          <DropdownMenu>\r\n            <Tooltip>\r\n              <TooltipTrigger asChild>\r\n                <DropdownMenuTrigger asChild>\r\n                  <Button\r\n                    variant=\"secondary\"\r\n                    className=\"flex items-center gap-1.5 px-3 h-8\"\r\n                  >\r\n                    <VisibilityIcon className=\"h-4 w-4\" />\r\n                    <span className=\"text-sm\">\r\n                      {visibilityOption?.label || \"Share\"}\r\n                    </span>\r\n                  </Button>\r\n                </DropdownMenuTrigger>\r\n              </TooltipTrigger>\r\n              <TooltipContent>Share & Actions</TooltipContent>\r\n            </Tooltip>\r\n            <DropdownMenuContent align=\"end\" className=\"w-64\">\r\n              <DropdownMenuLabel>Sharing Settings</DropdownMenuLabel>\r\n              {chatVisibilityOptions.map((option) => (\r\n                <DropdownMenuItem\r\n                  key={option.value}\r\n                  onClick={() => handleShareChat(option.value)}\r\n                  disabled={isSharing || option.value === selectedVisibility}\r\n                >\r\n                  <option.icon className=\"h-4 w-4 mr-2\" />\r\n                  <div>\r\n                    <div>{option.label}</div>\r\n                    <div className=\"text-xs text-muted-foreground\">\r\n                      {option.description}\r\n                    </div>\r\n                  </div>\r\n                </DropdownMenuItem>\r\n              ))}\r\n              <DropdownMenuSeparator />\r\n              <DropdownMenuLabel>Other Actions</DropdownMenuLabel>\r\n              <DropdownMenuItem onClick={handleCopyLink} disabled={isCopying}>\r\n                <Copy className=\"mr-2 h-4 w-4\" />{\" \"}\r\n                {isCopying ? \"Copying...\" : \"Copy Link\"}\r\n              </DropdownMenuItem>\r\n              <DropdownMenuItem onClick={handleExportChat}>\r\n                <Download className=\"mr-2 h-4 w-4\" /> Export Chat\r\n              </DropdownMenuItem>\r\n              {currentChatIsArchived ? (\r\n                <DropdownMenuItem\r\n                  onClick={handleUnarchiveChat}\r\n                  disabled={isUnarchiving}\r\n                >\r\n                  <Archive className=\"mr-2 h-4 w-4\" />{\" \"}\r\n                  {isUnarchiving ? \"Unarchiving...\" : \"Unarchive\"}\r\n                </DropdownMenuItem>\r\n              ) : (\r\n                <DropdownMenuItem\r\n                  onClick={handleArchiveChat}\r\n                  disabled={isArchiving}\r\n                >\r\n                  <Archive className=\"mr-2 h-4 w-4\" />{\" \"}\r\n                  {isArchiving ? \"Archiving...\" : \"Archive\"}\r\n                </DropdownMenuItem>\r\n              )}\r\n              {!isReadonly && (\r\n                <DropdownMenuItem\r\n                  onClick={handleDeleteChat}\r\n                  disabled={isDeleting}\r\n                  className=\"text-destructive focus:text-destructive focus:bg-destructive/10\"\r\n                >\r\n                  <Trash className=\"mr-2 h-4 w-4\" />{\" \"}\r\n                  {isDeleting ? \"Deleting...\" : \"Delete Chat\"}\r\n                </DropdownMenuItem>\r\n              )}\r\n            </DropdownMenuContent>\r\n          </DropdownMenu>\r\n        </div>\r\n      </div>\r\n    </TooltipProvider>\r\n  );\r\n}\r\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name BarChart\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8bGluZSB4MT0iMTIiIHgyPSIxMiIgeTE9IjIwIiB5Mj0iMTAiIC8+CiAgPGxpbmUgeDE9IjE4IiB4Mj0iMTgiIHkxPSIyMCIgeTI9IjQiIC8+CiAgPGxpbmUgeDE9IjYiIHgyPSI2IiB5MT0iMjAiIHkyPSIxNiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/bar-chart\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst BarChart = createLucideIcon('BarChart', [\n  ['line', { x1: '12', x2: '12', y1: '20', y2: '10', key: '1vz5eb' }],\n  ['line', { x1: '18', x2: '18', y1: '20', y2: '4', key: 'cun8e5' }],\n  ['line', { x1: '6', x2: '6', y1: '20', y2: '16', key: 'hq0ia6' }],\n]);\n\nexport default BarChart;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name MessageSquare\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEgMTVhMiAyIDAgMCAxLTIgMkg3bC00IDRWNWEyIDIgMCAwIDEgMi0yaDE0YTIgMiAwIDAgMSAyIDJ6IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/message-square\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst MessageSquare = createLucideIcon('MessageSquare', [\n  ['path', { d: 'M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z', key: '1lielz' }],\n]);\n\nexport default MessageSquare;\n","import React from 'react';\r\n\r\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\r\nimport { UnifiedCodeBlock } from '@/components/ui/unified-chat/UnifiedCodeBlock'; // Adjust path as needed\r\n\r\nimport { BaseArtifactData } from '../index';\r\n\r\ninterface CodeArtifactProps {\r\n    artifact: BaseArtifactData;\r\n}\r\n\r\nexport const CodeArtifact: React.FC<CodeArtifactProps> = ({ artifact }) => {\r\n    // Attempt to parse content if it's a stringified object, otherwise treat as string\r\n    let code = '';\r\n    let language = 'plaintext';\r\n\r\n    if (typeof artifact.content === 'string') {\r\n        try {\r\n            const parsed = JSON.parse(artifact.content);\r\n            if (typeof parsed === 'object' && parsed !== null && parsed.code) {\r\n                code = parsed.code;\r\n                language = parsed.language || 'plaintext';\r\n            } else {\r\n                code = artifact.content; // Treat as plain code string if not expected object\r\n            }\r\n        } catch (e) {\r\n            code = artifact.content; // Treat as plain code string if JSON parsing fails\r\n        }\r\n    } else if (typeof artifact.content === 'object' && artifact.content !== null && (artifact.content as any).code) {\r\n        code = (artifact.content as any).code;\r\n        language = (artifact.content as any).language || 'plaintext';\r\n    }\r\n\r\n\r\n    return (\r\n        <Card className=\"h-full flex flex-col\">\r\n            <CardHeader>\r\n                <CardTitle>{artifact.title || 'Code Artifact'}</CardTitle>\r\n            </CardHeader>\r\n            <CardContent className=\"flex-1 overflow-auto p-0\">\r\n                <UnifiedCodeBlock language={language} value={code} />\r\n            </CardContent>\r\n        </Card>\r\n    );\r\n}; ","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Database\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8ZWxsaXBzZSBjeD0iMTIiIGN5PSI1IiByeD0iOSIgcnk9IjMiIC8+CiAgPHBhdGggZD0iTTMgNVYxOUE5IDMgMCAwIDAgMjEgMTlWNSIgLz4KICA8cGF0aCBkPSJNMyAxMkE5IDMgMCAwIDAgMjEgMTIiIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/database\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Database = createLucideIcon('Database', [\n  ['ellipse', { cx: '12', cy: '5', rx: '9', ry: '3', key: 'msslwz' }],\n  ['path', { d: 'M3 5V19A9 3 0 0 0 21 19V5', key: '1wlel7' }],\n  ['path', { d: 'M3 12A9 3 0 0 0 21 12', key: 'mv7ke4' }],\n]);\n\nexport default Database;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Download\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMjEgMTV2NGEyIDIgMCAwIDEtMiAySDVhMiAyIDAgMCAxLTItMnYtNCIgLz4KICA8cG9seWxpbmUgcG9pbnRzPSI3IDEwIDEyIDE1IDE3IDEwIiAvPgogIDxsaW5lIHgxPSIxMiIgeDI9IjEyIiB5MT0iMTUiIHkyPSIzIiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/download\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Download = createLucideIcon('Download', [\n  ['path', { d: 'M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4', key: 'ih7n3h' }],\n  ['polyline', { points: '7 10 12 15 17 10', key: '2ggqvy' }],\n  ['line', { x1: '12', x2: '12', y1: '15', y2: '3', key: '1vk2je' }],\n]);\n\nexport default Download;\n","import createLucideIcon from '../createLucideIcon';\n\n/**\n * @component @name Globe\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIgLz4KICA8cGF0aCBkPSJNMTIgMmExNC41IDE0LjUgMCAwIDAgMCAyMCAxNC41IDE0LjUgMCAwIDAgMC0yMCIgLz4KICA8cGF0aCBkPSJNMiAxMmgyMCIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/globe\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Globe = createLucideIcon('Globe', [\n  ['circle', { cx: '12', cy: '12', r: '10', key: '1mglay' }],\n  ['path', { d: 'M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20', key: '13o1zl' }],\n  ['path', { d: 'M2 12h20', key: '9i4pu4' }],\n]);\n\nexport default Globe;\n"],"names":["UnifiedSuggestions","messages","append","className","suggestions","setSuggestions","useState","isVisible","setIsVisible","length","handleSuggestionClick","id","crypto","randomUUID","content","suggestion","role","div","cn","Sparkles","span","map","index","Button","variant","size","onClick","Card","React","props","ref","motion","whileHover","scale","boxShadow","transition","type","stiffness","damping","displayName","CardHeader","CardTitle","h3","CardDescription","p","CardContent","CardFooter","UnifiedDocumentProcessor","chatId","attachments","isLoading","processedDocuments","setProcessedDocuments","activeDocument","setActiveDocument","activeTab","setActiveTab","question","setQuestion","isAsking","setIsAsking","isProcessing","setIsProcessing","useCallback","docId","prev","doc","ocrStatus","progress","attachment","find","att","fileContent","fileUrl","url","Promise","resolve","reader","FileReader","onload","e","target","result","toString","base64","includes","split","readAsDataURL","response","fetch","method","headers","body","JSON","stringify","fileId","fileName","name","fileType","ok","errorData","json","error","ocrResult","ocrText","text","console","errorMessage","Error","message","askQuestion","trim","questions","answer","timestamp","Date","now","updatedQuestions","lastQuestionIndex","systemMessage","FileText","document","dispatchEvent","CustomEvent","X","handleNewFile","fileInput","createElement","accept","multiple","onchange","files","file","Math","random","substring","newDoc","event","setTimeout","err","onerror","click","disabled","Upload","Tabs","defaultValue","TabsList","TabsTrigger","value","TabsContent","ScrollArea","File","h4","Badge","Progress","AlertCircle","UnifiedMarkdown","form","onSubmit","preventDefault","Textarea","onChange","placeholder","reverse","qa","Switch","SwitchPrimitives","UnifiedWebScraper","setUrl","bulkUrls","setBulkUrls","isScraping","setIsScraping","setError","scrapingResults","setScrapingResults","extractImmigrationData","setExtractImmigrationData","setProgress","activeView","setActiveView","handleSingleScrape","progressInterval","setInterval","newProgress","clearInterval","newResult","title","metadata","status","contentType","immigrationData","documentType","sourceType","credibilityScore","countries","visaTypes","requirements","keyPoints","undefined","join","req","point","handleBulkScrape","urls","filter","completedCount","results","push","Search","Label","htmlFor","Input","Loader2","rows","checked","onCheckedChange","round","Alert","AlertTitle","AlertDescription","LinkIcon","a","href","rel","toLocaleString","ul","i","li","LabelPrimitive","data-slot","getLanguageCodeForLocale","locale","defaultLocale","localeMap","en","ar","es","fr","useSpeechRecognition","onResult","onError","onEnd","isRecording","setIsRecording","isAvailable","setIsAvailable","recognitionRef","useRef","langCode","useEffect","SpeechRecognitionAPI","SpeechRecognition","webkitSpeechRecognition","current","continuous","interimResults","lang","onresult","finalTranscript","interimTranscript","resultIndex","isFinal","transcript","stop","onend","warn","startRecording","start","stopRecording","UnifiedArtifact","artifact","artifactData","useArtifact","resetArtifact","useResetArtifact","definition","artifactDefinitions","def","kind","ArtifactComponent","component","handleClose","UnifiedTypingIndicator","ArtifactKind","initialArtifactData","icon","TextArtifact","onStreamPart","streamPart","setArtifact","draft","Code","CodeArtifact","Table","SheetArtifact","currentContent","columns","Array","isArray","textarea","UnifiedChatContainer","isReadonly","user","session","useAuth","toast","useToast","supabase","useSupabaseBrowser","currentChatId","setCurrentChatId","uuidv4","currentModel","setCurrentModel","currentVisibility","setCurrentVisibility","setAttachments","currentTitle","setCurrentTitle","artifactState","useArtifactStore","state","useSetArtifact","isArtifactVisible","isResearchVisible","setIsResearchVisible","isDocumentProcessorVisible","setIsDocumentProcessorVisible","isWebScraperVisible","setIsWebScraperVisible","isAnalyticsVisible","setIsAnalyticsVisible","fetchSessionInfo","data","currentAuthSession","currentAuthError","auth","getSession","from","select","eq","single","attempt","res","retryData","retryErr","stack","input","setInput","handleInputChange","handleSubmit","chatHookError","setMessages","reload","useChat","api","apiEndpointForChat","initialMessages","selectedChatModel","visibility","access_token","Authorization","generateId","onFinish","description","handleFormSubmit","validAttachments","attachmentsPayload","dataToSend","handleAppend","messageOrMessages","msg","handleNewSession","newId","handleSessionChange","sessionId","toggleArtifact","toggleResearch","v","toggleDocumentProcessor","toggleWebScraper","toggleAnalytics","handleModelChange","model","handleVisibilityChange","vis","handleTitleChangeFromHeader","newTitle","UnifiedChatHeader","initialTitle","selectedModel","selectedVisibility","onModelChange","onVisibilityChange","onTitleChange","onNewSession","onSessionChange","UnifiedMessageList","UnifiedResearchContainer","ChatAnalytics","UnifiedMessageInput","chatError","create","updater","set","setMetadata","localArtifact","mutate","setLocalArtifact","useSWR","fallbackData","useMemo","artifactToUpdate","currentArtifact","updaterFn","localArtifactMetadata","setLocalArtifactMetadata","documentId","pre","t","useI18n","formRef","inputRef","fileInputRef","isDraggingOver","setIsDraggingOver","speechError","setSpeechError","isSessionLoading","useSession","isSpeechAvailable","focus","getRootProps","getInputProps","getDropzoneInputProps","useDropzone","noClick","noKeyboard","maxFiles","maxSize","onDragEnter","onDragLeave","onDrop","acceptedFiles","rejectedFiles","newAttachments","all","formData","FormData","handleFileChange","handleFileUpload","filesToUpload","removeAttachment","handleFileButtonClick","aria-label","Paperclip","tabIndex","onKeyDown","handleKeyDown","key","shiftKey","requestSubmit","MicOff","Mic","StopCircle","SendHorizonal","messagesEndRef","UnifiedMessage","isLastMessage","memo","ReactMarkdown","remarkPlugins","remarkGfm","components","children","code","node","match","exec","String","replace","UnifiedCodeBlock","language","table","TableHeader","thead","TableBody","tbody","tfoot","TableRow","tr","TableHead","th","TableCell","td","TableCaption","caption","col","row","rowIndex","colIndex","isCopied","setIsCopied","copyToClipboard","navigator","clipboard","writeText","CheckIcon","CopyIcon","SyntaxHighlighter","customStyle","margin","borderRadius","TabsPrimitive","analytics","setAnalytics","label","MessageSquare","Users","Clock","BarChart","fetchAnalytics","interval","item","feedback","setFeedback","isUser","submitFeedback","newFeedback","messageId","Avatar","AvatarFallback","AvatarImage","src","alt","ThumbsUp","ThumbsDown","DropdownMenu","DropdownMenuTrigger","asChild","MoreVertical","DropdownMenuContent","align","DropdownMenuItem","Check","Copy","sources","setSources","activities","setActivities","findings","setFindings","depth","setDepth","max","completedSteps","totalSteps","isResearching","setIsResearching","progressPercentage","startResearch","newActivities","lastUserMessage","m","researchQuery","simulateResearchProgress","relevance","slice","confidence","BookOpen","InfoIcon","source","ExternalLink","activity","finding","toFixed","chatVisibilityOptions","Lock","Globe","sessions","setSessions","isLoadingSessions","setIsLoadingSessions","isCopying","setIsCopying","isSharing","setIsSharing","isArchiving","setIsArchiving","isUnarchiving","setIsUnarchiving","isDeleting","setIsDeleting","isEditingTitle","setIsEditingTitle","isSavingTitle","setIsSavingTitle","currentChatIsArchived","setCurrentChatIsArchived","visibilityOption","option","VisibilityIcon","handleCopyLink","chatUrl","window","location","origin","handleShareChat","newVisibility","updateError","update","updated_at","toISOString","handleArchiveChat","handleUnarchiveChat","handleDeleteChat","handleTitleSave","trimmedTitle","s","handleExportChat","chatTitle","formattedDate","exportContent","forEach","created_at","charAt","toUpperCase","blob","Blob","URL","createObjectURL","download","appendChild","removeChild","revokeObjectURL","TooltipProvider","delayDuration","handleTitleChange","onBlur","handleTitleEditKeyDown","autoFocus","Tooltip","TooltipTrigger","Pencil","TooltipContent","ChevronDown","DropdownMenuLabel","DropdownMenuSeparator","PlusCircle","Globe2","DatabaseIcon","BarChartHorizontal","Settings2","availableModels","DropdownMenuRadioGroup","onValueChange","DropdownMenuRadioItem","Download","Archive","Trash","parsed","parse"],"sourceRoot":""}